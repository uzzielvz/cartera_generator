2025-11-12 19:15:22,451 - INFO - ================================================================================
2025-11-12 19:15:22,452 - INFO - INICIO DE AUTOMATIZACIÓN DE CARTERA
2025-11-12 19:15:22,452 - INFO - ================================================================================
2025-11-12 19:15:22,452 - INFO - 
--- PASO 0: BÚSQUEDA DE ARCHIVOS ---
2025-11-12 19:15:22,453 - INFO - Archivo encontrado: data\ReportedeAntiguedaddeCarteraGrupal_12112025.xlsx
2025-11-12 19:15:22,453 - INFO - Archivo encontrado: data\Situación_de_cartera_12112025.xlsx
2025-11-12 19:15:22,454 - INFO - Archivo encontrado: data\Cobranza_12112025.xlsx
2025-11-12 19:15:22,455 - INFO - Archivo encontrado: data/AHORROS.xlsx
2025-11-12 19:15:22,455 - INFO - 
--- PASO 1: CARGA DE ARCHIVOS ---
2025-11-12 19:15:22,455 - INFO - Cargando ANTIGÜEDAD desde: data\ReportedeAntiguedaddeCarteraGrupal_12112025.xlsx
2025-11-12 19:15:22,474 - INFO - Hoja detectada: '121125'
2025-11-12 19:15:22,628 - INFO - ANTIGÜEDAD cargado: (206, 59)
2025-11-12 19:15:22,628 - INFO - Columnas: ['cod_region', 'coordinacion', 'nombre_de_gerente', 'codigo_promotor', 'nombre_promotor', 'codigo_recuperador', 'nombre_recuperador', 'cod_grupo_solidario', 'ciclo', 'grupo_solidario']...
2025-11-12 19:15:22,629 - INFO - No se encontraron IDs duplicados
2025-11-12 19:15:22,629 - INFO - Cargando SITUACIÓN DE CARTERA desde: data\Situación_de_cartera_12112025.xlsx
2025-11-12 19:15:22,747 - INFO - SITUACIÓN DE CARTERA cargada: (206, 43)
2025-11-12 19:15:22,747 - INFO - Columnas: ['codigo_ofic_cred', 'nombre_oficial_de_credito', 'codigo_promotor_cred', 'nombre_promotor_cred', 'codigo_coord', 'nombre_coordinacion', 'codigo_ger_regi', 'nombre_gerencia_regional', 'nombre_codigo', 'nombre_acreditado_cliente']...
2025-11-12 19:15:22,748 - INFO - Columna de código renombrada: nombre_codigo -> codigo
2025-11-12 19:15:22,749 - INFO - Cargando REPORTE DE COBRANZA desde: data\Cobranza_12112025.xlsx
2025-11-12 19:15:22,922 - INFO - REPORTE DE COBRANZA cargado: (207, 68)
2025-11-12 19:15:22,922 - INFO - Columnas: ['regional', 'regional1', 'coordinacion', 'coordinacion1', 'de_credito', 'de_credito1', 'gpo', 'cliente_grupo', 'unnamed:_8', 'del_cliente']...
2025-11-12 19:15:22,922 - INFO - Cargando AHORROS (ACUMULADO) desde: data/AHORROS.xlsx
2025-11-12 19:15:22,958 - INFO - AHORROS cargado: (208, 4)
2025-11-12 19:15:22,958 - INFO - Columnas: ['id', 'grupo', 'ciclo', 'ahorro_acumulado']
2025-11-12 19:15:22,958 - INFO - PARCHE PROMOTORES cargado: 1 correcciones
2025-11-12 19:15:22,959 - INFO - 
--- PASO 2: GENERACIÓN DE CARTERA ---
2025-11-12 19:15:22,959 - INFO - Iniciando generación de cartera (VERSIÓN CORREGIDA)...
2025-11-12 19:15:22,959 - INFO - Registros en antiguedad: 206
2025-11-12 19:15:22,961 - INFO - ID de grupo generados: 0    000089
1    000145
2    000069
3    000079
4    000104
Name: id_de_grupo, dtype: object
2025-11-12 19:15:22,976 - INFO - Después de joins: 208 registros
2025-11-12 19:15:22,977 - INFO - NaN en situacion: 2
2025-11-12 19:15:22,977 - INFO - NaN en cobranza: 1
2025-11-12 19:15:22,977 - INFO - NaN en ahorros: 3
2025-11-12 19:15:22,979 - INFO - Parche aplicado: 1 correcciones
2025-11-12 19:15:22,981 - INFO - Estatus calculados: {'Vigente': 206, '': 2}
2025-11-12 19:15:22,995 - INFO - Cartera generada exitosamente: 208 filas x 36 columnas
2025-11-12 19:15:22,996 - INFO - 
--- PASO 3: GUARDADO DE RESULTADO CON FORMATO ---
2025-11-12 19:15:22,996 - INFO - ================================================================================
2025-11-12 19:15:22,996 - INFO - GUARDANDO DATAFRAME CON FORMATO
2025-11-12 19:15:22,996 - INFO - ================================================================================
2025-11-12 19:15:22,996 - INFO - 
1. Cargando plantilla de headers: plantilla/CARTERA_HEADERS.xlsx
2025-11-12 19:15:23,004 - INFO - Plantilla cargada: 6 filas x 36 columnas (6.1 KB)
2025-11-12 19:15:23,004 - INFO - 
2. Creando nuevo workbook...
2025-11-12 19:15:23,005 - INFO - 
3. Copiando headers desde plantilla...
2025-11-12 19:15:23,005 - INFO - Copiando headers (filas 1-6) con formato...
2025-11-12 19:15:23,050 - INFO - Headers copiados: 36 columnas
2025-11-12 19:15:23,050 - INFO - 
4. Pegando datos del DataFrame...
2025-11-12 19:15:23,050 - INFO - Pegando DataFrame (208 filas x 36 columnas) desde fila 7...
2025-11-12 19:15:23,089 - INFO - Datos pegados hasta fila 214
2025-11-12 19:15:23,089 - INFO - 
5. Formato de datos: Se aplicará automáticamente por la tabla Excel
2025-11-12 19:15:23,089 - INFO - 
6. Creando tabla de Excel con totales...
2025-11-12 19:15:23,089 - INFO - Creando tabla Excel 'TablaCartera' desde fila 6 hasta 214...
2025-11-12 19:15:23,089 - INFO - Rango de tabla: A6:AJ215
2025-11-12 19:15:23,089 - INFO - Fila de totales: 215
2025-11-12 19:15:23,089 - INFO - Nombres de columnas extraídos: 36
2025-11-12 19:15:23,090 - INFO -   Columna 6 'Monto del crédito': SUM
2025-11-12 19:15:23,090 - INFO -   Columna 13 'Pago Semanal': SUM
2025-11-12 19:15:23,090 - INFO -   Columna 15 'Cartera vigente sistema': SUM
2025-11-12 19:15:23,090 - INFO -   Columna 16 'Carera vigente inicial': SUM
2025-11-12 19:15:23,090 - INFO -   Columna 17 'Cartera vigente calculada': SUM
2025-11-12 19:15:23,090 - INFO -   Columna 18 'Cartera Insoluta': SUM
2025-11-12 19:15:23,090 - INFO -   Columna 19 'Diferencia Validación vigente': SUM
2025-11-12 19:15:23,090 - INFO -   Columna 20 'Ahorro Consumido': SUM
2025-11-12 19:15:23,090 - INFO -   Columna 21 'Cartera Vencida Estadistica': SUM
2025-11-12 19:15:23,090 - INFO -   Columna 22 'Cartera vencida Total': SUM
2025-11-12 19:15:23,090 - INFO -   Columna 24 'Saldo en riesgo': SUM
2025-11-12 19:15:23,090 - INFO -   Columna 25 'Saldo 
ahorro 
acumulado': SUM
2025-11-12 19:15:23,090 - INFO -   Columna 26 'Monto promedio del grupo': SUM
2025-11-12 19:15:23,091 - INFO -   Columna 33 'Ahorro Acumulado': SUM
2025-11-12 19:15:23,091 - INFO - Escribiendo fórmulas en fila de totales...
2025-11-12 19:15:23,091 - INFO -   Fórmula en columna 6: =SUBTOTAL(109,F7:F214)
2025-11-12 19:15:23,091 - INFO -   Fórmula en columna 13: =SUBTOTAL(109,M7:M214)
2025-11-12 19:15:23,091 - INFO -   Fórmula en columna 15: =SUBTOTAL(109,O7:O214)
2025-11-12 19:15:23,091 - INFO -   Fórmula en columna 16: =SUBTOTAL(109,P7:P214)
2025-11-12 19:15:23,091 - INFO -   Fórmula en columna 17: =SUBTOTAL(109,Q7:Q214)
2025-11-12 19:15:23,091 - INFO -   Fórmula en columna 18: =SUBTOTAL(109,R7:R214)
2025-11-12 19:15:23,091 - INFO -   Fórmula en columna 19: =SUBTOTAL(109,S7:S214)
2025-11-12 19:15:23,091 - INFO -   Fórmula en columna 20: =SUBTOTAL(109,T7:T214)
2025-11-12 19:15:23,091 - INFO -   Fórmula en columna 21: =SUBTOTAL(109,U7:U214)
2025-11-12 19:15:23,091 - INFO -   Fórmula en columna 22: =SUBTOTAL(109,V7:V214)
2025-11-12 19:15:23,091 - INFO -   Fórmula en columna 24: =SUBTOTAL(109,X7:X214)
2025-11-12 19:15:23,092 - INFO -   Fórmula en columna 25: =SUBTOTAL(109,Y7:Y214)
2025-11-12 19:15:23,092 - INFO -   Fórmula en columna 26: =SUBTOTAL(109,Z7:Z214)
2025-11-12 19:15:23,092 - INFO -   Fórmula en columna 33: =SUBTOTAL(109,AG7:AG214)
2025-11-12 19:15:23,092 - INFO - Tabla creada exitosamente con 208 filas de datos + fila totales
2025-11-12 19:15:23,092 - INFO - Totales configurados en 14 columnas con fórmulas SUBTOTAL
2025-11-12 19:15:23,092 - INFO - Fila de totales: Formato aplicado automáticamente por la tabla
2025-11-12 19:15:23,092 - INFO - 
7. Guardando archivo: output_automatizado.xlsx
2025-11-12 19:15:23,219 - INFO - 
================================================================================
2025-11-12 19:15:23,219 - INFO - ARCHIVO GUARDADO EXITOSAMENTE
2025-11-12 19:15:23,219 - INFO - ================================================================================
2025-11-12 19:15:23,219 - INFO - 
Archivo: output_automatizado.xlsx
2025-11-12 19:15:23,219 - INFO - Filas de datos: 208
2025-11-12 19:15:23,219 - INFO - Columnas: 36
2025-11-12 19:15:23,219 - INFO - Formato: Idéntico al machote
2025-11-12 19:15:23,219 - INFO - Tabla Excel: Con totales automáticos
2025-11-12 19:15:23,219 - INFO - ================================================================================
2025-11-12 19:15:23,220 - INFO - OK - Archivo guardado con formato: output_automatizado.xlsx
2025-11-12 19:15:23,220 - INFO - 
--- PASO 4: GENERACIÓN DE HOJA MORA ---
2025-11-12 19:15:23,220 - INFO - 
Iniciando generación de hoja MORA...
2025-11-12 19:15:23,221 - INFO - Registros con %mora > 5%: 7 de 208
2025-11-12 19:15:23,223 - INFO - Hoja MORA generada con 7 registros y 14 columnas
2025-11-12 19:15:23,223 - INFO - 
================================================================================
2025-11-12 19:15:23,224 - INFO - AGREGANDO HOJA MORA
2025-11-12 19:15:23,224 - INFO - ================================================================================
2025-11-12 19:15:23,224 - INFO - 
1. Abriendo archivo: output_automatizado.xlsx
2025-11-12 19:15:23,383 - INFO - 
2. Creando hoja 'Mora'
2025-11-12 19:15:23,383 - INFO - 
3. Copiando formato de headers desde plantilla
2025-11-12 19:15:23,404 - INFO - 
4. Estableciendo headers de MORA
2025-11-12 19:15:23,404 - INFO - 
5. Pegando 7 filas de datos
2025-11-12 19:15:23,406 - INFO - 
6. Creando tabla Excel con totales
2025-11-12 19:15:23,406 - INFO -    Creando tabla: A6:N14
2025-11-12 19:15:23,407 - INFO -    Tabla 'TablaMora' creada con totales automáticos
2025-11-12 19:15:23,407 - INFO -    Fórmulas SUBTOTAL escritas en 6 columnas
2025-11-12 19:15:23,407 - INFO - 
7. Guardando archivo con hoja MORA
2025-11-12 19:15:23,529 - INFO - 
================================================================================
2025-11-12 19:15:23,529 - INFO - HOJA MORA AGREGADA EXITOSAMENTE
2025-11-12 19:15:23,529 - INFO - ================================================================================
2025-11-12 19:15:23,529 - INFO - 
Registros en MORA: 7
2025-11-12 19:15:23,529 - INFO - Filtro: %mora > 5%
2025-11-12 19:15:23,529 - INFO - Columnas amarillas: %mora, Días de mora
2025-11-12 19:15:23,529 - INFO - ================================================================================
2025-11-12 19:15:23,529 - INFO - OK - Hoja MORA agregada con 7 registros
2025-11-12 19:15:23,529 - INFO - 
--- PASO 5: VALIDACIÓN ---
2025-11-12 19:15:23,530 - INFO - Machote no encontrado - validación omitida (no es necesario)
2025-11-12 19:15:23,530 - INFO - 
================================================================================
2025-11-12 19:15:23,530 - INFO - AUTOMATIZACIÓN COMPLETADA EXITOSAMENTE
2025-11-12 19:15:23,530 - INFO - ================================================================================
