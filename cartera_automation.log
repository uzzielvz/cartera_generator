2025-11-12 19:15:22,451 - INFO - ================================================================================
2025-11-12 19:15:22,452 - INFO - INICIO DE AUTOMATIZACIÓN DE CARTERA
2025-11-12 19:15:22,452 - INFO - ================================================================================
2025-11-12 19:15:22,452 - INFO - 
--- PASO 0: BÚSQUEDA DE ARCHIVOS ---
2025-11-12 19:15:22,453 - INFO - Archivo encontrado: data\ReportedeAntiguedaddeCarteraGrupal_12112025.xlsx
2025-11-12 19:15:22,453 - INFO - Archivo encontrado: data\Situación_de_cartera_12112025.xlsx
2025-11-12 19:15:22,454 - INFO - Archivo encontrado: data\Cobranza_12112025.xlsx
2025-11-12 19:15:22,455 - INFO - Archivo encontrado: data/AHORROS.xlsx
2025-11-12 19:15:22,455 - INFO - 
--- PASO 1: CARGA DE ARCHIVOS ---
2025-11-12 19:15:22,455 - INFO - Cargando ANTIGÜEDAD desde: data\ReportedeAntiguedaddeCarteraGrupal_12112025.xlsx
2025-11-12 19:15:22,474 - INFO - Hoja detectada: '121125'
2025-11-12 19:15:22,628 - INFO - ANTIGÜEDAD cargado: (206, 59)
2025-11-12 19:15:22,628 - INFO - Columnas: ['cod_region', 'coordinacion', 'nombre_de_gerente', 'codigo_promotor', 'nombre_promotor', 'codigo_recuperador', 'nombre_recuperador', 'cod_grupo_solidario', 'ciclo', 'grupo_solidario']...
2025-11-12 19:15:22,629 - INFO - No se encontraron IDs duplicados
2025-11-12 19:15:22,629 - INFO - Cargando SITUACIÓN DE CARTERA desde: data\Situación_de_cartera_12112025.xlsx
2025-11-12 19:15:22,747 - INFO - SITUACIÓN DE CARTERA cargada: (206, 43)
2025-11-12 19:15:22,747 - INFO - Columnas: ['codigo_ofic_cred', 'nombre_oficial_de_credito', 'codigo_promotor_cred', 'nombre_promotor_cred', 'codigo_coord', 'nombre_coordinacion', 'codigo_ger_regi', 'nombre_gerencia_regional', 'nombre_codigo', 'nombre_acreditado_cliente']...
2025-11-12 19:15:22,748 - INFO - Columna de código renombrada: nombre_codigo -> codigo
2025-11-12 19:15:22,749 - INFO - Cargando REPORTE DE COBRANZA desde: data\Cobranza_12112025.xlsx
2025-11-12 19:15:22,922 - INFO - REPORTE DE COBRANZA cargado: (207, 68)
2025-11-12 19:15:22,922 - INFO - Columnas: ['regional', 'regional1', 'coordinacion', 'coordinacion1', 'de_credito', 'de_credito1', 'gpo', 'cliente_grupo', 'unnamed:_8', 'del_cliente']...
2025-11-12 19:15:22,922 - INFO - Cargando AHORROS (ACUMULADO) desde: data/AHORROS.xlsx
2025-11-12 19:15:22,958 - INFO - AHORROS cargado: (208, 4)
2025-11-12 19:15:22,958 - INFO - Columnas: ['id', 'grupo', 'ciclo', 'ahorro_acumulado']
2025-11-12 19:15:22,958 - INFO - PARCHE PROMOTORES cargado: 1 correcciones
2025-11-12 19:15:22,959 - INFO - 
--- PASO 2: GENERACIÓN DE CARTERA ---
2025-11-12 19:15:22,959 - INFO - Iniciando generación de cartera (VERSIÓN CORREGIDA)...
2025-11-12 19:15:22,959 - INFO - Registros en antiguedad: 206
2025-11-12 19:15:22,961 - INFO - ID de grupo generados: 0    000089
1    000145
2    000069
3    000079
4    000104
Name: id_de_grupo, dtype: object
2025-11-12 19:15:22,976 - INFO - Después de joins: 208 registros
2025-11-12 19:15:22,977 - INFO - NaN en situacion: 2
2025-11-12 19:15:22,977 - INFO - NaN en cobranza: 1
2025-11-12 19:15:22,977 - INFO - NaN en ahorros: 3
2025-11-12 19:15:22,979 - INFO - Parche aplicado: 1 correcciones
2025-11-12 19:15:22,981 - INFO - Estatus calculados: {'Vigente': 206, '': 2}
2025-11-12 19:15:22,995 - INFO - Cartera generada exitosamente: 208 filas x 36 columnas
2025-11-12 19:15:22,996 - INFO - 
--- PASO 3: GUARDADO DE RESULTADO CON FORMATO ---
2025-11-12 19:15:22,996 - INFO - ================================================================================
2025-11-12 19:15:22,996 - INFO - GUARDANDO DATAFRAME CON FORMATO
2025-11-12 19:15:22,996 - INFO - ================================================================================
2025-11-12 19:15:22,996 - INFO - 
1. Cargando plantilla de headers: plantilla/CARTERA_HEADERS.xlsx
2025-11-12 19:15:23,004 - INFO - Plantilla cargada: 6 filas x 36 columnas (6.1 KB)
2025-11-12 19:15:23,004 - INFO - 
2. Creando nuevo workbook...
2025-11-12 19:15:23,005 - INFO - 
3. Copiando headers desde plantilla...
2025-11-12 19:15:23,005 - INFO - Copiando headers (filas 1-6) con formato...
2025-11-12 19:15:23,050 - INFO - Headers copiados: 36 columnas
2025-11-12 19:15:23,050 - INFO - 
4. Pegando datos del DataFrame...
2025-11-12 19:15:23,050 - INFO - Pegando DataFrame (208 filas x 36 columnas) desde fila 7...
2025-11-12 19:15:23,089 - INFO - Datos pegados hasta fila 214
2025-11-12 19:15:23,089 - INFO - 
5. Formato de datos: Se aplicará automáticamente por la tabla Excel
2025-11-12 19:15:23,089 - INFO - 
6. Creando tabla de Excel con totales...
2025-11-12 19:15:23,089 - INFO - Creando tabla Excel 'TablaCartera' desde fila 6 hasta 214...
2025-11-12 19:15:23,089 - INFO - Rango de tabla: A6:AJ215
2025-11-12 19:15:23,089 - INFO - Fila de totales: 215
2025-11-12 19:15:23,089 - INFO - Nombres de columnas extraídos: 36
2025-11-12 19:15:23,090 - INFO -   Columna 6 'Monto del crédito': SUM
2025-11-12 19:15:23,090 - INFO -   Columna 13 'Pago Semanal': SUM
2025-11-12 19:15:23,090 - INFO -   Columna 15 'Cartera vigente sistema': SUM
2025-11-12 19:15:23,090 - INFO -   Columna 16 'Carera vigente inicial': SUM
2025-11-12 19:15:23,090 - INFO -   Columna 17 'Cartera vigente calculada': SUM
2025-11-12 19:15:23,090 - INFO -   Columna 18 'Cartera Insoluta': SUM
2025-11-12 19:15:23,090 - INFO -   Columna 19 'Diferencia Validación vigente': SUM
2025-11-12 19:15:23,090 - INFO -   Columna 20 'Ahorro Consumido': SUM
2025-11-12 19:15:23,090 - INFO -   Columna 21 'Cartera Vencida Estadistica': SUM
2025-11-12 19:15:23,090 - INFO -   Columna 22 'Cartera vencida Total': SUM
2025-11-12 19:15:23,090 - INFO -   Columna 24 'Saldo en riesgo': SUM
2025-11-12 19:15:23,090 - INFO -   Columna 25 'Saldo 
ahorro 
acumulado': SUM
2025-11-12 19:15:23,090 - INFO -   Columna 26 'Monto promedio del grupo': SUM
2025-11-12 19:15:23,091 - INFO -   Columna 33 'Ahorro Acumulado': SUM
2025-11-12 19:15:23,091 - INFO - Escribiendo fórmulas en fila de totales...
2025-11-12 19:15:23,091 - INFO -   Fórmula en columna 6: =SUBTOTAL(109,F7:F214)
2025-11-12 19:15:23,091 - INFO -   Fórmula en columna 13: =SUBTOTAL(109,M7:M214)
2025-11-12 19:15:23,091 - INFO -   Fórmula en columna 15: =SUBTOTAL(109,O7:O214)
2025-11-12 19:15:23,091 - INFO -   Fórmula en columna 16: =SUBTOTAL(109,P7:P214)
2025-11-12 19:15:23,091 - INFO -   Fórmula en columna 17: =SUBTOTAL(109,Q7:Q214)
2025-11-12 19:15:23,091 - INFO -   Fórmula en columna 18: =SUBTOTAL(109,R7:R214)
2025-11-12 19:15:23,091 - INFO -   Fórmula en columna 19: =SUBTOTAL(109,S7:S214)
2025-11-12 19:15:23,091 - INFO -   Fórmula en columna 20: =SUBTOTAL(109,T7:T214)
2025-11-12 19:15:23,091 - INFO -   Fórmula en columna 21: =SUBTOTAL(109,U7:U214)
2025-11-12 19:15:23,091 - INFO -   Fórmula en columna 22: =SUBTOTAL(109,V7:V214)
2025-11-12 19:15:23,091 - INFO -   Fórmula en columna 24: =SUBTOTAL(109,X7:X214)
2025-11-12 19:15:23,092 - INFO -   Fórmula en columna 25: =SUBTOTAL(109,Y7:Y214)
2025-11-12 19:15:23,092 - INFO -   Fórmula en columna 26: =SUBTOTAL(109,Z7:Z214)
2025-11-12 19:15:23,092 - INFO -   Fórmula en columna 33: =SUBTOTAL(109,AG7:AG214)
2025-11-12 19:15:23,092 - INFO - Tabla creada exitosamente con 208 filas de datos + fila totales
2025-11-12 19:15:23,092 - INFO - Totales configurados en 14 columnas con fórmulas SUBTOTAL
2025-11-12 19:15:23,092 - INFO - Fila de totales: Formato aplicado automáticamente por la tabla
2025-11-12 19:15:23,092 - INFO - 
7. Guardando archivo: output_automatizado.xlsx
2025-11-12 19:15:23,219 - INFO - 
================================================================================
2025-11-12 19:15:23,219 - INFO - ARCHIVO GUARDADO EXITOSAMENTE
2025-11-12 19:15:23,219 - INFO - ================================================================================
2025-11-12 19:15:23,219 - INFO - 
Archivo: output_automatizado.xlsx
2025-11-12 19:15:23,219 - INFO - Filas de datos: 208
2025-11-12 19:15:23,219 - INFO - Columnas: 36
2025-11-12 19:15:23,219 - INFO - Formato: Idéntico al machote
2025-11-12 19:15:23,219 - INFO - Tabla Excel: Con totales automáticos
2025-11-12 19:15:23,219 - INFO - ================================================================================
2025-11-12 19:15:23,220 - INFO - OK - Archivo guardado con formato: output_automatizado.xlsx
2025-11-12 19:15:23,220 - INFO - 
--- PASO 4: GENERACIÓN DE HOJA MORA ---
2025-11-12 19:15:23,220 - INFO - 
Iniciando generación de hoja MORA...
2025-11-12 19:15:23,221 - INFO - Registros con %mora > 5%: 7 de 208
2025-11-12 19:15:23,223 - INFO - Hoja MORA generada con 7 registros y 14 columnas
2025-11-12 19:15:23,223 - INFO - 
================================================================================
2025-11-12 19:15:23,224 - INFO - AGREGANDO HOJA MORA
2025-11-12 19:15:23,224 - INFO - ================================================================================
2025-11-12 19:15:23,224 - INFO - 
1. Abriendo archivo: output_automatizado.xlsx
2025-11-12 19:15:23,383 - INFO - 
2. Creando hoja 'Mora'
2025-11-12 19:15:23,383 - INFO - 
3. Copiando formato de headers desde plantilla
2025-11-12 19:15:23,404 - INFO - 
4. Estableciendo headers de MORA
2025-11-12 19:15:23,404 - INFO - 
5. Pegando 7 filas de datos
2025-11-12 19:15:23,406 - INFO - 
6. Creando tabla Excel con totales
2025-11-12 19:15:23,406 - INFO -    Creando tabla: A6:N14
2025-11-12 19:15:23,407 - INFO -    Tabla 'TablaMora' creada con totales automáticos
2025-11-12 19:15:23,407 - INFO -    Fórmulas SUBTOTAL escritas en 6 columnas
2025-11-12 19:15:23,407 - INFO - 
7. Guardando archivo con hoja MORA
2025-11-12 19:15:23,529 - INFO - 
================================================================================
2025-11-12 19:15:23,529 - INFO - HOJA MORA AGREGADA EXITOSAMENTE
2025-11-12 19:15:23,529 - INFO - ================================================================================
2025-11-12 19:15:23,529 - INFO - 
Registros en MORA: 7
2025-11-12 19:15:23,529 - INFO - Filtro: %mora > 5%
2025-11-12 19:15:23,529 - INFO - Columnas amarillas: %mora, Días de mora
2025-11-12 19:15:23,529 - INFO - ================================================================================
2025-11-12 19:15:23,529 - INFO - OK - Hoja MORA agregada con 7 registros
2025-11-12 19:15:23,529 - INFO - 
--- PASO 5: VALIDACIÓN ---
2025-11-12 19:15:23,530 - INFO - Machote no encontrado - validación omitida (no es necesario)
2025-11-12 19:15:23,530 - INFO - 
================================================================================
2025-11-12 19:15:23,530 - INFO - AUTOMATIZACIÓN COMPLETADA EXITOSAMENTE
2025-11-12 19:15:23,530 - INFO - ================================================================================
2025-11-12 19:40:13,650 - INFO - ================================================================================
2025-11-12 19:40:13,650 - INFO - INICIO DE AUTOMATIZACIÓN DE CARTERA
2025-11-12 19:40:13,650 - INFO - ================================================================================
2025-11-12 19:40:13,650 - INFO - 
--- PASO 0: BÚSQUEDA DE ARCHIVOS ---
2025-11-12 19:40:13,651 - INFO - Archivo encontrado: data\ReportedeAntiguedaddeCarteraGrupal_12112025.xlsx
2025-11-12 19:40:13,651 - INFO - Archivo encontrado: data\Situación_de_cartera_12112025.xlsx
2025-11-12 19:40:13,651 - INFO - Archivo encontrado: data\Cobranza_12112025.xlsx
2025-11-12 19:40:13,652 - INFO - Archivo encontrado: data/AHORROS.xlsx
2025-11-12 19:40:13,652 - INFO - 
--- PASO 1: CARGA DE ARCHIVOS ---
2025-11-12 19:40:13,652 - INFO - Cargando ANTIGÜEDAD desde: data\ReportedeAntiguedaddeCarteraGrupal_12112025.xlsx
2025-11-12 19:40:13,672 - INFO - Hoja detectada: '121125'
2025-11-12 19:40:13,815 - INFO - ANTIGÜEDAD cargado: (206, 59)
2025-11-12 19:40:13,816 - INFO - Columnas: ['cod_region', 'coordinacion', 'nombre_de_gerente', 'codigo_promotor', 'nombre_promotor', 'codigo_recuperador', 'nombre_recuperador', 'cod_grupo_solidario', 'ciclo', 'grupo_solidario']...
2025-11-12 19:40:13,820 - INFO - No se encontraron IDs duplicados
2025-11-12 19:40:13,820 - INFO - Cargando SITUACIÓN DE CARTERA desde: data\Situación_de_cartera_12112025.xlsx
2025-11-12 19:40:13,942 - INFO - SITUACIÓN DE CARTERA cargada: (206, 43)
2025-11-12 19:40:13,943 - INFO - Columnas: ['codigo_ofic_cred', 'nombre_oficial_de_credito', 'codigo_promotor_cred', 'nombre_promotor_cred', 'codigo_coord', 'nombre_coordinacion', 'codigo_ger_regi', 'nombre_gerencia_regional', 'nombre_codigo', 'nombre_acreditado_cliente']...
2025-11-12 19:40:13,945 - INFO - Columna de código renombrada: nombre_codigo -> codigo
2025-11-12 19:40:13,947 - INFO - Cargando REPORTE DE COBRANZA desde: data\Cobranza_12112025.xlsx
2025-11-12 19:40:14,126 - INFO - REPORTE DE COBRANZA cargado: (207, 68)
2025-11-12 19:40:14,126 - INFO - Columnas: ['regional', 'regional1', 'coordinacion', 'coordinacion1', 'de_credito', 'de_credito1', 'gpo', 'cliente_grupo', 'unnamed:_8', 'del_cliente']...
2025-11-12 19:40:14,127 - INFO - Cargando AHORROS (ACUMULADO) desde: data/AHORROS.xlsx
2025-11-12 19:40:14,164 - INFO - AHORROS cargado: (208, 4)
2025-11-12 19:40:14,164 - INFO - Columnas: ['id', 'grupo', 'ciclo', 'ahorro_acumulado']
2025-11-12 19:40:14,164 - INFO - PARCHE PROMOTORES cargado: 1 correcciones
2025-11-12 19:40:14,164 - INFO - 
--- PASO 2: GENERACIÓN DE CARTERA ---
2025-11-12 19:40:14,165 - INFO - Iniciando generación de cartera (VERSIÓN CORREGIDA)...
2025-11-12 19:40:14,165 - INFO - Registros en antiguedad: 206
2025-11-12 19:40:14,168 - INFO - ID de grupo generados: 0    000089
1    000145
2    000069
3    000079
4    000104
Name: id_de_grupo, dtype: object
2025-11-12 19:40:14,191 - INFO - Después de joins: 208 registros
2025-11-12 19:40:14,192 - INFO - NaN en situacion: 2
2025-11-12 19:40:14,193 - INFO - NaN en cobranza: 1
2025-11-12 19:40:14,193 - INFO - NaN en ahorros: 3
2025-11-12 19:40:14,195 - INFO - Parche aplicado: 1 correcciones
2025-11-12 19:40:14,198 - INFO - Estatus calculados: {'Vigente': 206, '': 2}
2025-11-12 19:40:14,217 - INFO - Cartera generada exitosamente: 208 filas x 36 columnas
2025-11-12 19:40:14,217 - INFO - 
--- PASO 3: GUARDADO DE RESULTADO CON FORMATO ---
2025-11-12 19:40:14,217 - INFO - ================================================================================
2025-11-12 19:40:14,217 - INFO - GUARDANDO DATAFRAME CON FORMATO
2025-11-12 19:40:14,217 - INFO - ================================================================================
2025-11-12 19:40:14,217 - INFO - 
1. Cargando plantilla de headers: plantilla/CARTERA_HEADERS.xlsx
2025-11-12 19:40:14,227 - INFO - Plantilla cargada: 6 filas x 36 columnas (6.1 KB)
2025-11-12 19:40:14,227 - INFO - 
2. Creando nuevo workbook...
2025-11-12 19:40:14,228 - INFO - 
3. Copiando headers desde plantilla...
2025-11-12 19:40:14,229 - INFO - Copiando headers (filas 1-6) con formato...
2025-11-12 19:40:14,267 - INFO - Headers copiados: 36 columnas
2025-11-12 19:40:14,267 - INFO - 
4. Pegando datos del DataFrame...
2025-11-12 19:40:14,267 - INFO - Pegando DataFrame (208 filas x 36 columnas) desde fila 7...
2025-11-12 19:40:14,307 - INFO - Datos pegados hasta fila 214
2025-11-12 19:40:14,307 - INFO - 
5. Formato de datos: Se aplicará automáticamente por la tabla Excel
2025-11-12 19:40:14,307 - INFO - 
6. Creando tabla de Excel con totales...
2025-11-12 19:40:14,307 - INFO - Creando tabla Excel 'TablaCartera' desde fila 6 hasta 214...
2025-11-12 19:40:14,308 - INFO - Rango de tabla: A6:AJ215
2025-11-12 19:40:14,308 - INFO - Fila de totales: 215
2025-11-12 19:40:14,308 - INFO - Nombres de columnas extraídos: 36
2025-11-12 19:40:14,308 - INFO -   Columna 6 'Monto del crédito': SUM
2025-11-12 19:40:14,308 - INFO -   Columna 13 'Pago Semanal': SUM
2025-11-12 19:40:14,308 - INFO -   Columna 15 'Cartera vigente sistema': SUM
2025-11-12 19:40:14,308 - INFO -   Columna 16 'Carera vigente inicial': SUM
2025-11-12 19:40:14,308 - INFO -   Columna 17 'Cartera vigente calculada': SUM
2025-11-12 19:40:14,308 - INFO -   Columna 18 'Cartera Insoluta': SUM
2025-11-12 19:40:14,308 - INFO -   Columna 19 'Diferencia Validación vigente': SUM
2025-11-12 19:40:14,309 - INFO -   Columna 20 'Ahorro Consumido': SUM
2025-11-12 19:40:14,309 - INFO -   Columna 21 'Cartera Vencida Estadistica': SUM
2025-11-12 19:40:14,309 - INFO -   Columna 22 'Cartera vencida Total': SUM
2025-11-12 19:40:14,309 - INFO -   Columna 24 'Saldo en riesgo': SUM
2025-11-12 19:40:14,309 - INFO -   Columna 25 'Saldo 
ahorro 
acumulado': SUM
2025-11-12 19:40:14,309 - INFO -   Columna 26 'Monto promedio del grupo': SUM
2025-11-12 19:40:14,309 - INFO -   Columna 33 'Ahorro Acumulado': SUM
2025-11-12 19:40:14,310 - INFO - Escribiendo fórmulas en fila de totales...
2025-11-12 19:40:14,310 - INFO -   Fórmula en columna 6: =SUBTOTAL(109,F7:F214)
2025-11-12 19:40:14,310 - INFO -   Fórmula en columna 13: =SUBTOTAL(109,M7:M214)
2025-11-12 19:40:14,310 - INFO -   Fórmula en columna 15: =SUBTOTAL(109,O7:O214)
2025-11-12 19:40:14,311 - INFO -   Fórmula en columna 16: =SUBTOTAL(109,P7:P214)
2025-11-12 19:40:14,311 - INFO -   Fórmula en columna 17: =SUBTOTAL(109,Q7:Q214)
2025-11-12 19:40:14,311 - INFO -   Fórmula en columna 18: =SUBTOTAL(109,R7:R214)
2025-11-12 19:40:14,311 - INFO -   Fórmula en columna 19: =SUBTOTAL(109,S7:S214)
2025-11-12 19:40:14,311 - INFO -   Fórmula en columna 20: =SUBTOTAL(109,T7:T214)
2025-11-12 19:40:14,311 - INFO -   Fórmula en columna 21: =SUBTOTAL(109,U7:U214)
2025-11-12 19:40:14,311 - INFO -   Fórmula en columna 22: =SUBTOTAL(109,V7:V214)
2025-11-12 19:40:14,311 - INFO -   Fórmula en columna 24: =SUBTOTAL(109,X7:X214)
2025-11-12 19:40:14,311 - INFO -   Fórmula en columna 25: =SUBTOTAL(109,Y7:Y214)
2025-11-12 19:40:14,311 - INFO -   Fórmula en columna 26: =SUBTOTAL(109,Z7:Z214)
2025-11-12 19:40:14,311 - INFO -   Fórmula en columna 33: =SUBTOTAL(109,AG7:AG214)
2025-11-12 19:40:14,311 - INFO - Tabla creada exitosamente con 208 filas de datos + fila totales
2025-11-12 19:40:14,311 - INFO - Totales configurados en 14 columnas con fórmulas SUBTOTAL
2025-11-12 19:40:14,312 - INFO - Fila de totales: Formato aplicado automáticamente por la tabla
2025-11-12 19:40:14,312 - INFO - 
7. Guardando archivo: output_automatizado.xlsx
2025-11-12 19:40:14,312 - ERROR - 
ERROR: [Errno 13] Permission denied: 'output_automatizado.xlsx'
Traceback (most recent call last):
  File "C:\Users\uzzie\Documents\Jale\merge-dataframes\analizar_y_automatizar.py", line 314, in main
    guardar_con_formato(df_cartera, RUTA_PLANTILLA, RUTA_OUTPUT)
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\uzzie\Documents\Jale\merge-dataframes\formato_excel.py", line 305, in guardar_con_formato
    wb_nuevo.save(ruta_output)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\uzzie\miniconda3\Lib\site-packages\openpyxl\workbook\workbook.py", line 386, in save
    save_workbook(self, filename)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "C:\Users\uzzie\miniconda3\Lib\site-packages\openpyxl\writer\excel.py", line 291, in save_workbook
    archive = ZipFile(filename, 'w', ZIP_DEFLATED, allowZip64=True)
  File "C:\Users\uzzie\miniconda3\Lib\zipfile\__init__.py", line 1367, in __init__
    self.fp = io.open(file, filemode)
              ~~~~~~~^^^^^^^^^^^^^^^^
PermissionError: [Errno 13] Permission denied: 'output_automatizado.xlsx'
2025-11-12 19:42:57,703 - INFO - ================================================================================
2025-11-12 19:42:57,703 - INFO - INICIO DE AUTOMATIZACIÓN DE CARTERA
2025-11-12 19:42:57,703 - INFO - ================================================================================
2025-11-12 19:42:57,703 - INFO - 
--- PASO 0: BÚSQUEDA DE ARCHIVOS ---
2025-11-12 19:42:57,704 - INFO - Archivo encontrado: data\ReportedeAntiguedaddeCarteraGrupal_12112025.xlsx
2025-11-12 19:42:57,704 - INFO - Archivo encontrado: data\Situación_de_cartera_12112025.xlsx
2025-11-12 19:42:57,705 - INFO - Archivo encontrado: data\Cobranza_12112025.xlsx
2025-11-12 19:42:57,705 - INFO - Archivo encontrado: data/AHORROS.xlsx
2025-11-12 19:42:57,705 - INFO - 
--- PASO 1: CARGA DE ARCHIVOS ---
2025-11-12 19:42:57,705 - INFO - Cargando ANTIGÜEDAD desde: data\ReportedeAntiguedaddeCarteraGrupal_12112025.xlsx
2025-11-12 19:42:57,724 - INFO - Hoja detectada: '121125'
2025-11-12 19:42:57,869 - INFO - ANTIGÜEDAD cargado: (206, 59)
2025-11-12 19:42:57,869 - INFO - Columnas: ['cod_region', 'coordinacion', 'nombre_de_gerente', 'codigo_promotor', 'nombre_promotor', 'codigo_recuperador', 'nombre_recuperador', 'cod_grupo_solidario', 'ciclo', 'grupo_solidario']...
2025-11-12 19:42:57,870 - INFO - No se encontraron IDs duplicados
2025-11-12 19:42:57,870 - INFO - Cargando SITUACIÓN DE CARTERA desde: data\Situación_de_cartera_12112025.xlsx
2025-11-12 19:42:57,989 - INFO - SITUACIÓN DE CARTERA cargada: (206, 43)
2025-11-12 19:42:57,990 - INFO - Columnas: ['codigo_ofic_cred', 'nombre_oficial_de_credito', 'codigo_promotor_cred', 'nombre_promotor_cred', 'codigo_coord', 'nombre_coordinacion', 'codigo_ger_regi', 'nombre_gerencia_regional', 'nombre_codigo', 'nombre_acreditado_cliente']...
2025-11-12 19:42:57,990 - INFO - Columna de código renombrada: nombre_codigo -> codigo
2025-11-12 19:42:57,992 - INFO - Cargando REPORTE DE COBRANZA desde: data\Cobranza_12112025.xlsx
2025-11-12 19:42:58,172 - INFO - REPORTE DE COBRANZA cargado: (207, 68)
2025-11-12 19:42:58,172 - INFO - Columnas: ['regional', 'regional1', 'coordinacion', 'coordinacion1', 'de_credito', 'de_credito1', 'gpo', 'cliente_grupo', 'unnamed:_8', 'del_cliente']...
2025-11-12 19:42:58,172 - INFO - Cargando AHORROS (ACUMULADO) desde: data/AHORROS.xlsx
2025-11-12 19:42:58,208 - INFO - AHORROS cargado: (208, 4)
2025-11-12 19:42:58,209 - INFO - Columnas: ['id', 'grupo', 'ciclo', 'ahorro_acumulado']
2025-11-12 19:42:58,209 - INFO - PARCHE PROMOTORES cargado: 1 correcciones
2025-11-12 19:42:58,209 - INFO - 
--- PASO 2: GENERACIÓN DE CARTERA ---
2025-11-12 19:42:58,209 - INFO - Iniciando generación de cartera (VERSIÓN CORREGIDA)...
2025-11-12 19:42:58,209 - INFO - Registros en antiguedad: 206
2025-11-12 19:42:58,211 - INFO - ID de grupo generados: 0    000089
1    000145
2    000069
3    000079
4    000104
Name: id_de_grupo, dtype: object
2025-11-12 19:42:58,225 - INFO - Después de joins: 208 registros
2025-11-12 19:42:58,226 - INFO - NaN en situacion: 2
2025-11-12 19:42:58,226 - INFO - NaN en cobranza: 1
2025-11-12 19:42:58,226 - INFO - NaN en ahorros: 3
2025-11-12 19:42:58,228 - INFO - Parche aplicado: 1 correcciones
2025-11-12 19:42:58,230 - INFO - Estatus calculados: {'Vigente': 206, '': 2}
2025-11-12 19:42:58,244 - INFO - Cartera generada exitosamente: 208 filas x 36 columnas
2025-11-12 19:42:58,244 - INFO - 
--- PASO 3: GUARDADO DE RESULTADO CON FORMATO ---
2025-11-12 19:42:58,244 - INFO - ================================================================================
2025-11-12 19:42:58,245 - INFO - GUARDANDO DATAFRAME CON FORMATO
2025-11-12 19:42:58,245 - INFO - ================================================================================
2025-11-12 19:42:58,245 - INFO - 
1. Cargando plantilla de headers: plantilla/CARTERA_HEADERS.xlsx
2025-11-12 19:42:58,254 - INFO - Plantilla cargada: 6 filas x 36 columnas (6.1 KB)
2025-11-12 19:42:58,254 - INFO - 
2. Creando nuevo workbook...
2025-11-12 19:42:58,255 - INFO - 
3. Copiando headers desde plantilla...
2025-11-12 19:42:58,256 - INFO - Copiando headers (filas 1-6) con formato...
2025-11-12 19:42:58,295 - INFO - Headers copiados: 36 columnas
2025-11-12 19:42:58,295 - INFO - 
4. Pegando datos del DataFrame...
2025-11-12 19:42:58,295 - INFO - Pegando DataFrame (208 filas x 36 columnas) desde fila 7...
2025-11-12 19:42:58,335 - INFO - Datos pegados hasta fila 214
2025-11-12 19:42:58,335 - INFO - 
5. Formato de datos: Se aplicará automáticamente por la tabla Excel
2025-11-12 19:42:58,336 - INFO - 
6. Creando tabla de Excel con totales...
2025-11-12 19:42:58,336 - INFO - Creando tabla Excel 'TablaCartera' desde fila 6 hasta 214...
2025-11-12 19:42:58,336 - INFO - Rango de tabla: A6:AJ215
2025-11-12 19:42:58,336 - INFO - Fila de totales: 215
2025-11-12 19:42:58,336 - INFO - Nombres de columnas extraídos: 36
2025-11-12 19:42:58,336 - INFO -   Columna 6 'Monto del crédito': SUM
2025-11-12 19:42:58,336 - INFO -   Columna 13 'Pago Semanal': SUM
2025-11-12 19:42:58,336 - INFO -   Columna 15 'Cartera vigente sistema': SUM
2025-11-12 19:42:58,336 - INFO -   Columna 16 'Carera vigente inicial': SUM
2025-11-12 19:42:58,336 - INFO -   Columna 17 'Cartera vigente calculada': SUM
2025-11-12 19:42:58,336 - INFO -   Columna 18 'Cartera Insoluta': SUM
2025-11-12 19:42:58,337 - INFO -   Columna 19 'Diferencia Validación vigente': SUM
2025-11-12 19:42:58,337 - INFO -   Columna 20 'Ahorro Consumido': SUM
2025-11-12 19:42:58,337 - INFO -   Columna 21 'Cartera Vencida Estadistica': SUM
2025-11-12 19:42:58,337 - INFO -   Columna 22 'Cartera vencida Total': SUM
2025-11-12 19:42:58,337 - INFO -   Columna 24 'Saldo en riesgo': SUM
2025-11-12 19:42:58,337 - INFO -   Columna 25 'Saldo 
ahorro 
acumulado': SUM
2025-11-12 19:42:58,337 - INFO -   Columna 26 'Monto promedio del grupo': SUM
2025-11-12 19:42:58,337 - INFO -   Columna 33 'Ahorro Acumulado': SUM
2025-11-12 19:42:58,337 - INFO - Escribiendo fórmulas en fila de totales...
2025-11-12 19:42:58,337 - INFO -   Fórmula en columna 6: =SUBTOTAL(109,F7:F214)
2025-11-12 19:42:58,337 - INFO -   Fórmula en columna 13: =SUBTOTAL(109,M7:M214)
2025-11-12 19:42:58,338 - INFO -   Fórmula en columna 15: =SUBTOTAL(109,O7:O214)
2025-11-12 19:42:58,338 - INFO -   Fórmula en columna 16: =SUBTOTAL(109,P7:P214)
2025-11-12 19:42:58,338 - INFO -   Fórmula en columna 17: =SUBTOTAL(109,Q7:Q214)
2025-11-12 19:42:58,338 - INFO -   Fórmula en columna 18: =SUBTOTAL(109,R7:R214)
2025-11-12 19:42:58,338 - INFO -   Fórmula en columna 19: =SUBTOTAL(109,S7:S214)
2025-11-12 19:42:58,338 - INFO -   Fórmula en columna 20: =SUBTOTAL(109,T7:T214)
2025-11-12 19:42:58,338 - INFO -   Fórmula en columna 21: =SUBTOTAL(109,U7:U214)
2025-11-12 19:42:58,338 - INFO -   Fórmula en columna 22: =SUBTOTAL(109,V7:V214)
2025-11-12 19:42:58,338 - INFO -   Fórmula en columna 24: =SUBTOTAL(109,X7:X214)
2025-11-12 19:42:58,338 - INFO -   Fórmula en columna 25: =SUBTOTAL(109,Y7:Y214)
2025-11-12 19:42:58,338 - INFO -   Fórmula en columna 26: =SUBTOTAL(109,Z7:Z214)
2025-11-12 19:42:58,338 - INFO -   Fórmula en columna 33: =SUBTOTAL(109,AG7:AG214)
2025-11-12 19:42:58,338 - INFO - Tabla creada exitosamente con 208 filas de datos + fila totales
2025-11-12 19:42:58,338 - INFO - Totales configurados en 14 columnas con fórmulas SUBTOTAL
2025-11-12 19:42:58,338 - INFO - Fila de totales: Formato aplicado automáticamente por la tabla
2025-11-12 19:42:58,338 - INFO - 
7. Guardando archivo: output_automatizado.xlsx
2025-11-12 19:42:58,470 - INFO - 
================================================================================
2025-11-12 19:42:58,470 - INFO - ARCHIVO GUARDADO EXITOSAMENTE
2025-11-12 19:42:58,470 - INFO - ================================================================================
2025-11-12 19:42:58,470 - INFO - 
Archivo: output_automatizado.xlsx
2025-11-12 19:42:58,470 - INFO - Filas de datos: 208
2025-11-12 19:42:58,470 - INFO - Columnas: 36
2025-11-12 19:42:58,470 - INFO - Formato: Idéntico al machote
2025-11-12 19:42:58,470 - INFO - Tabla Excel: Con totales automáticos
2025-11-12 19:42:58,470 - INFO - ================================================================================
2025-11-12 19:42:58,470 - INFO - OK - Archivo guardado con formato: output_automatizado.xlsx
2025-11-12 19:42:58,471 - INFO - 
--- PASO 4: GENERACIÓN DE HOJA MORA ---
2025-11-12 19:42:58,471 - INFO - 
Iniciando generación de hoja MORA...
2025-11-12 19:42:58,472 - INFO - Registros con %mora > 5%: 7 de 208
2025-11-12 19:42:58,474 - INFO - Hoja MORA generada con 7 registros y 14 columnas
2025-11-12 19:42:58,474 - INFO - 
================================================================================
2025-11-12 19:42:58,474 - INFO - AGREGANDO HOJA MORA
2025-11-12 19:42:58,474 - INFO - ================================================================================
2025-11-12 19:42:58,474 - INFO - 
1. Abriendo archivo: output_automatizado.xlsx
2025-11-12 19:42:58,647 - INFO - 
2. Creando hoja 'Mora'
2025-11-12 19:42:58,648 - INFO - 
3. Copiando formato de headers desde plantilla
2025-11-12 19:42:58,669 - INFO - 
4. Estableciendo headers de MORA
2025-11-12 19:42:58,669 - INFO - 
5. Pegando 7 filas de datos
2025-11-12 19:42:58,671 - INFO - 
6. Creando tabla Excel con totales
2025-11-12 19:42:58,671 - INFO -    Creando tabla: A6:N14
2025-11-12 19:42:58,672 - INFO -    Tabla 'TablaMora' creada con totales automáticos
2025-11-12 19:42:58,672 - INFO -    Fórmulas SUBTOTAL escritas en 6 columnas
2025-11-12 19:42:58,672 - INFO - 
7. Guardando archivo con hoja MORA
2025-11-12 19:42:58,789 - INFO - 
================================================================================
2025-11-12 19:42:58,789 - INFO - HOJA MORA AGREGADA EXITOSAMENTE
2025-11-12 19:42:58,789 - INFO - ================================================================================
2025-11-12 19:42:58,789 - INFO - 
Registros en MORA: 7
2025-11-12 19:42:58,789 - INFO - Filtro: %mora > 5%
2025-11-12 19:42:58,789 - INFO - Columnas amarillas: %mora, Días de mora
2025-11-12 19:42:58,789 - INFO - ================================================================================
2025-11-12 19:42:58,789 - INFO - OK - Hoja MORA agregada con 7 registros
2025-11-12 19:42:58,789 - INFO - 
--- PASO 5: VALIDACIÓN ---
2025-11-12 19:42:58,790 - INFO - Machote no encontrado - validación omitida (no es necesario)
2025-11-12 19:42:58,790 - INFO - 
================================================================================
2025-11-12 19:42:58,790 - INFO - AUTOMATIZACIÓN COMPLETADA EXITOSAMENTE
2025-11-12 19:42:58,790 - INFO - ================================================================================
2025-11-12 19:45:56,425 - INFO - Cargando ANTIGÜEDAD desde: data/ReportedeAntiguedaddeCarteraGrupal_12112025.xlsx
2025-11-12 19:45:56,463 - INFO - Hoja detectada: '121125'
2025-11-12 19:45:56,696 - INFO - ANTIGÜEDAD cargado: (206, 59)
2025-11-12 19:45:56,697 - INFO - Columnas: ['cod_region', 'coordinacion', 'nombre_de_gerente', 'codigo_promotor', 'nombre_promotor', 'codigo_recuperador', 'nombre_recuperador', 'cod_grupo_solidario', 'ciclo', 'grupo_solidario']...
2025-11-12 19:45:56,702 - INFO - No se encontraron IDs duplicados
2025-11-12 19:46:24,021 - INFO - Cargando ANTIGÜEDAD desde: data/ReportedeAntiguedaddeCarteraGrupal_12112025.xlsx
2025-11-12 19:46:24,058 - INFO - Hoja detectada: '121125'
2025-11-12 19:46:24,288 - INFO - ANTIGÜEDAD cargado: (206, 59)
2025-11-12 19:46:24,288 - INFO - Columnas: ['cod_region', 'coordinacion', 'nombre_de_gerente', 'codigo_promotor', 'nombre_promotor', 'codigo_recuperador', 'nombre_recuperador', 'cod_grupo_solidario', 'ciclo', 'grupo_solidario']...
2025-11-12 19:46:24,293 - INFO - No se encontraron IDs duplicados
2025-11-12 19:46:49,192 - INFO - Cargando SITUACIÓN DE CARTERA desde: data/SituaciÃ³n_de_cartera_12112025.xlsx
2025-11-12 19:47:32,680 - INFO - Cargando SITUACIÓN DE CARTERA desde: data\Situación_de_cartera_12112025.xlsx
2025-11-12 19:47:32,877 - INFO - SITUACIÓN DE CARTERA cargada: (206, 43)
2025-11-12 19:47:32,877 - INFO - Columnas: ['codigo_ofic_cred', 'nombre_oficial_de_credito', 'codigo_promotor_cred', 'nombre_promotor_cred', 'codigo_coord', 'nombre_coordinacion', 'codigo_ger_regi', 'nombre_gerencia_regional', 'nombre_codigo', 'nombre_acreditado_cliente']...
2025-11-12 19:47:32,880 - INFO - Columna de código renombrada: nombre_codigo -> codigo
2025-11-12 19:47:58,311 - INFO - Cargando ANTIGÜEDAD desde: data/ReportedeAntiguedaddeCarteraGrupal_12112025.xlsx
2025-11-12 19:47:58,330 - INFO - Hoja detectada: '121125'
2025-11-12 19:47:58,472 - INFO - ANTIGÜEDAD cargado: (206, 59)
2025-11-12 19:47:58,472 - INFO - Columnas: ['cod_region', 'coordinacion', 'nombre_de_gerente', 'codigo_promotor', 'nombre_promotor', 'codigo_recuperador', 'nombre_recuperador', 'cod_grupo_solidario', 'ciclo', 'grupo_solidario']...
2025-11-12 19:47:58,473 - INFO - No se encontraron IDs duplicados
2025-11-12 19:48:30,752 - INFO - Cargando ANTIGÜEDAD desde: data/ReportedeAntiguedaddeCarteraGrupal_12112025.xlsx
2025-11-12 19:48:30,771 - INFO - Hoja detectada: '121125'
2025-11-12 19:48:30,912 - INFO - ANTIGÜEDAD cargado: (206, 59)
2025-11-12 19:48:30,912 - INFO - Columnas: ['cod_region', 'coordinacion', 'nombre_de_gerente', 'codigo_promotor', 'nombre_promotor', 'codigo_recuperador', 'nombre_recuperador', 'cod_grupo_solidario', 'ciclo', 'grupo_solidario']...
2025-11-12 19:48:30,912 - INFO - No se encontraron IDs duplicados
2025-11-12 19:49:03,527 - INFO - Cargando ANTIGÜEDAD desde: data/ReportedeAntiguedaddeCarteraGrupal_12112025.xlsx
2025-11-12 19:49:03,558 - INFO - Hoja detectada: '121125'
2025-11-12 19:49:03,759 - INFO - ANTIGÜEDAD cargado: (206, 59)
2025-11-12 19:49:03,760 - INFO - Columnas: ['cod_region', 'coordinacion', 'nombre_de_gerente', 'codigo_promotor', 'nombre_promotor', 'codigo_recuperador', 'nombre_recuperador', 'cod_grupo_solidario', 'ciclo', 'grupo_solidario']...
2025-11-12 19:49:03,761 - INFO - No se encontraron IDs duplicados
2025-11-12 19:49:30,563 - INFO - Cargando ANTIGÜEDAD desde: data/ReportedeAntiguedaddeCarteraGrupal_12112025.xlsx
2025-11-12 19:49:30,581 - INFO - Hoja detectada: '121125'
2025-11-12 19:49:30,740 - INFO - ANTIGÜEDAD cargado: (206, 59)
2025-11-12 19:49:30,740 - INFO - Columnas: ['cod_region', 'coordinacion', 'nombre_de_gerente', 'codigo_promotor', 'nombre_promotor', 'codigo_recuperador', 'nombre_recuperador', 'cod_grupo_solidario', 'ciclo', 'grupo_solidario']...
2025-11-12 19:49:30,741 - INFO - No se encontraron IDs duplicados
2025-11-12 19:49:30,741 - INFO - Cargando SITUACIÓN DE CARTERA desde: data/SituaciÃ³n_de_cartera_12112025.xlsx
2025-11-12 19:49:52,569 - INFO - Cargando ANTIGÜEDAD desde: data\ReportedeAntiguedaddeCarteraGrupal_12112025.xlsx
2025-11-12 19:49:52,587 - INFO - Hoja detectada: '121125'
2025-11-12 19:49:52,724 - INFO - ANTIGÜEDAD cargado: (206, 59)
2025-11-12 19:49:52,724 - INFO - Columnas: ['cod_region', 'coordinacion', 'nombre_de_gerente', 'codigo_promotor', 'nombre_promotor', 'codigo_recuperador', 'nombre_recuperador', 'cod_grupo_solidario', 'ciclo', 'grupo_solidario']...
2025-11-12 19:49:52,725 - INFO - No se encontraron IDs duplicados
2025-11-12 19:49:52,725 - INFO - Cargando SITUACIÓN DE CARTERA desde: data\Situación_de_cartera_12112025.xlsx
2025-11-12 19:49:52,836 - INFO - SITUACIÓN DE CARTERA cargada: (206, 43)
2025-11-12 19:49:52,836 - INFO - Columnas: ['codigo_ofic_cred', 'nombre_oficial_de_credito', 'codigo_promotor_cred', 'nombre_promotor_cred', 'codigo_coord', 'nombre_coordinacion', 'codigo_ger_regi', 'nombre_gerencia_regional', 'nombre_codigo', 'nombre_acreditado_cliente']...
2025-11-12 19:49:52,837 - INFO - Columna de código renombrada: nombre_codigo -> codigo
2025-11-12 19:49:52,838 - INFO - Cargando REPORTE DE COBRANZA desde: data\Cobranza_12112025.xlsx
2025-11-12 19:49:53,018 - INFO - REPORTE DE COBRANZA cargado: (207, 68)
2025-11-12 19:49:53,018 - INFO - Columnas: ['regional', 'regional1', 'coordinacion', 'coordinacion1', 'de_credito', 'de_credito1', 'gpo', 'cliente_grupo', 'unnamed:_8', 'del_cliente']...
2025-11-12 19:49:53,019 - INFO - Cargando AHORROS (ACUMULADO) desde: data/AHORROS.xlsx
2025-11-12 19:49:53,056 - INFO - AHORROS cargado: (208, 4)
2025-11-12 19:49:53,057 - INFO - Columnas: ['id', 'grupo', 'ciclo', 'ahorro_acumulado']
2025-11-12 19:49:53,057 - INFO - Iniciando generación de cartera (VERSIÓN CORREGIDA)...
2025-11-12 19:49:53,057 - INFO - Registros en antiguedad: 206
2025-11-12 19:49:53,059 - INFO - ID de grupo generados: 0    000089
1    000145
2    000069
3    000079
4    000104
Name: id_de_grupo, dtype: object
2025-11-12 19:49:53,081 - INFO - Después de joins: 208 registros
2025-11-12 19:49:53,081 - INFO - NaN en situacion: 2
2025-11-12 19:49:53,081 - INFO - NaN en cobranza: 1
2025-11-12 19:49:53,082 - INFO - NaN en ahorros: 3
2025-11-12 19:49:53,083 - INFO - Parche aplicado: 1 correcciones
2025-11-12 19:49:53,086 - INFO - Estatus calculados: {'Vigente': 206, '': 2}
2025-11-12 19:49:53,104 - INFO - Cartera generada exitosamente: 208 filas x 36 columnas
2025-11-12 19:50:13,912 - INFO - Cargando ANTIGÜEDAD desde: data\ReportedeAntiguedaddeCarteraGrupal_12112025.xlsx
2025-11-12 19:50:13,931 - INFO - Hoja detectada: '121125'
2025-11-12 19:50:14,072 - INFO - ANTIGÜEDAD cargado: (206, 59)
2025-11-12 19:50:14,072 - INFO - Columnas: ['cod_region', 'coordinacion', 'nombre_de_gerente', 'codigo_promotor', 'nombre_promotor', 'codigo_recuperador', 'nombre_recuperador', 'cod_grupo_solidario', 'ciclo', 'grupo_solidario']...
2025-11-12 19:50:14,073 - INFO - No se encontraron IDs duplicados
2025-11-12 19:50:14,073 - INFO - Cargando SITUACIÓN DE CARTERA desde: data\Situación_de_cartera_12112025.xlsx
2025-11-12 19:50:14,190 - INFO - SITUACIÓN DE CARTERA cargada: (206, 43)
2025-11-12 19:50:14,191 - INFO - Columnas: ['codigo_ofic_cred', 'nombre_oficial_de_credito', 'codigo_promotor_cred', 'nombre_promotor_cred', 'codigo_coord', 'nombre_coordinacion', 'codigo_ger_regi', 'nombre_gerencia_regional', 'nombre_codigo', 'nombre_acreditado_cliente']...
2025-11-12 19:50:14,191 - INFO - Columna de código renombrada: nombre_codigo -> codigo
2025-11-12 19:50:14,193 - INFO - Cargando REPORTE DE COBRANZA desde: data\Cobranza_12112025.xlsx
2025-11-12 19:50:14,367 - INFO - REPORTE DE COBRANZA cargado: (207, 68)
2025-11-12 19:50:14,367 - INFO - Columnas: ['regional', 'regional1', 'coordinacion', 'coordinacion1', 'de_credito', 'de_credito1', 'gpo', 'cliente_grupo', 'unnamed:_8', 'del_cliente']...
2025-11-12 19:50:14,367 - INFO - Cargando AHORROS (ACUMULADO) desde: data/AHORROS.xlsx
2025-11-12 19:50:14,403 - INFO - AHORROS cargado: (208, 4)
2025-11-12 19:50:14,403 - INFO - Columnas: ['id', 'grupo', 'ciclo', 'ahorro_acumulado']
2025-11-12 19:50:14,404 - INFO - Iniciando generación de cartera (VERSIÓN CORREGIDA)...
2025-11-12 19:50:14,404 - INFO - Registros en antiguedad: 206
2025-11-12 19:50:14,406 - INFO - ID de grupo generados: 0    000089
1    000145
2    000069
3    000079
4    000104
Name: id_de_grupo, dtype: object
2025-11-12 19:50:14,420 - INFO - Después de joins: 208 registros
2025-11-12 19:50:14,420 - INFO - NaN en situacion: 2
2025-11-12 19:50:14,420 - INFO - NaN en cobranza: 1
2025-11-12 19:50:14,421 - INFO - NaN en ahorros: 3
2025-11-12 19:50:14,422 - INFO - Parche aplicado: 1 correcciones
2025-11-12 19:50:14,424 - INFO - Estatus calculados: {'Vigente': 206, '': 2}
2025-11-12 19:50:14,437 - INFO - Cartera generada exitosamente: 208 filas x 36 columnas
2025-11-12 19:51:30,369 - INFO - Cargando ANTIGÜEDAD desde: data\ReportedeAntiguedaddeCarteraGrupal_12112025.xlsx
2025-11-12 19:51:30,399 - INFO - Hoja detectada: '121125'
2025-11-12 19:51:30,588 - INFO - ANTIGÜEDAD cargado: (206, 59)
2025-11-12 19:51:30,588 - INFO - Columnas: ['cod_region', 'coordinacion', 'nombre_de_gerente', 'codigo_promotor', 'nombre_promotor', 'codigo_recuperador', 'nombre_recuperador', 'cod_grupo_solidario', 'ciclo', 'grupo_solidario']...
2025-11-12 19:51:30,588 - INFO - No se encontraron IDs duplicados
2025-11-12 19:52:31,560 - INFO - Cargando ANTIGÜEDAD desde: data\ReportedeAntiguedaddeCarteraGrupal_12112025.xlsx
2025-11-12 19:52:31,599 - INFO - Hoja detectada: '121125'
2025-11-12 19:52:31,822 - INFO - ANTIGÜEDAD cargado: (206, 59)
2025-11-12 19:52:31,822 - INFO - Columnas: ['cod_region', 'coordinacion', 'nombre_de_gerente', 'codigo_promotor', 'nombre_promotor', 'codigo_recuperador', 'nombre_recuperador', 'cod_grupo_solidario', 'ciclo', 'grupo_solidario']...
2025-11-12 19:52:31,823 - INFO - No se encontraron IDs duplicados
2025-11-12 19:52:31,823 - INFO - Cargando SITUACIÓN DE CARTERA desde: data\Situación_de_cartera_12112025.xlsx
2025-11-12 19:52:32,022 - INFO - SITUACIÓN DE CARTERA cargada: (206, 43)
2025-11-12 19:52:32,022 - INFO - Columnas: ['codigo_ofic_cred', 'nombre_oficial_de_credito', 'codigo_promotor_cred', 'nombre_promotor_cred', 'codigo_coord', 'nombre_coordinacion', 'codigo_ger_regi', 'nombre_gerencia_regional', 'nombre_codigo', 'nombre_acreditado_cliente']...
2025-11-12 19:52:32,023 - INFO - Columna de código renombrada: nombre_codigo -> codigo
2025-11-12 19:52:32,024 - INFO - Cargando REPORTE DE COBRANZA desde: data\Cobranza_12112025.xlsx
2025-11-12 19:52:32,310 - INFO - REPORTE DE COBRANZA cargado: (207, 68)
2025-11-12 19:52:32,310 - INFO - Columnas: ['regional', 'regional1', 'coordinacion', 'coordinacion1', 'de_credito', 'de_credito1', 'gpo', 'cliente_grupo', 'unnamed:_8', 'del_cliente']...
2025-11-13 14:45:41,949 - INFO - ================================================================================
2025-11-13 14:45:41,950 - INFO - INICIO DE AUTOMATIZACIÓN DE CARTERA
2025-11-13 14:45:41,950 - INFO - ================================================================================
2025-11-13 14:45:41,950 - INFO - 
--- PASO 0: BÚSQUEDA DE ARCHIVOS ---
2025-11-13 14:45:41,950 - INFO - Archivo encontrado: data\ReportedeAntiguedaddeCarteraGrupal_12112025.xlsx
2025-11-13 14:45:41,951 - INFO - Archivo encontrado: data\Situación_de_cartera_12112025.xlsx
2025-11-13 14:45:41,951 - INFO - Archivo encontrado: data\Cobranza_12112025.xlsx
2025-11-13 14:45:41,952 - INFO - Archivo encontrado: data/AHORROS.xlsx
2025-11-13 14:45:41,952 - INFO - 
--- PASO 1: CARGA DE ARCHIVOS ---
2025-11-13 14:45:41,952 - INFO - Cargando ANTIGÜEDAD desde: data\ReportedeAntiguedaddeCarteraGrupal_12112025.xlsx
2025-11-13 14:45:41,973 - INFO - Hoja detectada: '121125'
2025-11-13 14:45:42,116 - INFO - ANTIGÜEDAD cargado: (206, 59)
2025-11-13 14:45:42,117 - INFO - Columnas: ['cod_region', 'coordinacion', 'nombre_de_gerente', 'codigo_promotor', 'nombre_promotor', 'codigo_recuperador', 'nombre_recuperador', 'cod_grupo_solidario', 'ciclo', 'grupo_solidario']...
2025-11-13 14:45:42,118 - INFO - No se encontraron IDs duplicados
2025-11-13 14:45:42,118 - INFO - Cargando SITUACIÓN DE CARTERA desde: data\Situación_de_cartera_12112025.xlsx
2025-11-13 14:45:42,239 - INFO - SITUACIÓN DE CARTERA cargada: (206, 43)
2025-11-13 14:45:42,239 - INFO - Columnas: ['codigo_ofic_cred', 'nombre_oficial_de_credito', 'codigo_promotor_cred', 'nombre_promotor_cred', 'codigo_coord', 'nombre_coordinacion', 'codigo_ger_regi', 'nombre_gerencia_regional', 'nombre_codigo', 'nombre_acreditado_cliente']...
2025-11-13 14:45:42,240 - INFO - Columna de código renombrada: nombre_codigo -> codigo
2025-11-13 14:45:42,241 - INFO - Cargando REPORTE DE COBRANZA desde: data\Cobranza_12112025.xlsx
2025-11-13 14:45:42,420 - INFO - REPORTE DE COBRANZA cargado: (207, 68)
2025-11-13 14:45:42,421 - INFO - Columnas: ['regional', 'regional1', 'coordinacion', 'coordinacion1', 'de_credito', 'de_credito1', 'gpo', 'cliente_grupo', 'unnamed:_8', 'del_cliente']...
2025-11-13 14:45:42,421 - INFO - Cargando AHORROS (ACUMULADO) desde: data/AHORROS.xlsx
2025-11-13 14:45:42,460 - INFO - AHORROS cargado: (208, 4)
2025-11-13 14:45:42,460 - INFO - Columnas: ['id', 'grupo', 'ciclo', 'ahorro_acumulado']
2025-11-13 14:45:42,461 - INFO - PARCHE PROMOTORES cargado: 1 correcciones
2025-11-13 14:45:42,461 - INFO - 
--- PASO 2: GENERACIÓN DE CARTERA ---
2025-11-13 14:45:42,461 - INFO - Iniciando generación de cartera (VERSIÓN CORREGIDA)...
2025-11-13 14:45:42,461 - INFO - Registros en antiguedad: 206
2025-11-13 14:45:42,464 - INFO - ID de grupo generados: 0    000089
1    000145
2    000069
3    000079
4    000104
Name: id_de_grupo, dtype: object
2025-11-13 14:45:42,483 - INFO - Después de joins: 208 registros
2025-11-13 14:45:42,484 - INFO - NaN en situacion: 2
2025-11-13 14:45:42,484 - INFO - NaN en cobranza: 1
2025-11-13 14:45:42,484 - INFO - NaN en ahorros: 3
2025-11-13 14:45:42,486 - INFO - Parche aplicado: 1 correcciones
2025-11-13 14:45:42,489 - INFO - Estatus calculados: {'Vigente': 206, '': 2}
2025-11-13 14:45:42,508 - INFO - Cartera generada exitosamente: 208 filas x 36 columnas
2025-11-13 14:45:42,508 - INFO - 
--- PASO 3: GUARDADO DE RESULTADO CON FORMATO ---
2025-11-13 14:45:42,508 - INFO - ================================================================================
2025-11-13 14:45:42,508 - INFO - GUARDANDO DATAFRAME CON FORMATO
2025-11-13 14:45:42,508 - INFO - ================================================================================
2025-11-13 14:45:42,508 - INFO - 
1. Cargando plantilla de headers: plantilla/CARTERA_HEADERS.xlsx
2025-11-13 14:45:42,517 - INFO - Plantilla cargada: 6 filas x 36 columnas (6.1 KB)
2025-11-13 14:45:42,517 - INFO - 
2. Creando nuevo workbook...
2025-11-13 14:45:42,519 - INFO - 
3. Copiando headers desde plantilla...
2025-11-13 14:45:42,519 - INFO - Copiando headers (filas 1-6) con formato...
2025-11-13 14:45:42,556 - INFO - Headers copiados: 36 columnas
2025-11-13 14:45:42,556 - INFO - 
4. Pegando datos del DataFrame...
2025-11-13 14:45:42,556 - INFO - Pegando DataFrame (208 filas x 36 columnas) desde fila 7...
2025-11-13 14:45:42,596 - INFO - Datos pegados hasta fila 214
2025-11-13 14:45:42,597 - INFO - 
5. Formato de datos: Se aplicará automáticamente por la tabla Excel
2025-11-13 14:45:42,597 - INFO - 
6. Creando tabla de Excel con totales...
2025-11-13 14:45:42,597 - INFO - Creando tabla Excel 'TablaCartera' desde fila 6 hasta 214...
2025-11-13 14:45:42,597 - INFO - Rango de tabla: A6:AJ215
2025-11-13 14:45:42,597 - INFO - Fila de totales: 215
2025-11-13 14:45:42,597 - INFO - Nombres de columnas extraídos: 36
2025-11-13 14:45:42,597 - INFO -   Columna 6 'Monto del crédito': SUM
2025-11-13 14:45:42,597 - INFO -   Columna 13 'Pago Semanal': SUM
2025-11-13 14:45:42,597 - INFO -   Columna 15 'Cartera vigente sistema': SUM
2025-11-13 14:45:42,597 - INFO -   Columna 16 'Carera vigente inicial': SUM
2025-11-13 14:45:42,597 - INFO -   Columna 17 'Cartera vigente calculada': SUM
2025-11-13 14:45:42,598 - INFO -   Columna 18 'Cartera Insoluta': SUM
2025-11-13 14:45:42,598 - INFO -   Columna 19 'Diferencia Validación vigente': SUM
2025-11-13 14:45:42,598 - INFO -   Columna 20 'Ahorro Consumido': SUM
2025-11-13 14:45:42,598 - INFO -   Columna 21 'Cartera Vencida Estadistica': SUM
2025-11-13 14:45:42,598 - INFO -   Columna 22 'Cartera vencida Total': SUM
2025-11-13 14:45:42,598 - INFO -   Columna 24 'Saldo en riesgo': SUM
2025-11-13 14:45:42,598 - INFO -   Columna 25 'Saldo 
ahorro 
acumulado': SUM
2025-11-13 14:45:42,598 - INFO -   Columna 26 'Monto promedio del grupo': SUM
2025-11-13 14:45:42,598 - INFO -   Columna 33 'Ahorro Acumulado': SUM
2025-11-13 14:45:42,598 - INFO - Escribiendo fórmulas en fila de totales...
2025-11-13 14:45:42,599 - INFO -   Fórmula en columna 6: =SUBTOTAL(109,F7:F214)
2025-11-13 14:45:42,599 - INFO -   Fórmula en columna 13: =SUBTOTAL(109,M7:M214)
2025-11-13 14:45:42,599 - INFO -   Fórmula en columna 15: =SUBTOTAL(109,O7:O214)
2025-11-13 14:45:42,599 - INFO -   Fórmula en columna 16: =SUBTOTAL(109,P7:P214)
2025-11-13 14:45:42,599 - INFO -   Fórmula en columna 17: =SUBTOTAL(109,Q7:Q214)
2025-11-13 14:45:42,599 - INFO -   Fórmula en columna 18: =SUBTOTAL(109,R7:R214)
2025-11-13 14:45:42,599 - INFO -   Fórmula en columna 19: =SUBTOTAL(109,S7:S214)
2025-11-13 14:45:42,599 - INFO -   Fórmula en columna 20: =SUBTOTAL(109,T7:T214)
2025-11-13 14:45:42,599 - INFO -   Fórmula en columna 21: =SUBTOTAL(109,U7:U214)
2025-11-13 14:45:42,599 - INFO -   Fórmula en columna 22: =SUBTOTAL(109,V7:V214)
2025-11-13 14:45:42,599 - INFO -   Fórmula en columna 24: =SUBTOTAL(109,X7:X214)
2025-11-13 14:45:42,599 - INFO -   Fórmula en columna 25: =SUBTOTAL(109,Y7:Y214)
2025-11-13 14:45:42,599 - INFO -   Fórmula en columna 26: =SUBTOTAL(109,Z7:Z214)
2025-11-13 14:45:42,599 - INFO -   Fórmula en columna 33: =SUBTOTAL(109,AG7:AG214)
2025-11-13 14:45:42,599 - INFO - Tabla creada exitosamente con 208 filas de datos + fila totales
2025-11-13 14:45:42,599 - INFO - Totales configurados en 14 columnas con fórmulas SUBTOTAL
2025-11-13 14:45:42,600 - INFO - Fila de totales: Formato aplicado automáticamente por la tabla
2025-11-13 14:45:42,600 - INFO - 
7. Guardando archivo: output_automatizado.xlsx
2025-11-13 14:45:42,723 - INFO - 
================================================================================
2025-11-13 14:45:42,723 - INFO - ARCHIVO GUARDADO EXITOSAMENTE
2025-11-13 14:45:42,723 - INFO - ================================================================================
2025-11-13 14:45:42,723 - INFO - 
Archivo: output_automatizado.xlsx
2025-11-13 14:45:42,724 - INFO - Filas de datos: 208
2025-11-13 14:45:42,724 - INFO - Columnas: 36
2025-11-13 14:45:42,724 - INFO - Formato: Idéntico al machote
2025-11-13 14:45:42,724 - INFO - Tabla Excel: Con totales automáticos
2025-11-13 14:45:42,724 - INFO - ================================================================================
2025-11-13 14:45:42,724 - INFO - OK - Archivo guardado con formato: output_automatizado.xlsx
2025-11-13 14:45:42,724 - INFO - 
--- PASO 4: GENERACIÓN DE HOJA MORA ---
2025-11-13 14:45:42,724 - INFO - 
Iniciando generación de hoja MORA...
2025-11-13 14:45:42,725 - INFO - Registros con %mora > 5%: 7 de 208
2025-11-13 14:45:42,727 - INFO - Hoja MORA generada con 7 registros y 14 columnas
2025-11-13 14:45:42,727 - INFO - 
================================================================================
2025-11-13 14:45:42,727 - INFO - AGREGANDO HOJA MORA
2025-11-13 14:45:42,728 - INFO - ================================================================================
2025-11-13 14:45:42,728 - INFO - 
1. Abriendo archivo: output_automatizado.xlsx
2025-11-13 14:45:42,889 - INFO - 
2. Creando hoja 'Mora'
2025-11-13 14:45:42,890 - INFO - 
3. Copiando formato de headers desde plantilla
2025-11-13 14:45:42,911 - INFO - 
4. Estableciendo headers de MORA
2025-11-13 14:45:42,911 - INFO - 
5. Pegando 7 filas de datos
2025-11-13 14:45:42,914 - INFO - 
6. Creando tabla Excel con totales
2025-11-13 14:45:42,914 - INFO -    Creando tabla: A6:N14
2025-11-13 14:45:42,914 - INFO -    Tabla 'TablaMora' creada con totales automáticos
2025-11-13 14:45:42,915 - INFO -    Fórmulas SUBTOTAL escritas en 6 columnas
2025-11-13 14:45:42,915 - INFO - 
7. Guardando archivo con hoja MORA
2025-11-13 14:45:43,053 - INFO - 
================================================================================
2025-11-13 14:45:43,053 - INFO - HOJA MORA AGREGADA EXITOSAMENTE
2025-11-13 14:45:43,054 - INFO - ================================================================================
2025-11-13 14:45:43,054 - INFO - 
Registros en MORA: 7
2025-11-13 14:45:43,054 - INFO - Filtro: %mora > 5%
2025-11-13 14:45:43,054 - INFO - Columnas amarillas: %mora, Días de mora
2025-11-13 14:45:43,054 - INFO - ================================================================================
2025-11-13 14:45:43,054 - INFO - OK - Hoja MORA agregada con 7 registros
2025-11-13 14:45:43,055 - INFO - 
--- PASO 5: VALIDACIÓN ---
2025-11-13 14:45:43,055 - INFO - Machote no encontrado - validación omitida (no es necesario)
2025-11-13 14:45:43,055 - INFO - 
================================================================================
2025-11-13 14:45:43,055 - INFO - AUTOMATIZACIÓN COMPLETADA EXITOSAMENTE
2025-11-13 14:45:43,055 - INFO - ================================================================================
2025-11-13 14:46:44,045 - INFO - Cargando ANTIGÜEDAD desde: data\ReportedeAntiguedaddeCarteraGrupal_12112025.xlsx
2025-11-13 14:46:44,064 - INFO - Hoja detectada: '121125'
2025-11-13 14:46:44,210 - INFO - ANTIGÜEDAD cargado: (206, 59)
2025-11-13 14:46:44,210 - INFO - Columnas: ['cod_region', 'coordinacion', 'nombre_de_gerente', 'codigo_promotor', 'nombre_promotor', 'codigo_recuperador', 'nombre_recuperador', 'cod_grupo_solidario', 'ciclo', 'grupo_solidario']...
2025-11-13 14:46:44,211 - INFO - No se encontraron IDs duplicados
2025-11-13 14:46:44,211 - INFO - Cargando SITUACIÓN DE CARTERA desde: data\Situación_de_cartera_12112025.xlsx
2025-11-13 14:46:44,328 - INFO - SITUACIÓN DE CARTERA cargada: (206, 43)
2025-11-13 14:46:44,328 - INFO - Columnas: ['codigo_ofic_cred', 'nombre_oficial_de_credito', 'codigo_promotor_cred', 'nombre_promotor_cred', 'codigo_coord', 'nombre_coordinacion', 'codigo_ger_regi', 'nombre_gerencia_regional', 'nombre_codigo', 'nombre_acreditado_cliente']...
2025-11-13 14:46:44,328 - INFO - Columna de código renombrada: nombre_codigo -> codigo
2025-11-13 14:46:44,330 - INFO - Cargando REPORTE DE COBRANZA desde: data\Cobranza_12112025.xlsx
2025-11-13 14:46:44,573 - INFO - REPORTE DE COBRANZA cargado: (207, 68)
2025-11-13 14:46:44,574 - INFO - Columnas: ['regional', 'regional1', 'coordinacion', 'coordinacion1', 'de_credito', 'de_credito1', 'gpo', 'cliente_grupo', 'unnamed:_8', 'del_cliente']...
2025-11-13 14:46:44,574 - INFO - Cargando AHORROS (ACUMULADO) desde: data/AHORROS.xlsx
2025-11-13 14:46:44,626 - INFO - AHORROS cargado: (208, 4)
2025-11-13 14:46:44,626 - INFO - Columnas: ['id', 'grupo', 'ciclo', 'ahorro_acumulado']
2025-11-13 14:46:44,627 - INFO - Iniciando generación de cartera (VERSIÓN CORREGIDA)...
2025-11-13 14:46:44,627 - INFO - Registros en antiguedad: 206
2025-11-13 14:46:44,631 - INFO - ID de grupo generados: 0    000089
1    000145
2    000069
3    000079
4    000104
Name: id_de_grupo, dtype: object
2025-11-13 14:46:44,651 - INFO - Después de joins: 208 registros
2025-11-13 14:46:44,651 - INFO - NaN en situacion: 2
2025-11-13 14:46:44,652 - INFO - NaN en cobranza: 1
2025-11-13 14:46:44,652 - INFO - NaN en ahorros: 3
2025-11-13 14:46:44,654 - INFO - Parche aplicado: 1 correcciones
2025-11-13 14:46:44,656 - INFO - Estatus calculados: {'Vigente': 206, '': 2}
2025-11-13 14:46:44,679 - INFO - Cartera generada exitosamente: 208 filas x 36 columnas
2025-11-13 14:47:17,587 - INFO - Cargando ANTIGÜEDAD desde: data\ReportedeAntiguedaddeCarteraGrupal_12112025.xlsx
2025-11-13 14:47:17,610 - INFO - Hoja detectada: '121125'
2025-11-13 14:47:17,824 - INFO - ANTIGÜEDAD cargado: (206, 59)
2025-11-13 14:47:17,824 - INFO - Columnas: ['cod_region', 'coordinacion', 'nombre_de_gerente', 'codigo_promotor', 'nombre_promotor', 'codigo_recuperador', 'nombre_recuperador', 'cod_grupo_solidario', 'ciclo', 'grupo_solidario']...
2025-11-13 14:47:17,825 - INFO - No se encontraron IDs duplicados
2025-11-13 14:47:17,826 - INFO - Cargando SITUACIÓN DE CARTERA desde: data\Situación_de_cartera_12112025.xlsx
2025-11-13 14:47:18,019 - INFO - SITUACIÓN DE CARTERA cargada: (206, 43)
2025-11-13 14:47:18,019 - INFO - Columnas: ['codigo_ofic_cred', 'nombre_oficial_de_credito', 'codigo_promotor_cred', 'nombre_promotor_cred', 'codigo_coord', 'nombre_coordinacion', 'codigo_ger_regi', 'nombre_gerencia_regional', 'nombre_codigo', 'nombre_acreditado_cliente']...
2025-11-13 14:47:18,020 - INFO - Columna de código renombrada: nombre_codigo -> codigo
2025-11-13 14:47:18,023 - INFO - Cargando REPORTE DE COBRANZA desde: data\Cobranza_12112025.xlsx
2025-11-13 14:47:18,288 - INFO - REPORTE DE COBRANZA cargado: (207, 68)
2025-11-13 14:47:18,289 - INFO - Columnas: ['regional', 'regional1', 'coordinacion', 'coordinacion1', 'de_credito', 'de_credito1', 'gpo', 'cliente_grupo', 'unnamed:_8', 'del_cliente']...
2025-11-13 14:47:18,289 - INFO - Cargando AHORROS (ACUMULADO) desde: data/AHORROS.xlsx
2025-11-13 14:47:18,339 - INFO - AHORROS cargado: (208, 4)
2025-11-13 14:47:18,339 - INFO - Columnas: ['id', 'grupo', 'ciclo', 'ahorro_acumulado']
2025-11-13 14:47:18,340 - INFO - Iniciando generación de cartera (VERSIÓN CORREGIDA)...
2025-11-13 14:47:18,340 - INFO - Registros en antiguedad: 206
2025-11-13 14:47:18,342 - INFO - ID de grupo generados: 0    000089
1    000145
2    000069
3    000079
4    000104
Name: id_de_grupo, dtype: object
2025-11-13 14:47:18,362 - INFO - Después de joins: 208 registros
2025-11-13 14:47:18,363 - INFO - NaN en situacion: 2
2025-11-13 14:47:18,364 - INFO - NaN en cobranza: 1
2025-11-13 14:47:18,364 - INFO - NaN en ahorros: 3
2025-11-13 14:47:18,367 - INFO - Parche aplicado: 1 correcciones
2025-11-13 14:47:18,369 - INFO - Estatus calculados: {'Vigente': 206, '': 2}
2025-11-13 14:47:18,388 - INFO - Cartera generada exitosamente: 208 filas x 36 columnas
2025-11-13 14:48:01,004 - INFO - Cargando ANTIGÜEDAD desde: data\ReportedeAntiguedaddeCarteraGrupal_12112025.xlsx
2025-11-13 14:48:01,036 - INFO - Hoja detectada: '121125'
2025-11-13 14:48:01,247 - INFO - ANTIGÜEDAD cargado: (206, 59)
2025-11-13 14:48:01,248 - INFO - Columnas: ['cod_region', 'coordinacion', 'nombre_de_gerente', 'codigo_promotor', 'nombre_promotor', 'codigo_recuperador', 'nombre_recuperador', 'cod_grupo_solidario', 'ciclo', 'grupo_solidario']...
2025-11-13 14:48:01,252 - INFO - No se encontraron IDs duplicados
2025-11-13 14:48:01,252 - INFO - Cargando SITUACIÓN DE CARTERA desde: data\Situación_de_cartera_12112025.xlsx
2025-11-13 14:48:01,405 - INFO - SITUACIÓN DE CARTERA cargada: (206, 43)
2025-11-13 14:48:01,405 - INFO - Columnas: ['codigo_ofic_cred', 'nombre_oficial_de_credito', 'codigo_promotor_cred', 'nombre_promotor_cred', 'codigo_coord', 'nombre_coordinacion', 'codigo_ger_regi', 'nombre_gerencia_regional', 'nombre_codigo', 'nombre_acreditado_cliente']...
2025-11-13 14:48:01,407 - INFO - Columna de código renombrada: nombre_codigo -> codigo
2025-11-13 14:48:01,409 - INFO - Cargando REPORTE DE COBRANZA desde: data\Cobranza_12112025.xlsx
2025-11-13 14:48:01,640 - INFO - REPORTE DE COBRANZA cargado: (207, 68)
2025-11-13 14:48:01,641 - INFO - Columnas: ['regional', 'regional1', 'coordinacion', 'coordinacion1', 'de_credito', 'de_credito1', 'gpo', 'cliente_grupo', 'unnamed:_8', 'del_cliente']...
2025-11-13 14:48:01,642 - INFO - Cargando AHORROS (ACUMULADO) desde: data/AHORROS.xlsx
2025-11-13 14:48:01,688 - INFO - AHORROS cargado: (208, 4)
2025-11-13 14:48:01,688 - INFO - Columnas: ['id', 'grupo', 'ciclo', 'ahorro_acumulado']
2025-11-13 14:48:01,688 - INFO - Iniciando generación de cartera (VERSIÓN CORREGIDA)...
2025-11-13 14:48:01,688 - INFO - Registros en antiguedad: 206
2025-11-13 14:48:01,690 - INFO - ID de grupo generados: 0    000089
1    000145
2    000069
3    000079
4    000104
Name: id_de_grupo, dtype: object
2025-11-13 14:48:01,711 - INFO - Después de joins: 208 registros
2025-11-13 14:48:01,711 - INFO - NaN en situacion: 2
2025-11-13 14:48:01,712 - INFO - NaN en cobranza: 1
2025-11-13 14:48:01,712 - INFO - NaN en ahorros: 3
2025-11-13 14:48:01,713 - INFO - Parche aplicado: 1 correcciones
2025-11-13 14:48:01,716 - INFO - Estatus calculados: {'Vigente': 206, '': 2}
2025-11-13 14:48:01,742 - INFO - Cartera generada exitosamente: 208 filas x 36 columnas
2025-11-13 14:48:18,165 - INFO - Cargando ANTIGÜEDAD desde: data\ReportedeAntiguedaddeCarteraGrupal_12112025.xlsx
2025-11-13 14:48:18,186 - INFO - Hoja detectada: '121125'
2025-11-13 14:48:18,357 - INFO - ANTIGÜEDAD cargado: (206, 59)
2025-11-13 14:48:18,357 - INFO - Columnas: ['cod_region', 'coordinacion', 'nombre_de_gerente', 'codigo_promotor', 'nombre_promotor', 'codigo_recuperador', 'nombre_recuperador', 'cod_grupo_solidario', 'ciclo', 'grupo_solidario']...
2025-11-13 14:48:18,358 - INFO - No se encontraron IDs duplicados
2025-11-13 14:48:18,359 - INFO - Cargando SITUACIÓN DE CARTERA desde: data\Situación_de_cartera_12112025.xlsx
2025-11-13 14:48:18,493 - INFO - SITUACIÓN DE CARTERA cargada: (206, 43)
2025-11-13 14:48:18,494 - INFO - Columnas: ['codigo_ofic_cred', 'nombre_oficial_de_credito', 'codigo_promotor_cred', 'nombre_promotor_cred', 'codigo_coord', 'nombre_coordinacion', 'codigo_ger_regi', 'nombre_gerencia_regional', 'nombre_codigo', 'nombre_acreditado_cliente']...
2025-11-13 14:48:18,494 - INFO - Columna de código renombrada: nombre_codigo -> codigo
2025-11-13 14:48:18,496 - INFO - Cargando REPORTE DE COBRANZA desde: data\Cobranza_12112025.xlsx
2025-11-13 14:48:18,707 - INFO - REPORTE DE COBRANZA cargado: (207, 68)
2025-11-13 14:48:18,707 - INFO - Columnas: ['regional', 'regional1', 'coordinacion', 'coordinacion1', 'de_credito', 'de_credito1', 'gpo', 'cliente_grupo', 'unnamed:_8', 'del_cliente']...
2025-11-13 14:48:18,708 - INFO - Cargando AHORROS (ACUMULADO) desde: data/AHORROS.xlsx
2025-11-13 14:48:18,752 - INFO - AHORROS cargado: (208, 4)
2025-11-13 14:48:18,752 - INFO - Columnas: ['id', 'grupo', 'ciclo', 'ahorro_acumulado']
2025-11-13 14:48:18,753 - INFO - Iniciando generación de cartera (VERSIÓN CORREGIDA)...
2025-11-13 14:48:18,753 - INFO - Registros en antiguedad: 206
2025-11-13 14:48:18,756 - INFO - ID de grupo generados: 0    000089
1    000145
2    000069
3    000079
4    000104
Name: id_de_grupo, dtype: object
2025-11-13 14:48:18,771 - INFO - Después de joins: 208 registros
2025-11-13 14:48:18,772 - INFO - NaN en situacion: 2
2025-11-13 14:48:18,773 - INFO - NaN en cobranza: 1
2025-11-13 14:48:18,773 - INFO - NaN en ahorros: 3
2025-11-13 14:48:18,775 - INFO - Parche aplicado: 1 correcciones
2025-11-13 14:48:18,778 - INFO - Estatus calculados: {'Vigente': 206, '': 2}
2025-11-13 14:48:18,792 - INFO - Cartera generada exitosamente: 208 filas x 36 columnas
2025-11-13 14:48:59,415 - INFO - Cargando ANTIGÜEDAD desde: data\ReportedeAntiguedaddeCarteraGrupal_12112025.xlsx
2025-11-13 14:48:59,436 - INFO - Hoja detectada: '121125'
2025-11-13 14:48:59,590 - INFO - ANTIGÜEDAD cargado: (206, 59)
2025-11-13 14:48:59,591 - INFO - Columnas: ['cod_region', 'coordinacion', 'nombre_de_gerente', 'codigo_promotor', 'nombre_promotor', 'codigo_recuperador', 'nombre_recuperador', 'cod_grupo_solidario', 'ciclo', 'grupo_solidario']...
2025-11-13 14:48:59,591 - INFO - No se encontraron IDs duplicados
2025-11-13 14:48:59,592 - INFO - Cargando SITUACIÓN DE CARTERA desde: data\Situación_de_cartera_12112025.xlsx
2025-11-13 14:48:59,707 - INFO - SITUACIÓN DE CARTERA cargada: (206, 43)
2025-11-13 14:48:59,707 - INFO - Columnas: ['codigo_ofic_cred', 'nombre_oficial_de_credito', 'codigo_promotor_cred', 'nombre_promotor_cred', 'codigo_coord', 'nombre_coordinacion', 'codigo_ger_regi', 'nombre_gerencia_regional', 'nombre_codigo', 'nombre_acreditado_cliente']...
2025-11-13 14:48:59,707 - INFO - Columna de código renombrada: nombre_codigo -> codigo
2025-11-13 14:48:59,709 - INFO - Cargando REPORTE DE COBRANZA desde: data\Cobranza_12112025.xlsx
2025-11-13 14:48:59,894 - INFO - REPORTE DE COBRANZA cargado: (207, 68)
2025-11-13 14:48:59,894 - INFO - Columnas: ['regional', 'regional1', 'coordinacion', 'coordinacion1', 'de_credito', 'de_credito1', 'gpo', 'cliente_grupo', 'unnamed:_8', 'del_cliente']...
2025-11-13 14:48:59,894 - INFO - Cargando AHORROS (ACUMULADO) desde: data/AHORROS.xlsx
2025-11-13 14:48:59,935 - INFO - AHORROS cargado: (208, 4)
2025-11-13 14:48:59,935 - INFO - Columnas: ['id', 'grupo', 'ciclo', 'ahorro_acumulado']
2025-11-13 14:48:59,935 - INFO - Iniciando generación de cartera (VERSIÓN CORREGIDA)...
2025-11-13 14:48:59,935 - INFO - Registros en antiguedad: 206
2025-11-13 14:48:59,937 - INFO - ID de grupo generados: 0    000089
1    000145
2    000069
3    000079
4    000104
Name: id_de_grupo, dtype: object
2025-11-13 14:48:59,951 - INFO - Después de joins: 208 registros
2025-11-13 14:48:59,952 - INFO - NaN en situacion: 2
2025-11-13 14:48:59,952 - INFO - NaN en cobranza: 1
2025-11-13 14:48:59,952 - INFO - NaN en ahorros: 3
2025-11-13 14:48:59,954 - INFO - Parche aplicado: 1 correcciones
2025-11-13 14:48:59,956 - INFO - Estatus calculados: {'Vigente': 206, '': 2}
2025-11-13 14:48:59,972 - INFO - Cartera generada exitosamente: 208 filas x 36 columnas
2025-11-13 14:54:04,014 - INFO - Cargando ANTIGÜEDAD desde: data\ReportedeAntiguedaddeCarteraGrupal_12112025.xlsx
2025-11-13 14:54:04,033 - INFO - Hoja detectada: '121125'
2025-11-13 14:54:04,174 - INFO - ANTIGÜEDAD cargado: (206, 59)
2025-11-13 14:54:04,174 - INFO - Columnas: ['cod_region', 'coordinacion', 'nombre_de_gerente', 'codigo_promotor', 'nombre_promotor', 'codigo_recuperador', 'nombre_recuperador', 'cod_grupo_solidario', 'ciclo', 'grupo_solidario']...
2025-11-13 14:54:04,175 - INFO - No se encontraron IDs duplicados
2025-11-13 14:54:52,190 - INFO - ================================================================================
2025-11-13 14:54:52,191 - INFO - INICIO DE AUTOMATIZACIÓN DE CARTERA
2025-11-13 14:54:52,191 - INFO - ================================================================================
2025-11-13 14:54:52,191 - INFO - 
--- PASO 0: BÚSQUEDA DE ARCHIVOS ---
2025-11-13 14:54:52,191 - INFO - Archivo encontrado: data\ReportedeAntiguedaddeCarteraGrupal_12112025.xlsx
2025-11-13 14:54:52,192 - INFO - Archivo encontrado: data\Situación_de_cartera_12112025.xlsx
2025-11-13 14:54:52,192 - INFO - Archivo encontrado: data\Cobranza_12112025.xlsx
2025-11-13 14:54:52,193 - INFO - Archivo encontrado: data/AHORROS.xlsx
2025-11-13 14:54:52,193 - INFO - 
--- PASO 1: CARGA DE ARCHIVOS ---
2025-11-13 14:54:52,193 - INFO - Cargando ANTIGÜEDAD desde: data\ReportedeAntiguedaddeCarteraGrupal_12112025.xlsx
2025-11-13 14:54:52,212 - INFO - Hoja detectada: '121125'
2025-11-13 14:54:52,357 - INFO - ANTIGÜEDAD cargado: (206, 59)
2025-11-13 14:54:52,357 - INFO - Columnas: ['cod_region', 'coordinacion', 'nombre_de_gerente', 'codigo_promotor', 'nombre_promotor', 'codigo_recuperador', 'nombre_recuperador', 'cod_grupo_solidario', 'ciclo', 'grupo_solidario']...
2025-11-13 14:54:52,357 - INFO - No se encontraron IDs duplicados
2025-11-13 14:54:52,358 - INFO - Cargando SITUACIÓN DE CARTERA desde: data\Situación_de_cartera_12112025.xlsx
2025-11-13 14:54:52,528 - INFO - SITUACIÓN DE CARTERA cargada: (206, 43)
2025-11-13 14:54:52,528 - INFO - Columnas: ['codigo_ofic_cred', 'nombre_oficial_de_credito', 'codigo_promotor_cred', 'nombre_promotor_cred', 'codigo_coord', 'nombre_coordinacion', 'codigo_ger_regi', 'nombre_gerencia_regional', 'nombre_codigo', 'nombre_acreditado_cliente']...
2025-11-13 14:54:52,529 - INFO - Columna de código renombrada: nombre_codigo -> codigo
2025-11-13 14:54:52,530 - INFO - Cargando REPORTE DE COBRANZA desde: data\Cobranza_12112025.xlsx
2025-11-13 14:54:52,746 - INFO - REPORTE DE COBRANZA cargado: (207, 68)
2025-11-13 14:54:52,747 - INFO - Columnas: ['regional', 'regional1', 'coordinacion', 'coordinacion1', 'de_credito', 'de_credito1', 'gpo', 'cliente_grupo', 'unnamed:_8', 'del_cliente']...
2025-11-13 14:54:52,748 - INFO - Cargando AHORROS (ACUMULADO) desde: data/AHORROS.xlsx
2025-11-13 14:54:52,793 - INFO - AHORROS cargado: (208, 4)
2025-11-13 14:54:52,793 - INFO - Columnas: ['id', 'grupo', 'ciclo', 'ahorro_acumulado']
2025-11-13 14:54:52,793 - INFO - PARCHE PROMOTORES cargado: 1 correcciones
2025-11-13 14:54:52,793 - INFO - 
--- PASO 2: GENERACIÓN DE CARTERA ---
2025-11-13 14:54:52,794 - INFO - Iniciando generación de cartera (VERSIÓN CORREGIDA)...
2025-11-13 14:54:52,794 - INFO - Registros en antiguedad: 206
2025-11-13 14:54:52,795 - INFO - ID de grupo generados: 0    000089
1    000145
2    000069
3    000079
4    000104
Name: id_de_grupo, dtype: object
2025-11-13 14:54:52,812 - INFO - Después de joins: 208 registros
2025-11-13 14:54:52,813 - INFO - NaN en situacion: 2
2025-11-13 14:54:52,813 - INFO - NaN en cobranza: 1
2025-11-13 14:54:52,814 - INFO - NaN en ahorros: 3
2025-11-13 14:54:52,817 - INFO - Parche aplicado: 1 correcciones
2025-11-13 14:54:52,819 - INFO - Estatus calculados: {'Vigente': 206, '': 2}
2025-11-13 14:54:52,821 - INFO - Cartera vigente sistema calculada como: saldo_total - 9000
2025-11-13 14:54:52,835 - INFO - Cartera generada exitosamente: 208 filas x 36 columnas
2025-11-13 14:54:52,835 - INFO - 
--- PASO 3: GUARDADO DE RESULTADO CON FORMATO ---
2025-11-13 14:54:52,835 - INFO - ================================================================================
2025-11-13 14:54:52,835 - INFO - GUARDANDO DATAFRAME CON FORMATO
2025-11-13 14:54:52,835 - INFO - ================================================================================
2025-11-13 14:54:52,835 - INFO - 
1. Cargando plantilla de headers: plantilla/CARTERA_HEADERS.xlsx
2025-11-13 14:54:52,845 - INFO - Plantilla cargada: 6 filas x 36 columnas (6.1 KB)
2025-11-13 14:54:52,845 - INFO - 
2. Creando nuevo workbook...
2025-11-13 14:54:52,846 - INFO - 
3. Copiando headers desde plantilla...
2025-11-13 14:54:52,846 - INFO - Copiando headers (filas 1-6) con formato...
2025-11-13 14:54:52,886 - INFO - Headers copiados: 36 columnas
2025-11-13 14:54:52,886 - INFO - 
4. Pegando datos del DataFrame...
2025-11-13 14:54:52,886 - INFO - Pegando DataFrame (208 filas x 36 columnas) desde fila 7...
2025-11-13 14:54:52,926 - INFO - Datos pegados hasta fila 214
2025-11-13 14:54:52,926 - INFO - 
5. Formato de datos: Se aplicará automáticamente por la tabla Excel
2025-11-13 14:54:52,926 - INFO - 
6. Creando tabla de Excel con totales...
2025-11-13 14:54:52,926 - INFO - Creando tabla Excel 'TablaCartera' desde fila 6 hasta 214...
2025-11-13 14:54:52,926 - INFO - Rango de tabla: A6:AJ215
2025-11-13 14:54:52,926 - INFO - Fila de totales: 215
2025-11-13 14:54:52,926 - INFO - Nombres de columnas extraídos: 36
2025-11-13 14:54:52,927 - INFO -   Columna 6 'Monto del crédito': SUM
2025-11-13 14:54:52,927 - INFO -   Columna 13 'Pago Semanal': SUM
2025-11-13 14:54:52,927 - INFO -   Columna 15 'Cartera vigente sistema': SUM
2025-11-13 14:54:52,927 - INFO -   Columna 16 'Carera vigente inicial': SUM
2025-11-13 14:54:52,927 - INFO -   Columna 17 'Cartera vigente calculada': SUM
2025-11-13 14:54:52,927 - INFO -   Columna 18 'Cartera Insoluta': SUM
2025-11-13 14:54:52,927 - INFO -   Columna 19 'Diferencia Validación vigente': SUM
2025-11-13 14:54:52,927 - INFO -   Columna 20 'Ahorro Consumido': SUM
2025-11-13 14:54:52,927 - INFO -   Columna 21 'Cartera Vencida Estadistica': SUM
2025-11-13 14:54:52,927 - INFO -   Columna 22 'Cartera vencida Total': SUM
2025-11-13 14:54:52,927 - INFO -   Columna 24 'Saldo en riesgo': SUM
2025-11-13 14:54:52,927 - INFO -   Columna 25 'Saldo 
ahorro 
acumulado': SUM
2025-11-13 14:54:52,928 - INFO -   Columna 26 'Monto promedio del grupo': SUM
2025-11-13 14:54:52,928 - INFO -   Columna 33 'Ahorro Acumulado': SUM
2025-11-13 14:54:52,928 - INFO - Escribiendo fórmulas en fila de totales...
2025-11-13 14:54:52,928 - INFO -   Fórmula en columna 6: =SUBTOTAL(109,F7:F214)
2025-11-13 14:54:52,928 - INFO -   Fórmula en columna 13: =SUBTOTAL(109,M7:M214)
2025-11-13 14:54:52,928 - INFO -   Fórmula en columna 15: =SUBTOTAL(109,O7:O214)
2025-11-13 14:54:52,928 - INFO -   Fórmula en columna 16: =SUBTOTAL(109,P7:P214)
2025-11-13 14:54:52,928 - INFO -   Fórmula en columna 17: =SUBTOTAL(109,Q7:Q214)
2025-11-13 14:54:52,928 - INFO -   Fórmula en columna 18: =SUBTOTAL(109,R7:R214)
2025-11-13 14:54:52,929 - INFO -   Fórmula en columna 19: =SUBTOTAL(109,S7:S214)
2025-11-13 14:54:52,929 - INFO -   Fórmula en columna 20: =SUBTOTAL(109,T7:T214)
2025-11-13 14:54:52,929 - INFO -   Fórmula en columna 21: =SUBTOTAL(109,U7:U214)
2025-11-13 14:54:52,929 - INFO -   Fórmula en columna 22: =SUBTOTAL(109,V7:V214)
2025-11-13 14:54:52,929 - INFO -   Fórmula en columna 24: =SUBTOTAL(109,X7:X214)
2025-11-13 14:54:52,929 - INFO -   Fórmula en columna 25: =SUBTOTAL(109,Y7:Y214)
2025-11-13 14:54:52,929 - INFO -   Fórmula en columna 26: =SUBTOTAL(109,Z7:Z214)
2025-11-13 14:54:52,929 - INFO -   Fórmula en columna 33: =SUBTOTAL(109,AG7:AG214)
2025-11-13 14:54:52,929 - INFO - Tabla creada exitosamente con 208 filas de datos + fila totales
2025-11-13 14:54:52,929 - INFO - Totales configurados en 14 columnas con fórmulas SUBTOTAL
2025-11-13 14:54:52,929 - INFO - Fila de totales: Formato aplicado automáticamente por la tabla
2025-11-13 14:54:52,929 - INFO - 
7. Guardando archivo: output_automatizado.xlsx
2025-11-13 14:54:52,930 - ERROR - 
ERROR: [Errno 13] Permission denied: 'output_automatizado.xlsx'
Traceback (most recent call last):
  File "C:\Users\uzzie\Documents\Jale\merge-dataframes\analizar_y_automatizar.py", line 314, in main
    guardar_con_formato(df_cartera, RUTA_PLANTILLA, RUTA_OUTPUT)
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\uzzie\Documents\Jale\merge-dataframes\formato_excel.py", line 305, in guardar_con_formato
    wb_nuevo.save(ruta_output)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\uzzie\miniconda3\Lib\site-packages\openpyxl\workbook\workbook.py", line 386, in save
    save_workbook(self, filename)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "C:\Users\uzzie\miniconda3\Lib\site-packages\openpyxl\writer\excel.py", line 291, in save_workbook
    archive = ZipFile(filename, 'w', ZIP_DEFLATED, allowZip64=True)
  File "C:\Users\uzzie\miniconda3\Lib\zipfile\__init__.py", line 1367, in __init__
    self.fp = io.open(file, filemode)
              ~~~~~~~^^^^^^^^^^^^^^^^
PermissionError: [Errno 13] Permission denied: 'output_automatizado.xlsx'
2025-11-13 14:57:20,140 - INFO - Cargando ANTIGÜEDAD desde: data\ReportedeAntiguedaddeCarteraGrupal_12112025.xlsx
2025-11-13 14:57:20,159 - INFO - Hoja detectada: '121125'
2025-11-13 14:57:20,370 - INFO - ANTIGÜEDAD cargado: (206, 59)
2025-11-13 14:57:20,371 - INFO - Columnas: ['cod_region', 'coordinacion', 'nombre_de_gerente', 'codigo_promotor', 'nombre_promotor', 'codigo_recuperador', 'nombre_recuperador', 'cod_grupo_solidario', 'ciclo', 'grupo_solidario']...
2025-11-13 14:57:20,372 - INFO - No se encontraron IDs duplicados
2025-11-13 14:57:20,372 - INFO - Cargando SITUACIÓN DE CARTERA desde: data\Situación_de_cartera_12112025.xlsx
2025-11-13 14:57:20,519 - INFO - SITUACIÓN DE CARTERA cargada: (206, 43)
2025-11-13 14:57:20,519 - INFO - Columnas: ['codigo_ofic_cred', 'nombre_oficial_de_credito', 'codigo_promotor_cred', 'nombre_promotor_cred', 'codigo_coord', 'nombre_coordinacion', 'codigo_ger_regi', 'nombre_gerencia_regional', 'nombre_codigo', 'nombre_acreditado_cliente']...
2025-11-13 14:57:20,520 - INFO - Columna de código renombrada: nombre_codigo -> codigo
2025-11-13 14:57:20,522 - INFO - Cargando REPORTE DE COBRANZA desde: data\Cobranza_12112025.xlsx
2025-11-13 14:57:20,786 - INFO - REPORTE DE COBRANZA cargado: (207, 68)
2025-11-13 14:57:20,786 - INFO - Columnas: ['regional', 'regional1', 'coordinacion', 'coordinacion1', 'de_credito', 'de_credito1', 'gpo', 'cliente_grupo', 'unnamed:_8', 'del_cliente']...
2025-11-13 14:57:20,787 - INFO - Cargando AHORROS (ACUMULADO) desde: data/AHORROS.xlsx
2025-11-13 14:57:20,836 - INFO - AHORROS cargado: (208, 4)
2025-11-13 14:57:20,836 - INFO - Columnas: ['id', 'grupo', 'ciclo', 'ahorro_acumulado']
2025-11-13 14:57:20,837 - INFO - Iniciando generación de cartera (VERSIÓN CORREGIDA)...
2025-11-13 14:57:20,837 - INFO - Registros en antiguedad: 206
2025-11-13 14:57:20,840 - INFO - ID de grupo generados: 0    000089
1    000145
2    000069
3    000079
4    000104
Name: id_de_grupo, dtype: object
2025-11-13 14:57:20,857 - INFO - Después de joins: 208 registros
2025-11-13 14:57:20,858 - INFO - NaN en situacion: 2
2025-11-13 14:57:20,858 - INFO - NaN en cobranza: 1
2025-11-13 14:57:20,859 - INFO - NaN en ahorros: 3
2025-11-13 14:57:20,861 - INFO - Parche aplicado: 1 correcciones
2025-11-13 14:57:20,865 - INFO - Estatus calculados: {'Vigente': 206, '': 2}
2025-11-13 14:57:20,867 - INFO - Cartera vigente sistema calculada como: saldo_total - 9000
2025-11-13 14:57:20,892 - INFO - Cartera generada exitosamente: 208 filas x 36 columnas
2025-11-13 15:03:57,456 - INFO - Cargando ANTIGÜEDAD desde: data\ReportedeAntiguedaddeCarteraGrupal_12112025.xlsx
2025-11-13 15:03:57,482 - INFO - Hoja detectada: '121125'
2025-11-13 15:03:57,635 - INFO - ANTIGÜEDAD cargado: (206, 59)
2025-11-13 15:03:57,635 - INFO - Columnas: ['cod_region', 'coordinacion', 'nombre_de_gerente', 'codigo_promotor', 'nombre_promotor', 'codigo_recuperador', 'nombre_recuperador', 'cod_grupo_solidario', 'ciclo', 'grupo_solidario']...
2025-11-13 15:03:57,636 - INFO - No se encontraron IDs duplicados
2025-11-13 15:03:57,636 - INFO - Cargando SITUACIÓN DE CARTERA desde: data\Situación_de_cartera_12112025.xlsx
2025-11-13 15:03:57,748 - INFO - SITUACIÓN DE CARTERA cargada: (206, 43)
2025-11-13 15:03:57,748 - INFO - Columnas: ['codigo_ofic_cred', 'nombre_oficial_de_credito', 'codigo_promotor_cred', 'nombre_promotor_cred', 'codigo_coord', 'nombre_coordinacion', 'codigo_ger_regi', 'nombre_gerencia_regional', 'nombre_codigo', 'nombre_acreditado_cliente']...
2025-11-13 15:03:57,749 - INFO - Columna de código renombrada: nombre_codigo -> codigo
2025-11-13 15:04:13,497 - INFO - Cargando ANTIGÜEDAD desde: data\ReportedeAntiguedaddeCarteraGrupal_12112025.xlsx
2025-11-13 15:04:13,516 - INFO - Hoja detectada: '121125'
2025-11-13 15:04:13,651 - INFO - ANTIGÜEDAD cargado: (206, 59)
2025-11-13 15:04:13,652 - INFO - Columnas: ['cod_region', 'coordinacion', 'nombre_de_gerente', 'codigo_promotor', 'nombre_promotor', 'codigo_recuperador', 'nombre_recuperador', 'cod_grupo_solidario', 'ciclo', 'grupo_solidario']...
2025-11-13 15:04:13,652 - INFO - No se encontraron IDs duplicados
2025-11-13 15:04:13,652 - INFO - Cargando SITUACIÓN DE CARTERA desde: data\Situación_de_cartera_12112025.xlsx
2025-11-13 15:04:13,763 - INFO - SITUACIÓN DE CARTERA cargada: (206, 43)
2025-11-13 15:04:13,763 - INFO - Columnas: ['codigo_ofic_cred', 'nombre_oficial_de_credito', 'codigo_promotor_cred', 'nombre_promotor_cred', 'codigo_coord', 'nombre_coordinacion', 'codigo_ger_regi', 'nombre_gerencia_regional', 'nombre_codigo', 'nombre_acreditado_cliente']...
2025-11-13 15:04:13,764 - INFO - Columna de código renombrada: nombre_codigo -> codigo
2025-11-13 15:04:34,897 - INFO - Cargando ANTIGÜEDAD desde: data\ReportedeAntiguedaddeCarteraGrupal_12112025.xlsx
2025-11-13 15:04:34,916 - INFO - Hoja detectada: '121125'
2025-11-13 15:04:35,054 - INFO - ANTIGÜEDAD cargado: (206, 59)
2025-11-13 15:04:35,054 - INFO - Columnas: ['cod_region', 'coordinacion', 'nombre_de_gerente', 'codigo_promotor', 'nombre_promotor', 'codigo_recuperador', 'nombre_recuperador', 'cod_grupo_solidario', 'ciclo', 'grupo_solidario']...
2025-11-13 15:04:35,055 - INFO - No se encontraron IDs duplicados
2025-11-13 15:04:35,055 - INFO - Cargando SITUACIÓN DE CARTERA desde: data\Situación_de_cartera_12112025.xlsx
2025-11-13 15:04:35,171 - INFO - SITUACIÓN DE CARTERA cargada: (206, 43)
2025-11-13 15:04:35,171 - INFO - Columnas: ['codigo_ofic_cred', 'nombre_oficial_de_credito', 'codigo_promotor_cred', 'nombre_promotor_cred', 'codigo_coord', 'nombre_coordinacion', 'codigo_ger_regi', 'nombre_gerencia_regional', 'nombre_codigo', 'nombre_acreditado_cliente']...
2025-11-13 15:04:35,172 - INFO - Columna de código renombrada: nombre_codigo -> codigo
2025-11-13 15:04:49,555 - INFO - Cargando ANTIGÜEDAD desde: data\ReportedeAntiguedaddeCarteraGrupal_12112025.xlsx
2025-11-13 15:04:49,577 - INFO - Hoja detectada: '121125'
2025-11-13 15:04:49,739 - INFO - ANTIGÜEDAD cargado: (206, 59)
2025-11-13 15:04:49,739 - INFO - Columnas: ['cod_region', 'coordinacion', 'nombre_de_gerente', 'codigo_promotor', 'nombre_promotor', 'codigo_recuperador', 'nombre_recuperador', 'cod_grupo_solidario', 'ciclo', 'grupo_solidario']...
2025-11-13 15:04:49,740 - INFO - No se encontraron IDs duplicados
2025-11-13 15:04:49,740 - INFO - Cargando SITUACIÓN DE CARTERA desde: data\Situación_de_cartera_12112025.xlsx
2025-11-13 15:04:49,852 - INFO - SITUACIÓN DE CARTERA cargada: (206, 43)
2025-11-13 15:04:49,853 - INFO - Columnas: ['codigo_ofic_cred', 'nombre_oficial_de_credito', 'codigo_promotor_cred', 'nombre_promotor_cred', 'codigo_coord', 'nombre_coordinacion', 'codigo_ger_regi', 'nombre_gerencia_regional', 'nombre_codigo', 'nombre_acreditado_cliente']...
2025-11-13 15:04:49,853 - INFO - Columna de código renombrada: nombre_codigo -> codigo
2025-11-13 15:05:09,612 - INFO - Cargando ANTIGÜEDAD desde: data\ReportedeAntiguedaddeCarteraGrupal_12112025.xlsx
2025-11-13 15:05:09,631 - INFO - Hoja detectada: '121125'
2025-11-13 15:05:09,777 - INFO - ANTIGÜEDAD cargado: (206, 59)
2025-11-13 15:05:09,777 - INFO - Columnas: ['cod_region', 'coordinacion', 'nombre_de_gerente', 'codigo_promotor', 'nombre_promotor', 'codigo_recuperador', 'nombre_recuperador', 'cod_grupo_solidario', 'ciclo', 'grupo_solidario']...
2025-11-13 15:05:09,778 - INFO - No se encontraron IDs duplicados
2025-11-13 15:05:09,778 - INFO - Cargando SITUACIÓN DE CARTERA desde: data\Situación_de_cartera_12112025.xlsx
2025-11-13 15:05:09,887 - INFO - SITUACIÓN DE CARTERA cargada: (206, 43)
2025-11-13 15:05:09,887 - INFO - Columnas: ['codigo_ofic_cred', 'nombre_oficial_de_credito', 'codigo_promotor_cred', 'nombre_promotor_cred', 'codigo_coord', 'nombre_coordinacion', 'codigo_ger_regi', 'nombre_gerencia_regional', 'nombre_codigo', 'nombre_acreditado_cliente']...
2025-11-13 15:05:09,888 - INFO - Columna de código renombrada: nombre_codigo -> codigo
2025-11-13 15:05:48,740 - INFO - Cargando ANTIGÜEDAD desde: data\ReportedeAntiguedaddeCarteraGrupal_12112025.xlsx
2025-11-13 15:05:48,760 - INFO - Hoja detectada: '121125'
2025-11-13 15:05:48,897 - INFO - ANTIGÜEDAD cargado: (206, 59)
2025-11-13 15:05:48,897 - INFO - Columnas: ['cod_region', 'coordinacion', 'nombre_de_gerente', 'codigo_promotor', 'nombre_promotor', 'codigo_recuperador', 'nombre_recuperador', 'cod_grupo_solidario', 'ciclo', 'grupo_solidario']...
2025-11-13 15:05:48,898 - INFO - No se encontraron IDs duplicados
2025-11-13 15:05:48,898 - INFO - Cargando SITUACIÓN DE CARTERA desde: data\Situación_de_cartera_12112025.xlsx
2025-11-13 15:05:49,009 - INFO - SITUACIÓN DE CARTERA cargada: (206, 43)
2025-11-13 15:05:49,009 - INFO - Columnas: ['codigo_ofic_cred', 'nombre_oficial_de_credito', 'codigo_promotor_cred', 'nombre_promotor_cred', 'codigo_coord', 'nombre_coordinacion', 'codigo_ger_regi', 'nombre_gerencia_regional', 'nombre_codigo', 'nombre_acreditado_cliente']...
2025-11-13 15:05:49,009 - INFO - Columna de código renombrada: nombre_codigo -> codigo
2025-11-13 15:06:12,671 - INFO - Cargando ANTIGÜEDAD desde: data\ReportedeAntiguedaddeCarteraGrupal_12112025.xlsx
2025-11-13 15:06:12,690 - INFO - Hoja detectada: '121125'
2025-11-13 15:06:12,832 - INFO - ANTIGÜEDAD cargado: (206, 59)
2025-11-13 15:06:12,833 - INFO - Columnas: ['cod_region', 'coordinacion', 'nombre_de_gerente', 'codigo_promotor', 'nombre_promotor', 'codigo_recuperador', 'nombre_recuperador', 'cod_grupo_solidario', 'ciclo', 'grupo_solidario']...
2025-11-13 15:06:12,833 - INFO - No se encontraron IDs duplicados
2025-11-13 15:06:12,833 - INFO - Cargando SITUACIÓN DE CARTERA desde: data\Situación_de_cartera_12112025.xlsx
2025-11-13 15:06:12,945 - INFO - SITUACIÓN DE CARTERA cargada: (206, 43)
2025-11-13 15:06:12,945 - INFO - Columnas: ['codigo_ofic_cred', 'nombre_oficial_de_credito', 'codigo_promotor_cred', 'nombre_promotor_cred', 'codigo_coord', 'nombre_coordinacion', 'codigo_ger_regi', 'nombre_gerencia_regional', 'nombre_codigo', 'nombre_acreditado_cliente']...
2025-11-13 15:06:12,946 - INFO - Columna de código renombrada: nombre_codigo -> codigo
2025-11-13 15:06:43,550 - INFO - Cargando ANTIGÜEDAD desde: data\ReportedeAntiguedaddeCarteraGrupal_12112025.xlsx
2025-11-13 15:06:43,569 - INFO - Hoja detectada: '121125'
2025-11-13 15:06:43,707 - INFO - ANTIGÜEDAD cargado: (206, 59)
2025-11-13 15:06:43,707 - INFO - Columnas: ['cod_region', 'coordinacion', 'nombre_de_gerente', 'codigo_promotor', 'nombre_promotor', 'codigo_recuperador', 'nombre_recuperador', 'cod_grupo_solidario', 'ciclo', 'grupo_solidario']...
2025-11-13 15:06:43,708 - INFO - No se encontraron IDs duplicados
2025-11-13 15:06:43,708 - INFO - Cargando SITUACIÓN DE CARTERA desde: data\Situación_de_cartera_12112025.xlsx
2025-11-13 15:06:43,824 - INFO - SITUACIÓN DE CARTERA cargada: (206, 43)
2025-11-13 15:06:43,824 - INFO - Columnas: ['codigo_ofic_cred', 'nombre_oficial_de_credito', 'codigo_promotor_cred', 'nombre_promotor_cred', 'codigo_coord', 'nombre_coordinacion', 'codigo_ger_regi', 'nombre_gerencia_regional', 'nombre_codigo', 'nombre_acreditado_cliente']...
2025-11-13 15:06:43,825 - INFO - Columna de código renombrada: nombre_codigo -> codigo
2025-11-13 15:06:43,826 - INFO - Cargando REPORTE DE COBRANZA desde: data\Cobranza_12112025.xlsx
2025-11-13 15:06:44,001 - INFO - REPORTE DE COBRANZA cargado: (207, 68)
2025-11-13 15:06:44,002 - INFO - Columnas: ['regional', 'regional1', 'coordinacion', 'coordinacion1', 'de_credito', 'de_credito1', 'gpo', 'cliente_grupo', 'unnamed:_8', 'del_cliente']...
2025-11-13 15:06:44,002 - INFO - Cargando AHORROS (ACUMULADO) desde: data/AHORROS.xlsx
2025-11-13 15:06:44,037 - INFO - AHORROS cargado: (208, 4)
2025-11-13 15:06:44,038 - INFO - Columnas: ['id', 'grupo', 'ciclo', 'ahorro_acumulado']
2025-11-13 15:06:44,038 - INFO - Iniciando generación de cartera (VERSIÓN CORREGIDA)...
2025-11-13 15:06:44,038 - INFO - Registros en antiguedad: 206
2025-11-13 15:06:44,040 - INFO - ID de grupo generados: 0    000089
1    000145
2    000069
3    000079
4    000104
Name: id_de_grupo, dtype: object
2025-11-13 15:06:44,055 - INFO - Después de joins: 208 registros
2025-11-13 15:06:44,056 - INFO - NaN en situacion: 2
2025-11-13 15:06:44,056 - INFO - NaN en cobranza: 1
2025-11-13 15:06:44,056 - INFO - NaN en ahorros: 3
2025-11-13 15:06:44,058 - INFO - Parche aplicado: 1 correcciones
2025-11-13 15:06:44,061 - INFO - Estatus calculados: {'Vigente': 206, '': 2}
2025-11-13 15:06:44,062 - INFO - Cartera vigente sistema calculada como: saldo_total (de ANTIGÜEDAD)
2025-11-13 15:06:44,077 - INFO - Cartera generada exitosamente: 208 filas x 36 columnas
2025-11-13 15:06:58,377 - INFO - ================================================================================
2025-11-13 15:06:58,377 - INFO - INICIO DE AUTOMATIZACIÓN DE CARTERA
2025-11-13 15:06:58,377 - INFO - ================================================================================
2025-11-13 15:06:58,377 - INFO - 
--- PASO 0: BÚSQUEDA DE ARCHIVOS ---
2025-11-13 15:06:58,378 - INFO - Archivo encontrado: data\ReportedeAntiguedaddeCarteraGrupal_12112025.xlsx
2025-11-13 15:06:58,378 - INFO - Archivo encontrado: data\Situación_de_cartera_12112025.xlsx
2025-11-13 15:06:58,378 - INFO - Archivo encontrado: data\Cobranza_12112025.xlsx
2025-11-13 15:06:58,379 - INFO - Archivo encontrado: data/AHORROS.xlsx
2025-11-13 15:06:58,379 - INFO - 
--- PASO 1: CARGA DE ARCHIVOS ---
2025-11-13 15:06:58,379 - INFO - Cargando ANTIGÜEDAD desde: data\ReportedeAntiguedaddeCarteraGrupal_12112025.xlsx
2025-11-13 15:06:58,404 - INFO - Hoja detectada: '121125'
2025-11-13 15:06:58,553 - INFO - ANTIGÜEDAD cargado: (206, 59)
2025-11-13 15:06:58,553 - INFO - Columnas: ['cod_region', 'coordinacion', 'nombre_de_gerente', 'codigo_promotor', 'nombre_promotor', 'codigo_recuperador', 'nombre_recuperador', 'cod_grupo_solidario', 'ciclo', 'grupo_solidario']...
2025-11-13 15:06:58,554 - INFO - No se encontraron IDs duplicados
2025-11-13 15:06:58,554 - INFO - Cargando SITUACIÓN DE CARTERA desde: data\Situación_de_cartera_12112025.xlsx
2025-11-13 15:06:58,682 - INFO - SITUACIÓN DE CARTERA cargada: (206, 43)
2025-11-13 15:06:58,682 - INFO - Columnas: ['codigo_ofic_cred', 'nombre_oficial_de_credito', 'codigo_promotor_cred', 'nombre_promotor_cred', 'codigo_coord', 'nombre_coordinacion', 'codigo_ger_regi', 'nombre_gerencia_regional', 'nombre_codigo', 'nombre_acreditado_cliente']...
2025-11-13 15:06:58,683 - INFO - Columna de código renombrada: nombre_codigo -> codigo
2025-11-13 15:06:58,685 - INFO - Cargando REPORTE DE COBRANZA desde: data\Cobranza_12112025.xlsx
2025-11-13 15:06:58,854 - INFO - REPORTE DE COBRANZA cargado: (207, 68)
2025-11-13 15:06:58,854 - INFO - Columnas: ['regional', 'regional1', 'coordinacion', 'coordinacion1', 'de_credito', 'de_credito1', 'gpo', 'cliente_grupo', 'unnamed:_8', 'del_cliente']...
2025-11-13 15:06:58,854 - INFO - Cargando AHORROS (ACUMULADO) desde: data/AHORROS.xlsx
2025-11-13 15:06:58,889 - INFO - AHORROS cargado: (208, 4)
2025-11-13 15:06:58,889 - INFO - Columnas: ['id', 'grupo', 'ciclo', 'ahorro_acumulado']
2025-11-13 15:06:58,889 - INFO - PARCHE PROMOTORES cargado: 1 correcciones
2025-11-13 15:06:58,890 - INFO - 
--- PASO 2: GENERACIÓN DE CARTERA ---
2025-11-13 15:06:58,890 - INFO - Iniciando generación de cartera (VERSIÓN CORREGIDA)...
2025-11-13 15:06:58,890 - INFO - Registros en antiguedad: 206
2025-11-13 15:06:58,891 - INFO - ID de grupo generados: 0    000089
1    000145
2    000069
3    000079
4    000104
Name: id_de_grupo, dtype: object
2025-11-13 15:06:58,905 - INFO - Después de joins: 208 registros
2025-11-13 15:06:58,906 - INFO - NaN en situacion: 2
2025-11-13 15:06:58,906 - INFO - NaN en cobranza: 1
2025-11-13 15:06:58,906 - INFO - NaN en ahorros: 3
2025-11-13 15:06:58,908 - INFO - Parche aplicado: 1 correcciones
2025-11-13 15:06:58,910 - INFO - Estatus calculados: {'Vigente': 206, '': 2}
2025-11-13 15:06:58,910 - INFO - Cartera vigente sistema calculada como: saldo_total (de ANTIGÜEDAD)
2025-11-13 15:06:58,924 - INFO - Cartera generada exitosamente: 208 filas x 36 columnas
2025-11-13 15:06:58,924 - INFO - 
--- PASO 3: GUARDADO DE RESULTADO CON FORMATO ---
2025-11-13 15:06:58,924 - INFO - ================================================================================
2025-11-13 15:06:58,924 - INFO - GUARDANDO DATAFRAME CON FORMATO
2025-11-13 15:06:58,924 - INFO - ================================================================================
2025-11-13 15:06:58,924 - INFO - 
1. Cargando plantilla de headers: plantilla/CARTERA_HEADERS.xlsx
2025-11-13 15:06:58,934 - INFO - Plantilla cargada: 6 filas x 36 columnas (6.1 KB)
2025-11-13 15:06:58,934 - INFO - 
2. Creando nuevo workbook...
2025-11-13 15:06:58,936 - INFO - 
3. Copiando headers desde plantilla...
2025-11-13 15:06:58,936 - INFO - Copiando headers (filas 1-6) con formato...
2025-11-13 15:06:58,977 - INFO - Headers copiados: 36 columnas
2025-11-13 15:06:58,978 - INFO - 
4. Pegando datos del DataFrame...
2025-11-13 15:06:58,978 - INFO - Pegando DataFrame (208 filas x 36 columnas) desde fila 7...
2025-11-13 15:06:59,017 - INFO - Datos pegados hasta fila 214
2025-11-13 15:06:59,017 - INFO - 
5. Formato de datos: Se aplicará automáticamente por la tabla Excel
2025-11-13 15:06:59,017 - INFO - 
6. Creando tabla de Excel con totales...
2025-11-13 15:06:59,018 - INFO - Creando tabla Excel 'TablaCartera' desde fila 6 hasta 214...
2025-11-13 15:06:59,018 - INFO - Rango de tabla: A6:AJ215
2025-11-13 15:06:59,018 - INFO - Fila de totales: 215
2025-11-13 15:06:59,018 - INFO - Nombres de columnas extraídos: 36
2025-11-13 15:06:59,018 - INFO -   Columna 6 'Monto del crédito': SUM
2025-11-13 15:06:59,018 - INFO -   Columna 13 'Pago Semanal': SUM
2025-11-13 15:06:59,018 - INFO -   Columna 15 'Cartera vigente sistema': SUM
2025-11-13 15:06:59,018 - INFO -   Columna 16 'Carera vigente inicial': SUM
2025-11-13 15:06:59,018 - INFO -   Columna 17 'Cartera vigente calculada': SUM
2025-11-13 15:06:59,018 - INFO -   Columna 18 'Cartera Insoluta': SUM
2025-11-13 15:06:59,018 - INFO -   Columna 19 'Diferencia Validación vigente': SUM
2025-11-13 15:06:59,018 - INFO -   Columna 20 'Ahorro Consumido': SUM
2025-11-13 15:06:59,019 - INFO -   Columna 21 'Cartera Vencida Estadistica': SUM
2025-11-13 15:06:59,019 - INFO -   Columna 22 'Cartera vencida Total': SUM
2025-11-13 15:06:59,019 - INFO -   Columna 24 'Saldo en riesgo': SUM
2025-11-13 15:06:59,019 - INFO -   Columna 25 'Saldo 
ahorro 
acumulado': SUM
2025-11-13 15:06:59,019 - INFO -   Columna 26 'Monto promedio del grupo': SUM
2025-11-13 15:06:59,019 - INFO -   Columna 33 'Ahorro Acumulado': SUM
2025-11-13 15:06:59,019 - INFO - Escribiendo fórmulas en fila de totales...
2025-11-13 15:06:59,019 - INFO -   Fórmula en columna 6: =SUBTOTAL(109,F7:F214)
2025-11-13 15:06:59,019 - INFO -   Fórmula en columna 13: =SUBTOTAL(109,M7:M214)
2025-11-13 15:06:59,019 - INFO -   Fórmula en columna 15: =SUBTOTAL(109,O7:O214)
2025-11-13 15:06:59,019 - INFO -   Fórmula en columna 16: =SUBTOTAL(109,P7:P214)
2025-11-13 15:06:59,020 - INFO -   Fórmula en columna 17: =SUBTOTAL(109,Q7:Q214)
2025-11-13 15:06:59,020 - INFO -   Fórmula en columna 18: =SUBTOTAL(109,R7:R214)
2025-11-13 15:06:59,020 - INFO -   Fórmula en columna 19: =SUBTOTAL(109,S7:S214)
2025-11-13 15:06:59,020 - INFO -   Fórmula en columna 20: =SUBTOTAL(109,T7:T214)
2025-11-13 15:06:59,020 - INFO -   Fórmula en columna 21: =SUBTOTAL(109,U7:U214)
2025-11-13 15:06:59,020 - INFO -   Fórmula en columna 22: =SUBTOTAL(109,V7:V214)
2025-11-13 15:06:59,020 - INFO -   Fórmula en columna 24: =SUBTOTAL(109,X7:X214)
2025-11-13 15:06:59,020 - INFO -   Fórmula en columna 25: =SUBTOTAL(109,Y7:Y214)
2025-11-13 15:06:59,020 - INFO -   Fórmula en columna 26: =SUBTOTAL(109,Z7:Z214)
2025-11-13 15:06:59,020 - INFO -   Fórmula en columna 33: =SUBTOTAL(109,AG7:AG214)
2025-11-13 15:06:59,020 - INFO - Tabla creada exitosamente con 208 filas de datos + fila totales
2025-11-13 15:06:59,020 - INFO - Totales configurados en 14 columnas con fórmulas SUBTOTAL
2025-11-13 15:06:59,020 - INFO - Fila de totales: Formato aplicado automáticamente por la tabla
2025-11-13 15:06:59,020 - INFO - 
7. Guardando archivo: output_automatizado.xlsx
2025-11-13 15:06:59,021 - ERROR - 
ERROR: [Errno 13] Permission denied: 'output_automatizado.xlsx'
Traceback (most recent call last):
  File "C:\Users\uzzie\Documents\Jale\merge-dataframes\analizar_y_automatizar.py", line 314, in main
    guardar_con_formato(df_cartera, RUTA_PLANTILLA, RUTA_OUTPUT)
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\uzzie\Documents\Jale\merge-dataframes\formato_excel.py", line 305, in guardar_con_formato
    wb_nuevo.save(ruta_output)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\uzzie\miniconda3\Lib\site-packages\openpyxl\workbook\workbook.py", line 386, in save
    save_workbook(self, filename)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "C:\Users\uzzie\miniconda3\Lib\site-packages\openpyxl\writer\excel.py", line 291, in save_workbook
    archive = ZipFile(filename, 'w', ZIP_DEFLATED, allowZip64=True)
  File "C:\Users\uzzie\miniconda3\Lib\zipfile\__init__.py", line 1367, in __init__
    self.fp = io.open(file, filemode)
              ~~~~~~~^^^^^^^^^^^^^^^^
PermissionError: [Errno 13] Permission denied: 'output_automatizado.xlsx'
2025-11-13 16:24:51,483 - INFO - Cargando ANTIGÜEDAD desde: data\ReportedeAntiguedaddeCarteraGrupal_12112025.xlsx
2025-11-13 16:24:51,507 - INFO - Hoja detectada: '121125'
2025-11-13 16:24:51,666 - INFO - ANTIGÜEDAD cargado: (206, 59)
2025-11-13 16:24:51,667 - INFO - Columnas: ['cod_region', 'coordinacion', 'nombre_de_gerente', 'codigo_promotor', 'nombre_promotor', 'codigo_recuperador', 'nombre_recuperador', 'cod_grupo_solidario', 'ciclo', 'grupo_solidario']...
2025-11-13 16:24:51,671 - INFO - No se encontraron IDs duplicados
2025-11-13 16:24:51,671 - INFO - Cargando SITUACIÓN DE CARTERA desde: data\Situación_de_cartera_12112025.xlsx
2025-11-13 16:24:51,794 - INFO - SITUACIÓN DE CARTERA cargada: (206, 43)
2025-11-13 16:24:51,795 - INFO - Columnas: ['codigo_ofic_cred', 'nombre_oficial_de_credito', 'codigo_promotor_cred', 'nombre_promotor_cred', 'codigo_coord', 'nombre_coordinacion', 'codigo_ger_regi', 'nombre_gerencia_regional', 'nombre_codigo', 'nombre_acreditado_cliente']...
2025-11-13 16:24:51,796 - INFO - Columna de código renombrada: nombre_codigo -> codigo
2025-11-13 16:24:51,798 - INFO - Cargando REPORTE DE COBRANZA desde: data\Cobranza_12112025.xlsx
2025-11-13 16:24:52,028 - INFO - REPORTE DE COBRANZA cargado: (207, 68)
2025-11-13 16:24:52,028 - INFO - Columnas: ['regional', 'regional1', 'coordinacion', 'coordinacion1', 'de_credito', 'de_credito1', 'gpo', 'cliente_grupo', 'unnamed:_8', 'del_cliente']...
2025-11-13 16:24:52,028 - INFO - Cargando AHORROS (ACUMULADO) desde: data/AHORROS.xlsx
2025-11-13 16:24:52,067 - INFO - AHORROS cargado: (208, 4)
2025-11-13 16:24:52,068 - INFO - Columnas: ['id', 'grupo', 'ciclo', 'ahorro_acumulado']
2025-11-13 16:24:52,068 - INFO - Iniciando generación de cartera (VERSIÓN CORREGIDA)...
2025-11-13 16:24:52,068 - INFO - Registros en antiguedad: 206
2025-11-13 16:24:52,072 - INFO - ID de grupo generados: 0    000089
1    000145
2    000069
3    000079
4    000104
Name: id_de_grupo, dtype: object
2025-11-13 16:24:52,098 - INFO - Después de joins: 208 registros
2025-11-13 16:24:52,098 - INFO - NaN en situacion: 2
2025-11-13 16:24:52,099 - INFO - NaN en cobranza: 1
2025-11-13 16:24:52,100 - INFO - NaN en ahorros: 3
2025-11-13 16:24:52,101 - INFO - Parche aplicado: 1 correcciones
2025-11-13 16:24:52,104 - INFO - Estatus calculados: {'Vigente': 206, '': 2}
2025-11-13 16:24:52,106 - INFO - Cartera vigente sistema calculada como: saldo_total (de ANTIGÜEDAD)
2025-11-13 16:24:52,132 - INFO - Cartera generada exitosamente: 208 filas x 36 columnas
2025-11-13 16:31:29,730 - INFO - ================================================================================
2025-11-13 16:31:29,730 - INFO - INICIO DE AUTOMATIZACIÓN DE CARTERA
2025-11-13 16:31:29,730 - INFO - ================================================================================
2025-11-13 16:31:29,730 - INFO - 
--- PASO 0: BÚSQUEDA DE ARCHIVOS ---
2025-11-13 16:31:29,731 - INFO - Archivo encontrado: data\ReportedeAntiguedaddeCarteraGrupal_12112025.xlsx
2025-11-13 16:31:29,731 - INFO - Archivo encontrado: data\Situación_de_cartera_12112025.xlsx
2025-11-13 16:31:29,732 - INFO - Archivo encontrado: data\Cobranza_12112025.xlsx
2025-11-13 16:31:29,732 - INFO - Archivo encontrado: data/AHORROS.xlsx
2025-11-13 16:31:29,732 - INFO - 
--- PASO 1: CARGA DE ARCHIVOS ---
2025-11-13 16:31:29,732 - INFO - Cargando ANTIGÜEDAD desde: data\ReportedeAntiguedaddeCarteraGrupal_12112025.xlsx
2025-11-13 16:31:29,751 - INFO - Hoja detectada: '121125'
2025-11-13 16:31:29,897 - INFO - ANTIGÜEDAD cargado: (206, 59)
2025-11-13 16:31:29,897 - INFO - Columnas: ['cod_region', 'coordinacion', 'nombre_de_gerente', 'codigo_promotor', 'nombre_promotor', 'codigo_recuperador', 'nombre_recuperador', 'cod_grupo_solidario', 'ciclo', 'grupo_solidario']...
2025-11-13 16:31:29,898 - INFO - No se encontraron IDs duplicados
2025-11-13 16:31:29,898 - INFO - Cargando SITUACIÓN DE CARTERA desde: data\Situación_de_cartera_12112025.xlsx
2025-11-13 16:31:30,016 - INFO - SITUACIÓN DE CARTERA cargada: (206, 43)
2025-11-13 16:31:30,016 - INFO - Columnas: ['codigo_ofic_cred', 'nombre_oficial_de_credito', 'codigo_promotor_cred', 'nombre_promotor_cred', 'codigo_coord', 'nombre_coordinacion', 'codigo_ger_regi', 'nombre_gerencia_regional', 'nombre_codigo', 'nombre_acreditado_cliente']...
2025-11-13 16:31:30,017 - INFO - Columna de código renombrada: nombre_codigo -> codigo
2025-11-13 16:31:30,019 - INFO - Cargando REPORTE DE COBRANZA desde: data\Cobranza_12112025.xlsx
2025-11-13 16:31:30,193 - INFO - REPORTE DE COBRANZA cargado: (207, 68)
2025-11-13 16:31:30,193 - INFO - Columnas: ['regional', 'regional1', 'coordinacion', 'coordinacion1', 'de_credito', 'de_credito1', 'gpo', 'cliente_grupo', 'unnamed:_8', 'del_cliente']...
2025-11-13 16:31:30,193 - INFO - Cargando AHORROS (ACUMULADO) desde: data/AHORROS.xlsx
2025-11-13 16:31:30,229 - INFO - AHORROS cargado: (208, 4)
2025-11-13 16:31:30,229 - INFO - Columnas: ['id', 'grupo', 'ciclo', 'ahorro_acumulado']
2025-11-13 16:31:30,230 - INFO - PARCHE PROMOTORES cargado: 1 correcciones
2025-11-13 16:31:30,230 - INFO - 
--- PASO 2: GENERACIÓN DE CARTERA ---
2025-11-13 16:31:30,230 - INFO - Iniciando generación de cartera (VERSIÓN CORREGIDA)...
2025-11-13 16:31:30,230 - INFO - Registros en antiguedad: 206
2025-11-13 16:31:30,233 - INFO - ID de grupo generados: 0    000089
1    000145
2    000069
3    000079
4    000104
Name: id_de_grupo, dtype: object
2025-11-13 16:31:30,247 - INFO - Después de joins: 208 registros
2025-11-13 16:31:30,247 - INFO - NaN en situacion: 2
2025-11-13 16:31:30,248 - INFO - NaN en cobranza: 1
2025-11-13 16:31:30,248 - INFO - NaN en ahorros: 3
2025-11-13 16:31:30,249 - INFO - Parche aplicado: 1 correcciones
2025-11-13 16:31:30,252 - INFO - Estatus calculados: {'Vigente': 206, '': 2}
2025-11-13 16:31:30,252 - INFO - Cartera vigente sistema calculada como: saldo_total (de ANTIGÜEDAD)
2025-11-13 16:31:30,265 - INFO - Cartera generada exitosamente: 208 filas x 36 columnas
2025-11-13 16:31:30,265 - INFO - 
--- PASO 3: GUARDADO DE RESULTADO CON FORMATO ---
2025-11-13 16:31:30,265 - INFO - ================================================================================
2025-11-13 16:31:30,265 - INFO - GUARDANDO DATAFRAME CON FORMATO
2025-11-13 16:31:30,265 - INFO - ================================================================================
2025-11-13 16:31:30,265 - INFO - 
1. Cargando plantilla de headers: plantilla/CARTERA_HEADERS.xlsx
2025-11-13 16:31:30,285 - INFO - Plantilla cargada: 6 filas x 36 columnas (6.1 KB)
2025-11-13 16:31:30,285 - INFO - 
2. Creando nuevo workbook...
2025-11-13 16:31:30,287 - INFO - 
3. Copiando headers desde plantilla...
2025-11-13 16:31:30,287 - INFO - Copiando headers (filas 1-6) con formato...
2025-11-13 16:31:30,323 - INFO - Headers copiados: 36 columnas
2025-11-13 16:31:30,324 - INFO - 
4. Pegando datos del DataFrame...
2025-11-13 16:31:30,324 - INFO - Pegando DataFrame (208 filas x 36 columnas) desde fila 7...
2025-11-13 16:31:30,364 - INFO - Datos pegados hasta fila 214
2025-11-13 16:31:30,364 - INFO - 
5. Formato de datos: Se aplicará automáticamente por la tabla Excel
2025-11-13 16:31:30,364 - INFO - 
6. Creando tabla de Excel con totales...
2025-11-13 16:31:30,364 - INFO - Creando tabla Excel 'TablaCartera' desde fila 6 hasta 214...
2025-11-13 16:31:30,364 - INFO - Rango de tabla: A6:AJ215
2025-11-13 16:31:30,364 - INFO - Fila de totales: 215
2025-11-13 16:31:30,365 - INFO - Nombres de columnas extraídos: 36
2025-11-13 16:31:30,365 - INFO -   Columna 6 'Monto del crédito': SUM
2025-11-13 16:31:30,365 - INFO -   Columna 13 'Pago Semanal': SUM
2025-11-13 16:31:30,365 - INFO -   Columna 15 'Cartera vigente sistema': SUM
2025-11-13 16:31:30,365 - INFO -   Columna 16 'Carera vigente inicial': SUM
2025-11-13 16:31:30,365 - INFO -   Columna 17 'Cartera vigente calculada': SUM
2025-11-13 16:31:30,365 - INFO -   Columna 18 'Cartera Insoluta': SUM
2025-11-13 16:31:30,365 - INFO -   Columna 19 'Diferencia Validación vigente': SUM
2025-11-13 16:31:30,365 - INFO -   Columna 20 'Ahorro Consumido': SUM
2025-11-13 16:31:30,365 - INFO -   Columna 21 'Cartera Vencida Estadistica': SUM
2025-11-13 16:31:30,365 - INFO -   Columna 22 'Cartera vencida Total': SUM
2025-11-13 16:31:30,365 - INFO -   Columna 24 'Saldo en riesgo': SUM
2025-11-13 16:31:30,366 - INFO -   Columna 25 'Saldo 
ahorro 
acumulado': SUM
2025-11-13 16:31:30,366 - INFO -   Columna 26 'Monto promedio del grupo': SUM
2025-11-13 16:31:30,366 - INFO -   Columna 33 'Ahorro Acumulado': SUM
2025-11-13 16:31:30,366 - INFO - Escribiendo fórmulas en fila de totales...
2025-11-13 16:31:30,366 - INFO -   Fórmula en columna 6: =SUBTOTAL(109,F7:F214)
2025-11-13 16:31:30,366 - INFO -   Fórmula en columna 13: =SUBTOTAL(109,M7:M214)
2025-11-13 16:31:30,366 - INFO -   Fórmula en columna 15: =SUBTOTAL(109,O7:O214)
2025-11-13 16:31:30,366 - INFO -   Fórmula en columna 16: =SUBTOTAL(109,P7:P214)
2025-11-13 16:31:30,366 - INFO -   Fórmula en columna 17: =SUBTOTAL(109,Q7:Q214)
2025-11-13 16:31:30,366 - INFO -   Fórmula en columna 18: =SUBTOTAL(109,R7:R214)
2025-11-13 16:31:30,366 - INFO -   Fórmula en columna 19: =SUBTOTAL(109,S7:S214)
2025-11-13 16:31:30,366 - INFO -   Fórmula en columna 20: =SUBTOTAL(109,T7:T214)
2025-11-13 16:31:30,366 - INFO -   Fórmula en columna 21: =SUBTOTAL(109,U7:U214)
2025-11-13 16:31:30,367 - INFO -   Fórmula en columna 22: =SUBTOTAL(109,V7:V214)
2025-11-13 16:31:30,367 - INFO -   Fórmula en columna 24: =SUBTOTAL(109,X7:X214)
2025-11-13 16:31:30,367 - INFO -   Fórmula en columna 25: =SUBTOTAL(109,Y7:Y214)
2025-11-13 16:31:30,367 - INFO -   Fórmula en columna 26: =SUBTOTAL(109,Z7:Z214)
2025-11-13 16:31:30,367 - INFO -   Fórmula en columna 33: =SUBTOTAL(109,AG7:AG214)
2025-11-13 16:31:30,367 - INFO - Tabla creada exitosamente con 208 filas de datos + fila totales
2025-11-13 16:31:30,367 - INFO - Totales configurados en 14 columnas con fórmulas SUBTOTAL
2025-11-13 16:31:30,367 - INFO - Fila de totales: Formato aplicado automáticamente por la tabla
2025-11-13 16:31:30,367 - INFO - 
7. Guardando archivo: output_automatizado.xlsx
2025-11-13 16:31:30,495 - INFO - 
================================================================================
2025-11-13 16:31:30,496 - INFO - ARCHIVO GUARDADO EXITOSAMENTE
2025-11-13 16:31:30,496 - INFO - ================================================================================
2025-11-13 16:31:30,496 - INFO - 
Archivo: output_automatizado.xlsx
2025-11-13 16:31:30,496 - INFO - Filas de datos: 208
2025-11-13 16:31:30,496 - INFO - Columnas: 36
2025-11-13 16:31:30,496 - INFO - Formato: Idéntico al machote
2025-11-13 16:31:30,496 - INFO - Tabla Excel: Con totales automáticos
2025-11-13 16:31:30,497 - INFO - ================================================================================
2025-11-13 16:31:30,497 - INFO - OK - Archivo guardado con formato: output_automatizado.xlsx
2025-11-13 16:31:30,497 - INFO - 
--- PASO 4: GENERACIÓN DE HOJA MORA ---
2025-11-13 16:31:30,497 - INFO - 
Iniciando generación de hoja MORA...
2025-11-13 16:31:30,498 - INFO - Registros con %mora > 5%: 7 de 208
2025-11-13 16:31:30,500 - INFO - Hoja MORA generada con 7 registros y 14 columnas
2025-11-13 16:31:30,500 - INFO - 
================================================================================
2025-11-13 16:31:30,500 - INFO - AGREGANDO HOJA MORA
2025-11-13 16:31:30,500 - INFO - ================================================================================
2025-11-13 16:31:30,500 - INFO - 
1. Abriendo archivo: output_automatizado.xlsx
2025-11-13 16:31:30,667 - INFO - 
2. Creando hoja 'Mora'
2025-11-13 16:31:30,668 - INFO - 
3. Copiando formato de headers desde plantilla
2025-11-13 16:31:30,687 - INFO - 
4. Estableciendo headers de MORA
2025-11-13 16:31:30,688 - INFO - 
5. Pegando 7 filas de datos
2025-11-13 16:31:30,690 - INFO - 
6. Creando tabla Excel con totales
2025-11-13 16:31:30,690 - INFO -    Creando tabla: A6:N14
2025-11-13 16:31:30,690 - INFO -    Tabla 'TablaMora' creada con totales automáticos
2025-11-13 16:31:30,690 - INFO -    Fórmulas SUBTOTAL escritas en 6 columnas
2025-11-13 16:31:30,690 - INFO - 
7. Guardando archivo con hoja MORA
2025-11-13 16:31:30,805 - INFO - 
================================================================================
2025-11-13 16:31:30,805 - INFO - HOJA MORA AGREGADA EXITOSAMENTE
2025-11-13 16:31:30,805 - INFO - ================================================================================
2025-11-13 16:31:30,805 - INFO - 
Registros en MORA: 7
2025-11-13 16:31:30,805 - INFO - Filtro: %mora > 5%
2025-11-13 16:31:30,805 - INFO - Columnas amarillas: %mora, Días de mora
2025-11-13 16:31:30,805 - INFO - ================================================================================
2025-11-13 16:31:30,806 - INFO - OK - Hoja MORA agregada con 7 registros
2025-11-13 16:31:30,806 - INFO - 
--- PASO 5: VALIDACIÓN ---
2025-11-13 16:31:30,806 - INFO - Machote no encontrado - validación omitida (no es necesario)
2025-11-13 16:31:30,806 - INFO - 
================================================================================
2025-11-13 16:31:30,806 - INFO - AUTOMATIZACIÓN COMPLETADA EXITOSAMENTE
2025-11-13 16:31:30,806 - INFO - ================================================================================
2025-11-13 16:49:09,184 - INFO - Cargando ANTIGÜEDAD desde: data\ReportedeAntiguedaddeCarteraGrupal_12112025.xlsx
2025-11-13 16:49:09,209 - INFO - Hoja detectada: '121125'
2025-11-13 16:49:09,367 - INFO - ANTIGÜEDAD cargado: (206, 59)
2025-11-13 16:49:09,368 - INFO - Columnas: ['cod_region', 'coordinacion', 'nombre_de_gerente', 'codigo_promotor', 'nombre_promotor', 'codigo_recuperador', 'nombre_recuperador', 'cod_grupo_solidario', 'ciclo', 'grupo_solidario']...
2025-11-13 16:49:09,372 - INFO - No se encontraron IDs duplicados
2025-11-13 16:49:09,372 - INFO - Cargando SITUACIÓN DE CARTERA desde: data\Situación_de_cartera_12112025.xlsx
2025-11-13 16:49:09,495 - INFO - SITUACIÓN DE CARTERA cargada: (206, 43)
2025-11-13 16:49:09,495 - INFO - Columnas: ['codigo_ofic_cred', 'nombre_oficial_de_credito', 'codigo_promotor_cred', 'nombre_promotor_cred', 'codigo_coord', 'nombre_coordinacion', 'codigo_ger_regi', 'nombre_gerencia_regional', 'nombre_codigo', 'nombre_acreditado_cliente']...
2025-11-13 16:49:09,497 - INFO - Columna de código renombrada: nombre_codigo -> codigo
2025-11-13 16:49:09,500 - INFO - Cargando REPORTE DE COBRANZA desde: data\Cobranza_12112025.xlsx
2025-11-13 16:49:09,679 - INFO - REPORTE DE COBRANZA cargado: (207, 68)
2025-11-13 16:49:09,680 - INFO - Columnas: ['regional', 'regional1', 'coordinacion', 'coordinacion1', 'de_credito', 'de_credito1', 'gpo', 'cliente_grupo', 'unnamed:_8', 'del_cliente']...
2025-11-13 16:49:09,682 - INFO - Cargando AHORROS (ACUMULADO) desde: data/AHORROS.xlsx
2025-11-13 16:49:09,718 - INFO - AHORROS cargado: (208, 4)
2025-11-13 16:49:09,719 - INFO - Columnas: ['id', 'grupo', 'ciclo', 'ahorro_acumulado']
2025-11-13 16:49:09,719 - INFO - Iniciando generación de cartera (VERSIÓN CORREGIDA)...
2025-11-13 16:49:09,719 - INFO - Registros en antiguedad: 206
2025-11-13 16:49:09,723 - INFO - ID de grupo generados: 0    000089
1    000145
2    000069
3    000079
4    000104
Name: id_de_grupo, dtype: object
2025-11-13 16:49:09,746 - INFO - Después de joins: 208 registros
2025-11-13 16:49:09,747 - INFO - NaN en situacion: 2
2025-11-13 16:49:09,747 - INFO - NaN en cobranza: 1
2025-11-13 16:49:09,747 - INFO - NaN en ahorros: 3
2025-11-13 16:49:09,749 - INFO - Parche aplicado: 1 correcciones
2025-11-13 16:49:09,752 - INFO - Estatus calculados: {'Vigente': 206, '': 2}
2025-11-13 16:49:09,753 - INFO - Cartera vigente sistema calculada como: saldo_total (de ANTIGÜEDAD)
2025-11-13 16:49:09,771 - INFO - Cartera generada exitosamente: 208 filas x 36 columnas
2025-11-13 16:49:34,058 - INFO - Cargando ANTIGÜEDAD desde: data\ReportedeAntiguedaddeCarteraGrupal_12112025.xlsx
2025-11-13 16:49:34,078 - INFO - Hoja detectada: '121125'
2025-11-13 16:49:34,220 - INFO - ANTIGÜEDAD cargado: (206, 59)
2025-11-13 16:49:34,220 - INFO - Columnas: ['cod_region', 'coordinacion', 'nombre_de_gerente', 'codigo_promotor', 'nombre_promotor', 'codigo_recuperador', 'nombre_recuperador', 'cod_grupo_solidario', 'ciclo', 'grupo_solidario']...
2025-11-13 16:49:34,221 - INFO - No se encontraron IDs duplicados
2025-11-13 16:49:34,221 - INFO - Cargando SITUACIÓN DE CARTERA desde: data\Situación_de_cartera_12112025.xlsx
2025-11-13 16:49:34,330 - INFO - SITUACIÓN DE CARTERA cargada: (206, 43)
2025-11-13 16:49:34,330 - INFO - Columnas: ['codigo_ofic_cred', 'nombre_oficial_de_credito', 'codigo_promotor_cred', 'nombre_promotor_cred', 'codigo_coord', 'nombre_coordinacion', 'codigo_ger_regi', 'nombre_gerencia_regional', 'nombre_codigo', 'nombre_acreditado_cliente']...
2025-11-13 16:49:34,330 - INFO - Columna de código renombrada: nombre_codigo -> codigo
2025-11-13 16:49:34,331 - INFO - Cargando REPORTE DE COBRANZA desde: data\Cobranza_12112025.xlsx
2025-11-13 16:49:34,516 - INFO - REPORTE DE COBRANZA cargado: (207, 68)
2025-11-13 16:49:34,516 - INFO - Columnas: ['regional', 'regional1', 'coordinacion', 'coordinacion1', 'de_credito', 'de_credito1', 'gpo', 'cliente_grupo', 'unnamed:_8', 'del_cliente']...
2025-11-13 16:49:34,517 - INFO - Cargando AHORROS (ACUMULADO) desde: data/AHORROS.xlsx
2025-11-13 16:49:34,554 - INFO - AHORROS cargado: (208, 4)
2025-11-13 16:49:34,555 - INFO - Columnas: ['id', 'grupo', 'ciclo', 'ahorro_acumulado']
2025-11-13 16:49:34,555 - INFO - Iniciando generación de cartera (VERSIÓN CORREGIDA)...
2025-11-13 16:49:34,555 - INFO - Registros en antiguedad: 206
2025-11-13 16:49:34,557 - INFO - ID de grupo generados: 0    000089
1    000145
2    000069
3    000079
4    000104
Name: id_de_grupo, dtype: object
2025-11-13 16:49:34,571 - INFO - Después de joins: 208 registros
2025-11-13 16:49:34,571 - INFO - NaN en situacion: 2
2025-11-13 16:49:34,571 - INFO - NaN en cobranza: 1
2025-11-13 16:49:34,572 - INFO - NaN en ahorros: 3
2025-11-13 16:49:34,573 - INFO - Parche aplicado: 1 correcciones
2025-11-13 16:49:34,575 - INFO - Estatus calculados: {'Vigente': 208}
2025-11-13 16:49:34,576 - INFO - Cartera vigente sistema calculada como: saldo_total (de ANTIGÜEDAD)
2025-11-13 16:49:34,590 - INFO - Cartera generada exitosamente: 208 filas x 36 columnas
2025-11-13 16:50:19,346 - INFO - ================================================================================
2025-11-13 16:50:19,346 - INFO - INICIO DE AUTOMATIZACIÓN DE CARTERA
2025-11-13 16:50:19,346 - INFO - ================================================================================
2025-11-13 16:50:19,346 - INFO - 
--- PASO 0: BÚSQUEDA DE ARCHIVOS ---
2025-11-13 16:50:19,347 - INFO - Archivo encontrado: data\ReportedeAntiguedaddeCarteraGrupal_12112025.xlsx
2025-11-13 16:50:19,347 - INFO - Archivo encontrado: data\Situación_de_cartera_12112025.xlsx
2025-11-13 16:50:19,348 - INFO - Archivo encontrado: data\Cobranza_12112025.xlsx
2025-11-13 16:50:19,348 - INFO - Archivo encontrado: data/AHORROS.xlsx
2025-11-13 16:50:19,348 - INFO - 
--- PASO 1: CARGA DE ARCHIVOS ---
2025-11-13 16:50:19,348 - INFO - Cargando ANTIGÜEDAD desde: data\ReportedeAntiguedaddeCarteraGrupal_12112025.xlsx
2025-11-13 16:50:19,369 - INFO - Hoja detectada: '121125'
2025-11-13 16:50:19,516 - INFO - ANTIGÜEDAD cargado: (206, 59)
2025-11-13 16:50:19,516 - INFO - Columnas: ['cod_region', 'coordinacion', 'nombre_de_gerente', 'codigo_promotor', 'nombre_promotor', 'codigo_recuperador', 'nombre_recuperador', 'cod_grupo_solidario', 'ciclo', 'grupo_solidario']...
2025-11-13 16:50:19,517 - INFO - No se encontraron IDs duplicados
2025-11-13 16:50:19,517 - INFO - Cargando SITUACIÓN DE CARTERA desde: data\Situación_de_cartera_12112025.xlsx
2025-11-13 16:50:19,639 - INFO - SITUACIÓN DE CARTERA cargada: (206, 43)
2025-11-13 16:50:19,640 - INFO - Columnas: ['codigo_ofic_cred', 'nombre_oficial_de_credito', 'codigo_promotor_cred', 'nombre_promotor_cred', 'codigo_coord', 'nombre_coordinacion', 'codigo_ger_regi', 'nombre_gerencia_regional', 'nombre_codigo', 'nombre_acreditado_cliente']...
2025-11-13 16:50:19,640 - INFO - Columna de código renombrada: nombre_codigo -> codigo
2025-11-13 16:50:19,642 - INFO - Cargando REPORTE DE COBRANZA desde: data\Cobranza_12112025.xlsx
2025-11-13 16:50:19,823 - INFO - REPORTE DE COBRANZA cargado: (207, 68)
2025-11-13 16:50:19,823 - INFO - Columnas: ['regional', 'regional1', 'coordinacion', 'coordinacion1', 'de_credito', 'de_credito1', 'gpo', 'cliente_grupo', 'unnamed:_8', 'del_cliente']...
2025-11-13 16:50:19,824 - INFO - Cargando AHORROS (ACUMULADO) desde: data/AHORROS.xlsx
2025-11-13 16:50:19,859 - INFO - AHORROS cargado: (208, 4)
2025-11-13 16:50:19,859 - INFO - Columnas: ['id', 'grupo', 'ciclo', 'ahorro_acumulado']
2025-11-13 16:50:19,859 - INFO - PARCHE PROMOTORES cargado: 1 correcciones
2025-11-13 16:50:19,859 - INFO - 
--- PASO 2: GENERACIÓN DE CARTERA ---
2025-11-13 16:50:19,859 - INFO - Iniciando generación de cartera (VERSIÓN CORREGIDA)...
2025-11-13 16:50:19,859 - INFO - Registros en antiguedad: 206
2025-11-13 16:50:19,861 - INFO - ID de grupo generados: 0    000089
1    000145
2    000069
3    000079
4    000104
Name: id_de_grupo, dtype: object
2025-11-13 16:50:19,875 - INFO - Después de joins: 208 registros
2025-11-13 16:50:19,875 - INFO - NaN en situacion: 2
2025-11-13 16:50:19,876 - INFO - NaN en cobranza: 1
2025-11-13 16:50:19,876 - INFO - NaN en ahorros: 3
2025-11-13 16:50:19,877 - INFO - Parche aplicado: 1 correcciones
2025-11-13 16:50:19,880 - INFO - Estatus calculados: {'Vigente': 208}
2025-11-13 16:50:19,880 - INFO - Cartera vigente sistema calculada como: saldo_total (de ANTIGÜEDAD)
2025-11-13 16:50:19,893 - INFO - Cartera generada exitosamente: 208 filas x 36 columnas
2025-11-13 16:50:19,894 - INFO - 
--- PASO 3: GUARDADO DE RESULTADO CON FORMATO ---
2025-11-13 16:50:19,894 - INFO - ================================================================================
2025-11-13 16:50:19,894 - INFO - GUARDANDO DATAFRAME CON FORMATO
2025-11-13 16:50:19,894 - INFO - ================================================================================
2025-11-13 16:50:19,894 - INFO - 
1. Cargando plantilla de headers: plantilla/CARTERA_HEADERS.xlsx
2025-11-13 16:50:19,903 - INFO - Plantilla cargada: 6 filas x 36 columnas (6.1 KB)
2025-11-13 16:50:19,903 - INFO - 
2. Creando nuevo workbook...
2025-11-13 16:50:19,905 - INFO - 
3. Copiando headers desde plantilla...
2025-11-13 16:50:19,905 - INFO - Copiando headers (filas 1-6) con formato...
2025-11-13 16:50:19,944 - INFO - Headers copiados: 36 columnas
2025-11-13 16:50:19,945 - INFO - 
4. Pegando datos del DataFrame...
2025-11-13 16:50:19,945 - INFO - Pegando DataFrame (208 filas x 36 columnas) desde fila 7...
2025-11-13 16:50:19,983 - INFO - Datos pegados hasta fila 214
2025-11-13 16:50:19,983 - INFO - 
5. Formato de datos: Se aplicará automáticamente por la tabla Excel
2025-11-13 16:50:19,983 - INFO - 
6. Creando tabla de Excel con totales...
2025-11-13 16:50:19,983 - INFO - Creando tabla Excel 'TablaCartera' desde fila 6 hasta 214...
2025-11-13 16:50:19,983 - INFO - Rango de tabla: A6:AJ215
2025-11-13 16:50:19,984 - INFO - Fila de totales: 215
2025-11-13 16:50:19,984 - INFO - Nombres de columnas extraídos: 36
2025-11-13 16:50:19,984 - INFO -   Columna 6 'Monto del crédito': SUM
2025-11-13 16:50:19,984 - INFO -   Columna 13 'Pago Semanal': SUM
2025-11-13 16:50:19,984 - INFO -   Columna 15 'Cartera vigente sistema': SUM
2025-11-13 16:50:19,984 - INFO -   Columna 16 'Carera vigente inicial': SUM
2025-11-13 16:50:19,984 - INFO -   Columna 17 'Cartera vigente calculada': SUM
2025-11-13 16:50:19,985 - INFO -   Columna 18 'Cartera Insoluta': SUM
2025-11-13 16:50:19,985 - INFO -   Columna 19 'Diferencia Validación vigente': SUM
2025-11-13 16:50:19,985 - INFO -   Columna 20 'Ahorro Consumido': SUM
2025-11-13 16:50:19,985 - INFO -   Columna 21 'Cartera Vencida Estadistica': SUM
2025-11-13 16:50:19,985 - INFO -   Columna 22 'Cartera vencida Total': SUM
2025-11-13 16:50:19,985 - INFO -   Columna 24 'Saldo en riesgo': SUM
2025-11-13 16:50:19,985 - INFO -   Columna 25 'Saldo 
ahorro 
acumulado': SUM
2025-11-13 16:50:19,985 - INFO -   Columna 26 'Monto promedio del grupo': SUM
2025-11-13 16:50:19,985 - INFO -   Columna 33 'Ahorro Acumulado': SUM
2025-11-13 16:50:19,986 - INFO - Escribiendo fórmulas en fila de totales...
2025-11-13 16:50:19,986 - INFO -   Fórmula en columna 6: =SUBTOTAL(109,F7:F214)
2025-11-13 16:50:19,986 - INFO -   Fórmula en columna 13: =SUBTOTAL(109,M7:M214)
2025-11-13 16:50:19,986 - INFO -   Fórmula en columna 15: =SUBTOTAL(109,O7:O214)
2025-11-13 16:50:19,986 - INFO -   Fórmula en columna 16: =SUBTOTAL(109,P7:P214)
2025-11-13 16:50:19,986 - INFO -   Fórmula en columna 17: =SUBTOTAL(109,Q7:Q214)
2025-11-13 16:50:19,986 - INFO -   Fórmula en columna 18: =SUBTOTAL(109,R7:R214)
2025-11-13 16:50:19,986 - INFO -   Fórmula en columna 19: =SUBTOTAL(109,S7:S214)
2025-11-13 16:50:19,986 - INFO -   Fórmula en columna 20: =SUBTOTAL(109,T7:T214)
2025-11-13 16:50:19,986 - INFO -   Fórmula en columna 21: =SUBTOTAL(109,U7:U214)
2025-11-13 16:50:19,986 - INFO -   Fórmula en columna 22: =SUBTOTAL(109,V7:V214)
2025-11-13 16:50:19,986 - INFO -   Fórmula en columna 24: =SUBTOTAL(109,X7:X214)
2025-11-13 16:50:19,986 - INFO -   Fórmula en columna 25: =SUBTOTAL(109,Y7:Y214)
2025-11-13 16:50:19,986 - INFO -   Fórmula en columna 26: =SUBTOTAL(109,Z7:Z214)
2025-11-13 16:50:19,986 - INFO -   Fórmula en columna 33: =SUBTOTAL(109,AG7:AG214)
2025-11-13 16:50:19,987 - INFO - Tabla creada exitosamente con 208 filas de datos + fila totales
2025-11-13 16:50:19,987 - INFO - Totales configurados en 14 columnas con fórmulas SUBTOTAL
2025-11-13 16:50:19,987 - INFO - Fila de totales: Formato aplicado automáticamente por la tabla
2025-11-13 16:50:19,987 - INFO - 
7. Guardando archivo: output_automatizado.xlsx
2025-11-13 16:50:20,117 - INFO - 
================================================================================
2025-11-13 16:50:20,117 - INFO - ARCHIVO GUARDADO EXITOSAMENTE
2025-11-13 16:50:20,117 - INFO - ================================================================================
2025-11-13 16:50:20,117 - INFO - 
Archivo: output_automatizado.xlsx
2025-11-13 16:50:20,117 - INFO - Filas de datos: 208
2025-11-13 16:50:20,118 - INFO - Columnas: 36
2025-11-13 16:50:20,118 - INFO - Formato: Idéntico al machote
2025-11-13 16:50:20,118 - INFO - Tabla Excel: Con totales automáticos
2025-11-13 16:50:20,118 - INFO - ================================================================================
2025-11-13 16:50:20,118 - INFO - OK - Archivo guardado con formato: output_automatizado.xlsx
2025-11-13 16:50:20,118 - INFO - 
--- PASO 4: GENERACIÓN DE HOJA MORA ---
2025-11-13 16:50:20,118 - INFO - 
Iniciando generación de hoja MORA...
2025-11-13 16:50:20,119 - INFO - Registros con %mora > 5%: 7 de 208
2025-11-13 16:50:20,121 - INFO - Hoja MORA generada con 7 registros y 14 columnas
2025-11-13 16:50:20,121 - INFO - 
================================================================================
2025-11-13 16:50:20,121 - INFO - AGREGANDO HOJA MORA
2025-11-13 16:50:20,121 - INFO - ================================================================================
2025-11-13 16:50:20,121 - INFO - 
1. Abriendo archivo: output_automatizado.xlsx
2025-11-13 16:50:20,297 - INFO - 
2. Creando hoja 'Mora'
2025-11-13 16:50:20,297 - INFO - 
3. Copiando formato de headers desde plantilla
2025-11-13 16:50:20,318 - INFO - 
4. Estableciendo headers de MORA
2025-11-13 16:50:20,318 - INFO - 
5. Pegando 7 filas de datos
2025-11-13 16:50:20,320 - INFO - 
6. Creando tabla Excel con totales
2025-11-13 16:50:20,320 - INFO -    Creando tabla: A6:N14
2025-11-13 16:50:20,321 - INFO -    Tabla 'TablaMora' creada con totales automáticos
2025-11-13 16:50:20,321 - INFO -    Fórmulas SUBTOTAL escritas en 6 columnas
2025-11-13 16:50:20,321 - INFO - 
7. Guardando archivo con hoja MORA
2025-11-13 16:50:20,431 - INFO - 
================================================================================
2025-11-13 16:50:20,431 - INFO - HOJA MORA AGREGADA EXITOSAMENTE
2025-11-13 16:50:20,431 - INFO - ================================================================================
2025-11-13 16:50:20,431 - INFO - 
Registros en MORA: 7
2025-11-13 16:50:20,431 - INFO - Filtro: %mora > 5%
2025-11-13 16:50:20,431 - INFO - Columnas amarillas: %mora, Días de mora
2025-11-13 16:50:20,431 - INFO - ================================================================================
2025-11-13 16:50:20,431 - INFO - OK - Hoja MORA agregada con 7 registros
2025-11-13 16:50:20,432 - INFO - 
--- PASO 5: VALIDACIÓN ---
2025-11-13 16:50:20,432 - INFO - Machote no encontrado - validación omitida (no es necesario)
2025-11-13 16:50:20,433 - INFO - 
================================================================================
2025-11-13 16:50:20,433 - INFO - AUTOMATIZACIÓN COMPLETADA EXITOSAMENTE
2025-11-13 16:50:20,433 - INFO - ================================================================================
2025-11-13 16:54:01,761 - INFO - ================================================================================
2025-11-13 16:54:01,761 - INFO - INICIO DE AUTOMATIZACIÓN DE CARTERA
2025-11-13 16:54:01,761 - INFO - ================================================================================
2025-11-13 16:54:01,761 - INFO - 
--- PASO 0: BÚSQUEDA DE ARCHIVOS ---
2025-11-13 16:54:01,762 - INFO - Archivo encontrado: data\ReportedeAntiguedaddeCarteraGrupal_12112025.xlsx
2025-11-13 16:54:01,762 - INFO - Archivo encontrado: data\Situación_de_cartera_12112025.xlsx
2025-11-13 16:54:01,763 - INFO - Archivo encontrado: data\Cobranza_12112025.xlsx
2025-11-13 16:54:01,763 - INFO - Archivo encontrado: data/AHORROS.xlsx
2025-11-13 16:54:01,764 - INFO - 
--- PASO 1: CARGA DE ARCHIVOS ---
2025-11-13 16:54:01,764 - INFO - Cargando ANTIGÜEDAD desde: data\ReportedeAntiguedaddeCarteraGrupal_12112025.xlsx
2025-11-13 16:54:01,785 - INFO - Hoja detectada: '121125'
2025-11-13 16:54:01,951 - INFO - ANTIGÜEDAD cargado: (206, 59)
2025-11-13 16:54:01,951 - INFO - Columnas: ['cod_region', 'coordinacion', 'nombre_de_gerente', 'codigo_promotor', 'nombre_promotor', 'codigo_recuperador', 'nombre_recuperador', 'cod_grupo_solidario', 'ciclo', 'grupo_solidario']...
2025-11-13 16:54:01,952 - INFO - No se encontraron IDs duplicados
2025-11-13 16:54:01,952 - INFO - Cargando SITUACIÓN DE CARTERA desde: data\Situación_de_cartera_12112025.xlsx
2025-11-13 16:54:02,075 - INFO - SITUACIÓN DE CARTERA cargada: (206, 43)
2025-11-13 16:54:02,075 - INFO - Columnas: ['codigo_ofic_cred', 'nombre_oficial_de_credito', 'codigo_promotor_cred', 'nombre_promotor_cred', 'codigo_coord', 'nombre_coordinacion', 'codigo_ger_regi', 'nombre_gerencia_regional', 'nombre_codigo', 'nombre_acreditado_cliente']...
2025-11-13 16:54:02,076 - INFO - Columna de código renombrada: nombre_codigo -> codigo
2025-11-13 16:54:02,077 - INFO - Cargando REPORTE DE COBRANZA desde: data\Cobranza_12112025.xlsx
2025-11-13 16:54:02,279 - INFO - REPORTE DE COBRANZA cargado: (207, 68)
2025-11-13 16:54:02,279 - INFO - Columnas: ['regional', 'regional1', 'coordinacion', 'coordinacion1', 'de_credito', 'de_credito1', 'gpo', 'cliente_grupo', 'unnamed:_8', 'del_cliente']...
2025-11-13 16:54:02,280 - INFO - Cargando AHORROS (ACUMULADO) desde: data/AHORROS.xlsx
2025-11-13 16:54:02,324 - INFO - AHORROS cargado: (208, 4)
2025-11-13 16:54:02,324 - INFO - Columnas: ['id', 'grupo', 'ciclo', 'ahorro_acumulado']
2025-11-13 16:54:02,324 - INFO - PARCHE PROMOTORES cargado: 1 correcciones
2025-11-13 16:54:02,324 - INFO - 
--- PASO 2: GENERACIÓN DE CARTERA ---
2025-11-13 16:54:02,324 - INFO - Iniciando generación de cartera (VERSIÓN CORREGIDA)...
2025-11-13 16:54:02,325 - INFO - Registros en antiguedad: 206
2025-11-13 16:54:02,326 - INFO - ID de grupo generados: 0    000089
1    000145
2    000069
3    000079
4    000104
Name: id_de_grupo, dtype: object
2025-11-13 16:54:02,341 - INFO - Después de joins: 208 registros
2025-11-13 16:54:02,342 - INFO - NaN en situacion: 2
2025-11-13 16:54:02,342 - INFO - NaN en cobranza: 1
2025-11-13 16:54:02,343 - INFO - NaN en ahorros: 3
2025-11-13 16:54:02,344 - INFO - Parche aplicado: 1 correcciones
2025-11-13 16:54:02,346 - INFO - Estatus calculados: {'Vigente': 208}
2025-11-13 16:54:02,347 - INFO - Cartera vigente sistema calculada como: saldo_total (de ANTIGÜEDAD)
2025-11-13 16:54:02,362 - INFO - Cartera generada exitosamente: 208 filas x 36 columnas
2025-11-13 16:54:02,362 - INFO - 
--- PASO 3: GUARDADO DE RESULTADO CON FORMATO ---
2025-11-13 16:54:02,362 - INFO - ================================================================================
2025-11-13 16:54:02,362 - INFO - GUARDANDO DATAFRAME CON FORMATO
2025-11-13 16:54:02,362 - INFO - ================================================================================
2025-11-13 16:54:02,362 - INFO - 
1. Cargando plantilla de headers: plantilla/CARTERA_HEADERS.xlsx
2025-11-13 16:54:02,371 - INFO - Plantilla cargada: 6 filas x 36 columnas (6.1 KB)
2025-11-13 16:54:02,372 - INFO - 
2. Creando nuevo workbook...
2025-11-13 16:54:02,373 - INFO - 
3. Copiando headers desde plantilla...
2025-11-13 16:54:02,373 - INFO - Copiando headers (filas 1-6) con formato...
2025-11-13 16:54:02,412 - INFO - Headers copiados: 36 columnas
2025-11-13 16:54:02,412 - INFO - 
4. Pegando datos del DataFrame...
2025-11-13 16:54:02,412 - INFO - Pegando DataFrame (208 filas x 36 columnas) desde fila 7...
2025-11-13 16:54:02,453 - INFO - Datos pegados hasta fila 214
2025-11-13 16:54:02,453 - INFO - 
5. Formato de datos: Se aplicará automáticamente por la tabla Excel
2025-11-13 16:54:02,453 - INFO - 
6. Creando tabla de Excel con totales...
2025-11-13 16:54:02,453 - INFO - Creando tabla Excel 'TablaCartera' desde fila 6 hasta 214...
2025-11-13 16:54:02,453 - INFO - Rango de tabla: A6:AJ215
2025-11-13 16:54:02,453 - INFO - Fila de totales: 215
2025-11-13 16:54:02,453 - INFO - Nombres de columnas extraídos: 36
2025-11-13 16:54:02,453 - INFO -   Columna 6 'Monto del crédito': SUM
2025-11-13 16:54:02,454 - INFO -   Columna 13 'Pago Semanal': SUM
2025-11-13 16:54:02,454 - INFO -   Columna 15 'Cartera vigente sistema': SUM
2025-11-13 16:54:02,454 - INFO -   Columna 16 'Carera vigente inicial': SUM
2025-11-13 16:54:02,454 - INFO -   Columna 17 'Cartera vigente calculada': SUM
2025-11-13 16:54:02,454 - INFO -   Columna 18 'Cartera Insoluta': SUM
2025-11-13 16:54:02,454 - INFO -   Columna 19 'Diferencia Validación vigente': SUM
2025-11-13 16:54:02,454 - INFO -   Columna 20 'Ahorro Consumido': SUM
2025-11-13 16:54:02,454 - INFO -   Columna 21 'Cartera Vencida Estadistica': SUM
2025-11-13 16:54:02,455 - INFO -   Columna 22 'Cartera vencida Total': SUM
2025-11-13 16:54:02,455 - INFO -   Columna 24 'Saldo en riesgo': SUM
2025-11-13 16:54:02,455 - INFO -   Columna 25 'Saldo 
ahorro 
acumulado': SUM
2025-11-13 16:54:02,455 - INFO -   Columna 26 'Monto promedio del grupo': SUM
2025-11-13 16:54:02,455 - INFO -   Columna 33 'Ahorro Acumulado': SUM
2025-11-13 16:54:02,455 - INFO - Escribiendo fórmulas en fila de totales...
2025-11-13 16:54:02,455 - INFO -   Fórmula en columna 6: =SUBTOTAL(109,F7:F214)
2025-11-13 16:54:02,456 - INFO -   Fórmula en columna 13: =SUBTOTAL(109,M7:M214)
2025-11-13 16:54:02,456 - INFO -   Fórmula en columna 15: =SUBTOTAL(109,O7:O214)
2025-11-13 16:54:02,456 - INFO -   Fórmula en columna 16: =SUBTOTAL(109,P7:P214)
2025-11-13 16:54:02,456 - INFO -   Fórmula en columna 17: =SUBTOTAL(109,Q7:Q214)
2025-11-13 16:54:02,456 - INFO -   Fórmula en columna 18: =SUBTOTAL(109,R7:R214)
2025-11-13 16:54:02,456 - INFO -   Fórmula en columna 19: =SUBTOTAL(109,S7:S214)
2025-11-13 16:54:02,456 - INFO -   Fórmula en columna 20: =SUBTOTAL(109,T7:T214)
2025-11-13 16:54:02,456 - INFO -   Fórmula en columna 21: =SUBTOTAL(109,U7:U214)
2025-11-13 16:54:02,456 - INFO -   Fórmula en columna 22: =SUBTOTAL(109,V7:V214)
2025-11-13 16:54:02,456 - INFO -   Fórmula en columna 24: =SUBTOTAL(109,X7:X214)
2025-11-13 16:54:02,457 - INFO -   Fórmula en columna 25: =SUBTOTAL(109,Y7:Y214)
2025-11-13 16:54:02,457 - INFO -   Fórmula en columna 26: =SUBTOTAL(109,Z7:Z214)
2025-11-13 16:54:02,457 - INFO -   Fórmula en columna 33: =SUBTOTAL(109,AG7:AG214)
2025-11-13 16:54:02,457 - INFO - Tabla creada exitosamente con 208 filas de datos + fila totales
2025-11-13 16:54:02,457 - INFO - Totales configurados en 14 columnas con fórmulas SUBTOTAL
2025-11-13 16:54:02,457 - INFO - Filtros automáticos: Habilitados en la fila de encabezados
2025-11-13 16:54:02,457 - INFO - Fila de totales: Formato aplicado automáticamente por la tabla
2025-11-13 16:54:02,457 - INFO - 
6.1. Congelando paneles para mantener encabezados visibles...
2025-11-13 16:54:02,457 - INFO - Paneles congelados: Filas 1-6 siempre visibles
2025-11-13 16:54:02,457 - INFO - 
7. Guardando archivo: output_automatizado.xlsx
2025-11-13 16:54:02,579 - INFO - 
================================================================================
2025-11-13 16:54:02,579 - INFO - ARCHIVO GUARDADO EXITOSAMENTE
2025-11-13 16:54:02,579 - INFO - ================================================================================
2025-11-13 16:54:02,579 - INFO - 
Archivo: output_automatizado.xlsx
2025-11-13 16:54:02,579 - INFO - Filas de datos: 208
2025-11-13 16:54:02,579 - INFO - Columnas: 36
2025-11-13 16:54:02,579 - INFO - Formato: Idéntico al machote
2025-11-13 16:54:02,579 - INFO - Tabla Excel: Con totales automáticos y filtros
2025-11-13 16:54:02,579 - INFO - Encabezados: Siempre visibles (paneles congelados)
2025-11-13 16:54:02,579 - INFO - ================================================================================
2025-11-13 16:54:02,579 - INFO - OK - Archivo guardado con formato: output_automatizado.xlsx
2025-11-13 16:54:02,579 - INFO - 
--- PASO 4: GENERACIÓN DE HOJA MORA ---
2025-11-13 16:54:02,580 - INFO - 
Iniciando generación de hoja MORA...
2025-11-13 16:54:02,581 - INFO - Registros con %mora > 5%: 7 de 208
2025-11-13 16:54:02,584 - INFO - Hoja MORA generada con 7 registros y 14 columnas
2025-11-13 16:54:02,584 - INFO - 
================================================================================
2025-11-13 16:54:02,584 - INFO - AGREGANDO HOJA MORA
2025-11-13 16:54:02,584 - INFO - ================================================================================
2025-11-13 16:54:02,584 - INFO - 
1. Abriendo archivo: output_automatizado.xlsx
2025-11-13 16:54:02,754 - INFO - 
2. Creando hoja 'Mora'
2025-11-13 16:54:02,754 - INFO - 
3. Copiando formato de headers desde plantilla
2025-11-13 16:54:02,777 - INFO - 
4. Estableciendo headers de MORA
2025-11-13 16:54:02,778 - INFO - 
5. Pegando 7 filas de datos
2025-11-13 16:54:02,780 - INFO - 
6. Creando tabla Excel con totales
2025-11-13 16:54:02,780 - INFO -    Creando tabla: A6:N14
2025-11-13 16:54:02,780 - INFO -    Tabla 'TablaMora' creada con totales automáticos
2025-11-13 16:54:02,780 - INFO -    Filtros automáticos: Habilitados en la fila de encabezados
2025-11-13 16:54:02,780 - INFO -    Fórmulas SUBTOTAL escritas en 6 columnas
2025-11-13 16:54:02,781 - INFO - 
6.1. Congelando paneles para mantener encabezados visibles...
2025-11-13 16:54:02,781 - INFO - Paneles congelados: Filas 1-6 siempre visibles
2025-11-13 16:54:02,781 - INFO - 
7. Guardando archivo con hoja MORA
2025-11-13 16:54:02,953 - INFO - 
================================================================================
2025-11-13 16:54:02,953 - INFO - HOJA MORA AGREGADA EXITOSAMENTE
2025-11-13 16:54:02,953 - INFO - ================================================================================
2025-11-13 16:54:02,953 - INFO - 
Registros en MORA: 7
2025-11-13 16:54:02,953 - INFO - Filtro: %mora > 5%
2025-11-13 16:54:02,953 - INFO - Columnas amarillas: %mora, Días de mora
2025-11-13 16:54:02,953 - INFO - Tabla Excel: Con totales automáticos y filtros
2025-11-13 16:54:02,953 - INFO - Encabezados: Siempre visibles (paneles congelados)
2025-11-13 16:54:02,954 - INFO - ================================================================================
2025-11-13 16:54:02,954 - INFO - OK - Hoja MORA agregada con 7 registros
2025-11-13 16:54:02,954 - INFO - 
--- PASO 5: VALIDACIÓN ---
2025-11-13 16:54:02,954 - INFO - Machote no encontrado - validación omitida (no es necesario)
2025-11-13 16:54:02,954 - INFO - 
================================================================================
2025-11-13 16:54:02,954 - INFO - AUTOMATIZACIÓN COMPLETADA EXITOSAMENTE
2025-11-13 16:54:02,955 - INFO - ================================================================================
2025-11-13 16:57:52,228 - INFO - ================================================================================
2025-11-13 16:57:52,228 - INFO - INICIO DE AUTOMATIZACIÓN DE CARTERA
2025-11-13 16:57:52,228 - INFO - ================================================================================
2025-11-13 16:57:52,228 - INFO - 
--- PASO 0: BÚSQUEDA DE ARCHIVOS ---
2025-11-13 16:57:52,229 - INFO - Archivo encontrado: data\ReportedeAntiguedaddeCarteraGrupal_12112025.xlsx
2025-11-13 16:57:52,230 - INFO - Archivo encontrado: data\Situación_de_cartera_12112025.xlsx
2025-11-13 16:57:52,230 - INFO - Archivo encontrado: data\Cobranza_12112025.xlsx
2025-11-13 16:57:52,231 - INFO - Archivo encontrado: data/AHORROS.xlsx
2025-11-13 16:57:52,231 - INFO - 
--- PASO 1: CARGA DE ARCHIVOS ---
2025-11-13 16:57:52,231 - INFO - Cargando ANTIGÜEDAD desde: data\ReportedeAntiguedaddeCarteraGrupal_12112025.xlsx
2025-11-13 16:57:52,261 - INFO - Hoja detectada: '121125'
2025-11-13 16:57:52,439 - INFO - ANTIGÜEDAD cargado: (206, 59)
2025-11-13 16:57:52,439 - INFO - Columnas: ['cod_region', 'coordinacion', 'nombre_de_gerente', 'codigo_promotor', 'nombre_promotor', 'codigo_recuperador', 'nombre_recuperador', 'cod_grupo_solidario', 'ciclo', 'grupo_solidario']...
2025-11-13 16:57:52,440 - INFO - No se encontraron IDs duplicados
2025-11-13 16:57:52,440 - INFO - Cargando SITUACIÓN DE CARTERA desde: data\Situación_de_cartera_12112025.xlsx
2025-11-13 16:57:52,586 - INFO - SITUACIÓN DE CARTERA cargada: (206, 43)
2025-11-13 16:57:52,586 - INFO - Columnas: ['codigo_ofic_cred', 'nombre_oficial_de_credito', 'codigo_promotor_cred', 'nombre_promotor_cred', 'codigo_coord', 'nombre_coordinacion', 'codigo_ger_regi', 'nombre_gerencia_regional', 'nombre_codigo', 'nombre_acreditado_cliente']...
2025-11-13 16:57:52,586 - INFO - Columna de código renombrada: nombre_codigo -> codigo
2025-11-13 16:57:52,588 - INFO - Cargando REPORTE DE COBRANZA desde: data\Cobranza_12112025.xlsx
2025-11-13 16:57:52,797 - INFO - REPORTE DE COBRANZA cargado: (207, 68)
2025-11-13 16:57:52,798 - INFO - Columnas: ['regional', 'regional1', 'coordinacion', 'coordinacion1', 'de_credito', 'de_credito1', 'gpo', 'cliente_grupo', 'unnamed:_8', 'del_cliente']...
2025-11-13 16:57:52,798 - INFO - Cargando AHORROS (ACUMULADO) desde: data/AHORROS.xlsx
2025-11-13 16:57:52,843 - INFO - AHORROS cargado: (208, 4)
2025-11-13 16:57:52,843 - INFO - Columnas: ['id', 'grupo', 'ciclo', 'ahorro_acumulado']
2025-11-13 16:57:52,844 - INFO - PARCHE PROMOTORES cargado: 1 correcciones
2025-11-13 16:57:52,844 - INFO - 
--- PASO 2: GENERACIÓN DE CARTERA ---
2025-11-13 16:57:52,844 - INFO - Iniciando generación de cartera (VERSIÓN CORREGIDA)...
2025-11-13 16:57:52,844 - INFO - Registros en antiguedad: 206
2025-11-13 16:57:52,847 - INFO - ID de grupo generados: 0    000089
1    000145
2    000069
3    000079
4    000104
Name: id_de_grupo, dtype: object
2025-11-13 16:57:52,862 - INFO - Después de joins: 208 registros
2025-11-13 16:57:52,863 - INFO - NaN en situacion: 2
2025-11-13 16:57:52,863 - INFO - NaN en cobranza: 1
2025-11-13 16:57:52,864 - INFO - NaN en ahorros: 3
2025-11-13 16:57:52,865 - INFO - Parche aplicado: 1 correcciones
2025-11-13 16:57:52,867 - INFO - Estatus calculados: {'Vigente': 208}
2025-11-13 16:57:52,868 - INFO - Cartera vigente sistema calculada como: saldo_total (de ANTIGÜEDAD)
2025-11-13 16:57:52,887 - INFO - Cartera generada exitosamente: 208 filas x 36 columnas
2025-11-13 16:57:52,887 - INFO - 
--- PASO 3: GUARDADO DE RESULTADO CON FORMATO ---
2025-11-13 16:57:52,887 - INFO - ================================================================================
2025-11-13 16:57:52,887 - INFO - GUARDANDO DATAFRAME CON FORMATO
2025-11-13 16:57:52,887 - INFO - ================================================================================
2025-11-13 16:57:52,887 - INFO - 
1. Cargando plantilla de headers: plantilla/CARTERA_HEADERS.xlsx
2025-11-13 16:57:52,899 - INFO - Plantilla cargada: 6 filas x 36 columnas (6.1 KB)
2025-11-13 16:57:52,900 - INFO - 
2. Creando nuevo workbook...
2025-11-13 16:57:52,901 - INFO - 
3. Copiando headers desde plantilla...
2025-11-13 16:57:52,901 - INFO - Copiando headers (filas 1-6) con formato...
2025-11-13 16:57:52,947 - INFO - Headers copiados: 36 columnas
2025-11-13 16:57:52,947 - INFO - 
4. Pegando datos del DataFrame...
2025-11-13 16:57:52,947 - INFO - Pegando DataFrame (208 filas x 36 columnas) desde fila 7...
2025-11-13 16:57:52,991 - INFO - Datos pegados hasta fila 214
2025-11-13 16:57:52,992 - INFO - 
5. Formato de datos: Se aplicará automáticamente por la tabla Excel
2025-11-13 16:57:52,992 - INFO - 
6. Creando tabla de Excel con totales...
2025-11-13 16:57:52,992 - INFO - Creando tabla Excel 'TablaCartera' desde fila 6 hasta 214...
2025-11-13 16:57:52,992 - INFO - Rango de tabla: A6:AJ215
2025-11-13 16:57:52,992 - INFO - Fila de totales: 215
2025-11-13 16:57:52,992 - INFO - Nombres de columnas extraídos: 36
2025-11-13 16:57:52,992 - INFO -   Columna 6 'Monto del crédito': SUM
2025-11-13 16:57:52,993 - INFO -   Columna 13 'Pago Semanal': SUM
2025-11-13 16:57:52,993 - INFO -   Columna 15 'Cartera vigente sistema': SUM
2025-11-13 16:57:52,993 - INFO -   Columna 16 'Carera vigente inicial': SUM
2025-11-13 16:57:52,993 - INFO -   Columna 17 'Cartera vigente calculada': SUM
2025-11-13 16:57:52,993 - INFO -   Columna 18 'Cartera Insoluta': SUM
2025-11-13 16:57:52,993 - INFO -   Columna 19 'Diferencia Validación vigente': SUM
2025-11-13 16:57:52,993 - INFO -   Columna 20 'Ahorro Consumido': SUM
2025-11-13 16:57:52,993 - INFO -   Columna 21 'Cartera Vencida Estadistica': SUM
2025-11-13 16:57:52,993 - INFO -   Columna 22 'Cartera vencida Total': SUM
2025-11-13 16:57:52,993 - INFO -   Columna 24 'Saldo en riesgo': SUM
2025-11-13 16:57:52,994 - INFO -   Columna 25 'Saldo 
ahorro 
acumulado': SUM
2025-11-13 16:57:52,994 - INFO -   Columna 26 'Monto promedio del grupo': SUM
2025-11-13 16:57:52,994 - INFO -   Columna 33 'Ahorro Acumulado': SUM
2025-11-13 16:57:52,994 - INFO - Filtros automáticos habilitados en rango: A6:AJ6
2025-11-13 16:57:52,994 - INFO - Escribiendo fórmulas en fila de totales...
2025-11-13 16:57:52,994 - INFO -   Fórmula en columna 6: =SUBTOTAL(109,F7:F214)
2025-11-13 16:57:52,994 - INFO -   Fórmula en columna 13: =SUBTOTAL(109,M7:M214)
2025-11-13 16:57:52,994 - INFO -   Fórmula en columna 15: =SUBTOTAL(109,O7:O214)
2025-11-13 16:57:52,994 - INFO -   Fórmula en columna 16: =SUBTOTAL(109,P7:P214)
2025-11-13 16:57:52,995 - INFO -   Fórmula en columna 17: =SUBTOTAL(109,Q7:Q214)
2025-11-13 16:57:52,995 - INFO -   Fórmula en columna 18: =SUBTOTAL(109,R7:R214)
2025-11-13 16:57:52,995 - INFO -   Fórmula en columna 19: =SUBTOTAL(109,S7:S214)
2025-11-13 16:57:52,995 - INFO -   Fórmula en columna 20: =SUBTOTAL(109,T7:T214)
2025-11-13 16:57:52,995 - INFO -   Fórmula en columna 21: =SUBTOTAL(109,U7:U214)
2025-11-13 16:57:52,995 - INFO -   Fórmula en columna 22: =SUBTOTAL(109,V7:V214)
2025-11-13 16:57:52,996 - INFO -   Fórmula en columna 24: =SUBTOTAL(109,X7:X214)
2025-11-13 16:57:52,996 - INFO -   Fórmula en columna 25: =SUBTOTAL(109,Y7:Y214)
2025-11-13 16:57:52,996 - INFO -   Fórmula en columna 26: =SUBTOTAL(109,Z7:Z214)
2025-11-13 16:57:52,996 - INFO -   Fórmula en columna 33: =SUBTOTAL(109,AG7:AG214)
2025-11-13 16:57:52,996 - INFO - Tabla creada exitosamente con 208 filas de datos + fila totales
2025-11-13 16:57:52,996 - INFO - Totales configurados en 14 columnas con fórmulas SUBTOTAL
2025-11-13 16:57:52,997 - INFO - Fila de totales: Formato aplicado automáticamente por la tabla
2025-11-13 16:57:52,997 - INFO - 
6.1. Congelando paneles para mantener encabezados visibles...
2025-11-13 16:57:52,997 - INFO - Paneles congelados: Filas 1-6 siempre visibles
2025-11-13 16:57:52,997 - INFO - 
7. Guardando archivo: output_automatizado.xlsx
2025-11-13 16:57:53,141 - INFO - 
================================================================================
2025-11-13 16:57:53,141 - INFO - ARCHIVO GUARDADO EXITOSAMENTE
2025-11-13 16:57:53,142 - INFO - ================================================================================
2025-11-13 16:57:53,142 - INFO - 
Archivo: output_automatizado.xlsx
2025-11-13 16:57:53,142 - INFO - Filas de datos: 208
2025-11-13 16:57:53,142 - INFO - Columnas: 36
2025-11-13 16:57:53,142 - INFO - Formato: Idéntico al machote
2025-11-13 16:57:53,142 - INFO - Tabla Excel: Con totales automáticos y filtros
2025-11-13 16:57:53,142 - INFO - Encabezados: Siempre visibles (paneles congelados)
2025-11-13 16:57:53,142 - INFO - ================================================================================
2025-11-13 16:57:53,142 - INFO - OK - Archivo guardado con formato: output_automatizado.xlsx
2025-11-13 16:57:53,142 - INFO - 
--- PASO 4: GENERACIÓN DE HOJA MORA ---
2025-11-13 16:57:53,142 - INFO - 
Iniciando generación de hoja MORA...
2025-11-13 16:57:53,144 - INFO - Registros con %mora > 5%: 7 de 208
2025-11-13 16:57:53,147 - INFO - Hoja MORA generada con 7 registros y 14 columnas
2025-11-13 16:57:53,147 - INFO - 
================================================================================
2025-11-13 16:57:53,147 - INFO - AGREGANDO HOJA MORA
2025-11-13 16:57:53,147 - INFO - ================================================================================
2025-11-13 16:57:53,147 - INFO - 
1. Abriendo archivo: output_automatizado.xlsx
2025-11-13 16:57:53,341 - INFO - 
2. Creando hoja 'Mora'
2025-11-13 16:57:53,341 - INFO - 
3. Copiando formato de headers desde plantilla
2025-11-13 16:57:53,363 - INFO - 
4. Estableciendo headers de MORA
2025-11-13 16:57:53,364 - INFO - 
5. Pegando 7 filas de datos
2025-11-13 16:57:53,366 - INFO - 
6. Creando tabla Excel con totales
2025-11-13 16:57:53,366 - INFO -    Creando tabla: A6:N14
2025-11-13 16:57:53,367 - INFO -    Tabla 'TablaMora' creada con totales automáticos
2025-11-13 16:57:53,367 - INFO -    Filtros automáticos habilitados en rango: A6:N6
2025-11-13 16:57:53,367 - INFO -    Fórmulas SUBTOTAL escritas en 6 columnas
2025-11-13 16:57:53,367 - INFO - 
6.1. Congelando paneles para mantener encabezados visibles...
2025-11-13 16:57:53,367 - INFO - Paneles congelados: Filas 1-6 siempre visibles
2025-11-13 16:57:53,367 - INFO - 
7. Guardando archivo con hoja MORA
2025-11-13 16:57:53,523 - INFO - 
================================================================================
2025-11-13 16:57:53,523 - INFO - HOJA MORA AGREGADA EXITOSAMENTE
2025-11-13 16:57:53,523 - INFO - ================================================================================
2025-11-13 16:57:53,523 - INFO - 
Registros en MORA: 7
2025-11-13 16:57:53,523 - INFO - Filtro: %mora > 5%
2025-11-13 16:57:53,523 - INFO - Columnas amarillas: %mora, Días de mora
2025-11-13 16:57:53,523 - INFO - Tabla Excel: Con totales automáticos y filtros
2025-11-13 16:57:53,524 - INFO - Encabezados: Siempre visibles (paneles congelados)
2025-11-13 16:57:53,524 - INFO - ================================================================================
2025-11-13 16:57:53,524 - INFO - OK - Hoja MORA agregada con 7 registros
2025-11-13 16:57:53,524 - INFO - 
--- PASO 5: VALIDACIÓN ---
2025-11-13 16:57:53,525 - INFO - Machote no encontrado - validación omitida (no es necesario)
2025-11-13 16:57:53,525 - INFO - 
================================================================================
2025-11-13 16:57:53,525 - INFO - AUTOMATIZACIÓN COMPLETADA EXITOSAMENTE
2025-11-13 16:57:53,525 - INFO - ================================================================================
2025-11-13 17:04:28,896 - INFO - Cargando ANTIGÜEDAD desde: data\ReportedeAntiguedaddeCarteraGrupal_12112025.xlsx
2025-11-13 17:04:28,916 - INFO - Hoja detectada: '121125'
2025-11-13 17:04:29,071 - INFO - ANTIGÜEDAD cargado: (206, 59)
2025-11-13 17:04:29,071 - INFO - Columnas: ['cod_region', 'coordinacion', 'nombre_de_gerente', 'codigo_promotor', 'nombre_promotor', 'codigo_recuperador', 'nombre_recuperador', 'cod_grupo_solidario', 'ciclo', 'grupo_solidario']...
2025-11-13 17:04:29,072 - INFO - No se encontraron IDs duplicados
2025-11-13 17:04:29,072 - INFO - Cargando SITUACIÓN DE CARTERA desde: data\Situación_de_cartera_12112025.xlsx
2025-11-13 17:04:29,205 - INFO - SITUACIÓN DE CARTERA cargada: (206, 43)
2025-11-13 17:04:29,205 - INFO - Columnas: ['codigo_ofic_cred', 'nombre_oficial_de_credito', 'codigo_promotor_cred', 'nombre_promotor_cred', 'codigo_coord', 'nombre_coordinacion', 'codigo_ger_regi', 'nombre_gerencia_regional', 'nombre_codigo', 'nombre_acreditado_cliente']...
2025-11-13 17:04:29,206 - INFO - Columna de código renombrada: nombre_codigo -> codigo
2025-11-13 17:04:29,207 - INFO - Cargando REPORTE DE COBRANZA desde: data\Cobranza_12112025.xlsx
2025-11-13 17:04:29,390 - INFO - REPORTE DE COBRANZA cargado: (207, 68)
2025-11-13 17:04:29,390 - INFO - Columnas: ['regional', 'regional1', 'coordinacion', 'coordinacion1', 'de_credito', 'de_credito1', 'gpo', 'cliente_grupo', 'unnamed:_8', 'del_cliente']...
2025-11-13 17:04:29,390 - INFO - Cargando AHORROS (ACUMULADO) desde: data/AHORROS.xlsx
2025-11-13 17:04:29,428 - INFO - AHORROS cargado: (208, 4)
2025-11-13 17:04:29,428 - INFO - Columnas: ['id', 'grupo', 'ciclo', 'ahorro_acumulado']
2025-11-13 17:04:29,429 - INFO - Iniciando generación de cartera (VERSIÓN CORREGIDA)...
2025-11-13 17:04:29,429 - INFO - Registros en antiguedad: 206
2025-11-13 17:04:29,431 - INFO - ID de grupo generados: 0    000089
1    000145
2    000069
3    000079
4    000104
Name: id_de_grupo, dtype: object
2025-11-13 17:04:29,446 - INFO - Después de joins: 208 registros
2025-11-13 17:04:29,447 - INFO - NaN en situacion: 2
2025-11-13 17:04:29,447 - INFO - NaN en cobranza: 1
2025-11-13 17:04:29,447 - INFO - NaN en ahorros: 3
2025-11-13 17:04:29,449 - INFO - Parche aplicado: 1 correcciones
2025-11-13 17:04:29,452 - INFO - Estatus calculados: {'Vigente': 208}
2025-11-13 17:04:29,453 - INFO - Cartera vigente sistema calculada como: saldo_total (de ANTIGÜEDAD)
2025-11-13 17:04:29,466 - INFO - Cartera generada exitosamente: 208 filas x 36 columnas
2025-11-13 17:05:08,875 - INFO - Cargando ANTIGÜEDAD desde: data\ReportedeAntiguedaddeCarteraGrupal_12112025.xlsx
2025-11-13 17:05:08,894 - INFO - Hoja detectada: '121125'
2025-11-13 17:05:09,048 - INFO - ANTIGÜEDAD cargado: (206, 59)
2025-11-13 17:05:09,048 - INFO - Columnas: ['cod_region', 'coordinacion', 'nombre_de_gerente', 'codigo_promotor', 'nombre_promotor', 'codigo_recuperador', 'nombre_recuperador', 'cod_grupo_solidario', 'ciclo', 'grupo_solidario']...
2025-11-13 17:05:09,049 - INFO - No se encontraron IDs duplicados
2025-11-13 17:05:09,049 - INFO - Cargando SITUACIÓN DE CARTERA desde: data\Situación_de_cartera_12112025.xlsx
2025-11-13 17:05:09,169 - INFO - SITUACIÓN DE CARTERA cargada: (206, 43)
2025-11-13 17:05:09,169 - INFO - Columnas: ['codigo_ofic_cred', 'nombre_oficial_de_credito', 'codigo_promotor_cred', 'nombre_promotor_cred', 'codigo_coord', 'nombre_coordinacion', 'codigo_ger_regi', 'nombre_gerencia_regional', 'nombre_codigo', 'nombre_acreditado_cliente']...
2025-11-13 17:05:09,170 - INFO - Columna de código renombrada: nombre_codigo -> codigo
2025-11-13 17:05:09,172 - INFO - Cargando REPORTE DE COBRANZA desde: data\Cobranza_12112025.xlsx
2025-11-13 17:05:09,360 - INFO - REPORTE DE COBRANZA cargado: (207, 68)
2025-11-13 17:05:09,360 - INFO - Columnas: ['regional', 'regional1', 'coordinacion', 'coordinacion1', 'de_credito', 'de_credito1', 'gpo', 'cliente_grupo', 'unnamed:_8', 'del_cliente']...
2025-11-13 17:05:09,361 - INFO - Cargando AHORROS (ACUMULADO) desde: data/AHORROS.xlsx
2025-11-13 17:05:09,400 - INFO - AHORROS cargado: (208, 4)
2025-11-13 17:05:09,400 - INFO - Columnas: ['id', 'grupo', 'ciclo', 'ahorro_acumulado']
2025-11-13 17:05:09,400 - INFO - Iniciando generación de cartera (VERSIÓN CORREGIDA)...
2025-11-13 17:05:09,401 - INFO - Registros en antiguedad: 206
2025-11-13 17:05:09,402 - INFO - ID de grupo generados: 0    000089
1    000145
2    000069
3    000079
4    000104
Name: id_de_grupo, dtype: object
2025-11-13 17:05:09,419 - INFO - Después de joins: 208 registros
2025-11-13 17:05:09,420 - INFO - NaN en situacion: 2
2025-11-13 17:05:09,420 - INFO - NaN en cobranza: 1
2025-11-13 17:05:09,420 - INFO - NaN en ahorros: 3
2025-11-13 17:05:09,422 - INFO - Parche aplicado: 1 correcciones
2025-11-13 17:05:09,424 - INFO - Estatus calculados: {'Vigente': 208}
2025-11-13 17:05:09,425 - INFO - Cartera vigente sistema calculada como: saldo_total (de ANTIGÜEDAD)
2025-11-13 17:05:09,441 - INFO - Cartera generada exitosamente: 208 filas x 36 columnas
2025-11-13 17:05:34,018 - INFO - ================================================================================
2025-11-13 17:05:34,018 - INFO - INICIO DE AUTOMATIZACIÓN DE CARTERA
2025-11-13 17:05:34,018 - INFO - ================================================================================
2025-11-13 17:05:34,018 - INFO - 
--- PASO 0: BÚSQUEDA DE ARCHIVOS ---
2025-11-13 17:05:34,018 - INFO - Archivo encontrado: data\ReportedeAntiguedaddeCarteraGrupal_12112025.xlsx
2025-11-13 17:05:34,019 - INFO - Archivo encontrado: data\Situación_de_cartera_12112025.xlsx
2025-11-13 17:05:34,019 - INFO - Archivo encontrado: data\Cobranza_12112025.xlsx
2025-11-13 17:05:34,020 - INFO - Archivo encontrado: data/AHORROS.xlsx
2025-11-13 17:05:34,020 - INFO - 
--- PASO 1: CARGA DE ARCHIVOS ---
2025-11-13 17:05:34,020 - INFO - Cargando ANTIGÜEDAD desde: data\ReportedeAntiguedaddeCarteraGrupal_12112025.xlsx
2025-11-13 17:05:34,040 - INFO - Hoja detectada: '121125'
2025-11-13 17:05:34,221 - INFO - ANTIGÜEDAD cargado: (206, 59)
2025-11-13 17:05:34,221 - INFO - Columnas: ['cod_region', 'coordinacion', 'nombre_de_gerente', 'codigo_promotor', 'nombre_promotor', 'codigo_recuperador', 'nombre_recuperador', 'cod_grupo_solidario', 'ciclo', 'grupo_solidario']...
2025-11-13 17:05:34,222 - INFO - No se encontraron IDs duplicados
2025-11-13 17:05:34,222 - INFO - Cargando SITUACIÓN DE CARTERA desde: data\Situación_de_cartera_12112025.xlsx
2025-11-13 17:05:34,333 - INFO - SITUACIÓN DE CARTERA cargada: (206, 43)
2025-11-13 17:05:34,333 - INFO - Columnas: ['codigo_ofic_cred', 'nombre_oficial_de_credito', 'codigo_promotor_cred', 'nombre_promotor_cred', 'codigo_coord', 'nombre_coordinacion', 'codigo_ger_regi', 'nombre_gerencia_regional', 'nombre_codigo', 'nombre_acreditado_cliente']...
2025-11-13 17:05:34,334 - INFO - Columna de código renombrada: nombre_codigo -> codigo
2025-11-13 17:05:34,335 - INFO - Cargando REPORTE DE COBRANZA desde: data\Cobranza_12112025.xlsx
2025-11-13 17:05:34,516 - INFO - REPORTE DE COBRANZA cargado: (207, 68)
2025-11-13 17:05:34,517 - INFO - Columnas: ['regional', 'regional1', 'coordinacion', 'coordinacion1', 'de_credito', 'de_credito1', 'gpo', 'cliente_grupo', 'unnamed:_8', 'del_cliente']...
2025-11-13 17:05:34,517 - INFO - Cargando AHORROS (ACUMULADO) desde: data/AHORROS.xlsx
2025-11-13 17:05:34,555 - INFO - AHORROS cargado: (208, 4)
2025-11-13 17:05:34,555 - INFO - Columnas: ['id', 'grupo', 'ciclo', 'ahorro_acumulado']
2025-11-13 17:05:34,556 - INFO - PARCHE PROMOTORES cargado: 1 correcciones
2025-11-13 17:05:34,556 - INFO - 
--- PASO 2: GENERACIÓN DE CARTERA ---
2025-11-13 17:05:34,556 - INFO - Iniciando generación de cartera (VERSIÓN CORREGIDA)...
2025-11-13 17:05:34,556 - INFO - Registros en antiguedad: 206
2025-11-13 17:05:34,559 - INFO - ID de grupo generados: 0    000089
1    000145
2    000069
3    000079
4    000104
Name: id_de_grupo, dtype: object
2025-11-13 17:05:34,574 - INFO - Después de joins: 208 registros
2025-11-13 17:05:34,575 - INFO - NaN en situacion: 2
2025-11-13 17:05:34,575 - INFO - NaN en cobranza: 1
2025-11-13 17:05:34,576 - INFO - NaN en ahorros: 3
2025-11-13 17:05:34,578 - INFO - Parche aplicado: 1 correcciones
2025-11-13 17:05:34,580 - INFO - Estatus calculados: {'Vigente': 208}
2025-11-13 17:05:34,581 - INFO - Cartera vigente sistema calculada como: saldo_total (de ANTIGÜEDAD)
2025-11-13 17:05:34,595 - INFO - Cartera generada exitosamente: 208 filas x 36 columnas
2025-11-13 17:05:34,595 - INFO - 
--- PASO 3: GUARDADO DE RESULTADO CON FORMATO ---
2025-11-13 17:05:34,595 - INFO - ================================================================================
2025-11-13 17:05:34,595 - INFO - GUARDANDO DATAFRAME CON FORMATO
2025-11-13 17:05:34,595 - INFO - ================================================================================
2025-11-13 17:05:34,596 - INFO - 
1. Cargando plantilla de headers: plantilla/CARTERA_HEADERS.xlsx
2025-11-13 17:05:34,604 - INFO - Plantilla cargada: 6 filas x 36 columnas (6.1 KB)
2025-11-13 17:05:34,604 - INFO - 
2. Creando nuevo workbook...
2025-11-13 17:05:34,605 - INFO - 
3. Copiando headers desde plantilla...
2025-11-13 17:05:34,605 - INFO - Copiando headers (filas 1-6) con formato...
2025-11-13 17:05:34,647 - INFO - Headers copiados: 36 columnas
2025-11-13 17:05:34,647 - INFO - 
4. Pegando datos del DataFrame...
2025-11-13 17:05:34,647 - INFO - Pegando DataFrame (208 filas x 36 columnas) desde fila 7...
2025-11-13 17:05:34,688 - INFO - Datos pegados hasta fila 214
2025-11-13 17:05:34,688 - INFO - 
5. Formato de datos: Se aplicará automáticamente por la tabla Excel
2025-11-13 17:05:34,688 - INFO - 
6. Creando tabla de Excel con totales...
2025-11-13 17:05:34,688 - INFO - Creando tabla Excel 'TablaCartera' desde fila 6 hasta 214...
2025-11-13 17:05:34,688 - INFO - Rango de tabla: A6:AJ215
2025-11-13 17:05:34,688 - INFO - Fila de totales: 215
2025-11-13 17:05:34,688 - INFO - Nombres de columnas extraídos: 36
2025-11-13 17:05:34,689 - INFO -   Columna 6 'Monto del crédito': SUM
2025-11-13 17:05:34,689 - INFO -   Columna 13 'Pago Semanal': SUM
2025-11-13 17:05:34,689 - INFO -   Columna 15 'Cartera vigente sistema': SUM
2025-11-13 17:05:34,689 - INFO -   Columna 16 'Carera vigente inicial': SUM
2025-11-13 17:05:34,689 - INFO -   Columna 17 'Cartera vigente calculada': SUM
2025-11-13 17:05:34,689 - INFO -   Columna 18 'Cartera Insoluta': SUM
2025-11-13 17:05:34,690 - INFO -   Columna 19 'Diferencia Validación vigente': SUM
2025-11-13 17:05:34,690 - INFO -   Columna 20 'Ahorro Consumido': SUM
2025-11-13 17:05:34,690 - INFO -   Columna 21 'Cartera Vencida Estadistica': SUM
2025-11-13 17:05:34,690 - INFO -   Columna 22 'Cartera vencida Total': SUM
2025-11-13 17:05:34,690 - INFO -   Columna 24 'Saldo en riesgo': SUM
2025-11-13 17:05:34,690 - INFO -   Columna 25 'Saldo 
ahorro 
acumulado': SUM
2025-11-13 17:05:34,690 - INFO -   Columna 26 'Monto promedio del grupo': SUM
2025-11-13 17:05:34,690 - INFO -   Columna 33 'Ahorro Acumulado': SUM
2025-11-13 17:05:34,691 - INFO - Filtros automáticos habilitados en rango: A6:AJ6
2025-11-13 17:05:34,691 - INFO - Escribiendo fórmulas en fila de totales...
2025-11-13 17:05:34,691 - INFO -   Fórmula en columna 6: =SUBTOTAL(109,F7:F214)
2025-11-13 17:05:34,691 - INFO -   Fórmula en columna 13: =SUBTOTAL(109,M7:M214)
2025-11-13 17:05:34,691 - INFO -   Fórmula en columna 15: =SUBTOTAL(109,O7:O214)
2025-11-13 17:05:34,691 - INFO -   Fórmula en columna 16: =SUBTOTAL(109,P7:P214)
2025-11-13 17:05:34,691 - INFO -   Fórmula en columna 17: =SUBTOTAL(109,Q7:Q214)
2025-11-13 17:05:34,692 - INFO -   Fórmula en columna 18: =SUBTOTAL(109,R7:R214)
2025-11-13 17:05:34,692 - INFO -   Fórmula en columna 19: =SUBTOTAL(109,S7:S214)
2025-11-13 17:05:34,692 - INFO -   Fórmula en columna 20: =SUBTOTAL(109,T7:T214)
2025-11-13 17:05:34,692 - INFO -   Fórmula en columna 21: =SUBTOTAL(109,U7:U214)
2025-11-13 17:05:34,692 - INFO -   Fórmula en columna 22: =SUBTOTAL(109,V7:V214)
2025-11-13 17:05:34,692 - INFO -   Fórmula en columna 24: =SUBTOTAL(109,X7:X214)
2025-11-13 17:05:34,692 - INFO -   Fórmula en columna 25: =SUBTOTAL(109,Y7:Y214)
2025-11-13 17:05:34,692 - INFO -   Fórmula en columna 26: =SUBTOTAL(109,Z7:Z214)
2025-11-13 17:05:34,692 - INFO -   Fórmula en columna 33: =SUBTOTAL(109,AG7:AG214)
2025-11-13 17:05:34,692 - INFO - Tabla creada exitosamente con 208 filas de datos + fila totales
2025-11-13 17:05:34,692 - INFO - Totales configurados en 14 columnas con fórmulas SUBTOTAL
2025-11-13 17:05:34,692 - INFO - Fila de totales: Formato aplicado automáticamente por la tabla
2025-11-13 17:05:34,692 - INFO - 
6.1. Congelando paneles para mantener encabezados visibles...
2025-11-13 17:05:34,692 - INFO - Paneles congelados: Filas 1-6 siempre visibles
2025-11-13 17:05:34,693 - INFO - 
7. Guardando archivo: output_automatizado.xlsx
2025-11-13 17:05:34,693 - ERROR - 
ERROR: [Errno 13] Permission denied: 'output_automatizado.xlsx'
Traceback (most recent call last):
  File "C:\Users\uzzie\Documents\Jale\merge-dataframes\analizar_y_automatizar.py", line 314, in main
    guardar_con_formato(df_cartera, RUTA_PLANTILLA, RUTA_OUTPUT)
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\uzzie\Documents\Jale\merge-dataframes\formato_excel.py", line 316, in guardar_con_formato
    wb_nuevo.save(ruta_output)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\uzzie\miniconda3\Lib\site-packages\openpyxl\workbook\workbook.py", line 386, in save
    save_workbook(self, filename)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "C:\Users\uzzie\miniconda3\Lib\site-packages\openpyxl\writer\excel.py", line 291, in save_workbook
    archive = ZipFile(filename, 'w', ZIP_DEFLATED, allowZip64=True)
  File "C:\Users\uzzie\miniconda3\Lib\zipfile\__init__.py", line 1367, in __init__
    self.fp = io.open(file, filemode)
              ~~~~~~~^^^^^^^^^^^^^^^^
PermissionError: [Errno 13] Permission denied: 'output_automatizado.xlsx'
2025-11-13 17:06:23,587 - INFO - ================================================================================
2025-11-13 17:06:23,587 - INFO - INICIO DE AUTOMATIZACIÓN DE CARTERA
2025-11-13 17:06:23,587 - INFO - ================================================================================
2025-11-13 17:06:23,587 - INFO - 
--- PASO 0: BÚSQUEDA DE ARCHIVOS ---
2025-11-13 17:06:23,588 - INFO - Archivo encontrado: data\ReportedeAntiguedaddeCarteraGrupal_12112025.xlsx
2025-11-13 17:06:23,588 - INFO - Archivo encontrado: data\Situación_de_cartera_12112025.xlsx
2025-11-13 17:06:23,589 - INFO - Archivo encontrado: data\Cobranza_12112025.xlsx
2025-11-13 17:06:23,589 - INFO - Archivo encontrado: data/AHORROS.xlsx
2025-11-13 17:06:23,589 - INFO - 
--- PASO 1: CARGA DE ARCHIVOS ---
2025-11-13 17:06:23,589 - INFO - Cargando ANTIGÜEDAD desde: data\ReportedeAntiguedaddeCarteraGrupal_12112025.xlsx
2025-11-13 17:06:23,610 - INFO - Hoja detectada: '121125'
2025-11-13 17:06:23,769 - INFO - ANTIGÜEDAD cargado: (206, 59)
2025-11-13 17:06:23,769 - INFO - Columnas: ['cod_region', 'coordinacion', 'nombre_de_gerente', 'codigo_promotor', 'nombre_promotor', 'codigo_recuperador', 'nombre_recuperador', 'cod_grupo_solidario', 'ciclo', 'grupo_solidario']...
2025-11-13 17:06:23,770 - INFO - No se encontraron IDs duplicados
2025-11-13 17:06:23,770 - INFO - Cargando SITUACIÓN DE CARTERA desde: data\Situación_de_cartera_12112025.xlsx
2025-11-13 17:06:23,899 - INFO - SITUACIÓN DE CARTERA cargada: (206, 43)
2025-11-13 17:06:23,899 - INFO - Columnas: ['codigo_ofic_cred', 'nombre_oficial_de_credito', 'codigo_promotor_cred', 'nombre_promotor_cred', 'codigo_coord', 'nombre_coordinacion', 'codigo_ger_regi', 'nombre_gerencia_regional', 'nombre_codigo', 'nombre_acreditado_cliente']...
2025-11-13 17:06:23,900 - INFO - Columna de código renombrada: nombre_codigo -> codigo
2025-11-13 17:06:23,901 - INFO - Cargando REPORTE DE COBRANZA desde: data\Cobranza_12112025.xlsx
2025-11-13 17:06:24,079 - INFO - REPORTE DE COBRANZA cargado: (207, 68)
2025-11-13 17:06:24,079 - INFO - Columnas: ['regional', 'regional1', 'coordinacion', 'coordinacion1', 'de_credito', 'de_credito1', 'gpo', 'cliente_grupo', 'unnamed:_8', 'del_cliente']...
2025-11-13 17:06:24,080 - INFO - Cargando AHORROS (ACUMULADO) desde: data/AHORROS.xlsx
2025-11-13 17:06:24,121 - INFO - AHORROS cargado: (208, 4)
2025-11-13 17:06:24,121 - INFO - Columnas: ['id', 'grupo', 'ciclo', 'ahorro_acumulado']
2025-11-13 17:06:24,121 - INFO - PARCHE PROMOTORES cargado: 1 correcciones
2025-11-13 17:06:24,121 - INFO - 
--- PASO 2: GENERACIÓN DE CARTERA ---
2025-11-13 17:06:24,122 - INFO - Iniciando generación de cartera (VERSIÓN CORREGIDA)...
2025-11-13 17:06:24,122 - INFO - Registros en antiguedad: 206
2025-11-13 17:06:24,124 - INFO - ID de grupo generados: 0    000089
1    000145
2    000069
3    000079
4    000104
Name: id_de_grupo, dtype: object
2025-11-13 17:06:24,141 - INFO - Después de joins: 208 registros
2025-11-13 17:06:24,142 - INFO - NaN en situacion: 2
2025-11-13 17:06:24,142 - INFO - NaN en cobranza: 1
2025-11-13 17:06:24,142 - INFO - NaN en ahorros: 3
2025-11-13 17:06:24,144 - INFO - Parche aplicado: 1 correcciones
2025-11-13 17:06:24,146 - INFO - Estatus calculados: {'Vigente': 208}
2025-11-13 17:06:24,147 - INFO - Cartera vigente sistema calculada como: saldo_total (de ANTIGÜEDAD)
2025-11-13 17:06:24,163 - INFO - Cartera generada exitosamente: 208 filas x 36 columnas
2025-11-13 17:06:24,163 - INFO - 
--- PASO 3: GUARDADO DE RESULTADO CON FORMATO ---
2025-11-13 17:06:24,163 - INFO - ================================================================================
2025-11-13 17:06:24,163 - INFO - GUARDANDO DATAFRAME CON FORMATO
2025-11-13 17:06:24,163 - INFO - ================================================================================
2025-11-13 17:06:24,163 - INFO - 
1. Cargando plantilla de headers: plantilla/CARTERA_HEADERS.xlsx
2025-11-13 17:06:24,175 - INFO - Plantilla cargada: 6 filas x 36 columnas (6.1 KB)
2025-11-13 17:06:24,176 - INFO - 
2. Creando nuevo workbook...
2025-11-13 17:06:24,177 - INFO - 
3. Copiando headers desde plantilla...
2025-11-13 17:06:24,177 - INFO - Copiando headers (filas 1-6) con formato...
2025-11-13 17:06:24,218 - INFO - Headers copiados: 36 columnas
2025-11-13 17:06:24,219 - INFO - 
4. Pegando datos del DataFrame...
2025-11-13 17:06:24,219 - INFO - Pegando DataFrame (208 filas x 36 columnas) desde fila 7...
2025-11-13 17:06:24,263 - INFO - Datos pegados hasta fila 214
2025-11-13 17:06:24,263 - INFO - 
5. Formato de datos: Se aplicará automáticamente por la tabla Excel
2025-11-13 17:06:24,263 - INFO - 
6. Creando tabla de Excel con totales...
2025-11-13 17:06:24,263 - INFO - Creando tabla Excel 'TablaCartera' desde fila 6 hasta 214...
2025-11-13 17:06:24,263 - INFO - Rango de tabla: A6:AJ215
2025-11-13 17:06:24,263 - INFO - Fila de totales: 215
2025-11-13 17:06:24,263 - INFO - Nombres de columnas extraídos: 36
2025-11-13 17:06:24,263 - INFO -   Columna 6 'Monto del crédito': SUM
2025-11-13 17:06:24,264 - INFO -   Columna 13 'Pago Semanal': SUM
2025-11-13 17:06:24,264 - INFO -   Columna 15 'Cartera vigente sistema': SUM
2025-11-13 17:06:24,264 - INFO -   Columna 16 'Carera vigente inicial': SUM
2025-11-13 17:06:24,264 - INFO -   Columna 17 'Cartera vigente calculada': SUM
2025-11-13 17:06:24,264 - INFO -   Columna 18 'Cartera Insoluta': SUM
2025-11-13 17:06:24,264 - INFO -   Columna 19 'Diferencia Validación vigente': SUM
2025-11-13 17:06:24,264 - INFO -   Columna 20 'Ahorro Consumido': SUM
2025-11-13 17:06:24,264 - INFO -   Columna 21 'Cartera Vencida Estadistica': SUM
2025-11-13 17:06:24,264 - INFO -   Columna 22 'Cartera vencida Total': SUM
2025-11-13 17:06:24,264 - INFO -   Columna 24 'Saldo en riesgo': SUM
2025-11-13 17:06:24,265 - INFO -   Columna 25 'Saldo 
ahorro 
acumulado': SUM
2025-11-13 17:06:24,265 - INFO -   Columna 26 'Monto promedio del grupo': SUM
2025-11-13 17:06:24,265 - INFO -   Columna 33 'Ahorro Acumulado': SUM
2025-11-13 17:06:24,265 - INFO - Filtros automáticos habilitados en rango: A6:AJ6
2025-11-13 17:06:24,266 - INFO - Escribiendo fórmulas en fila de totales...
2025-11-13 17:06:24,266 - INFO -   Fórmula en columna 6: =SUBTOTAL(109,F7:F214)
2025-11-13 17:06:24,266 - INFO -   Fórmula en columna 13: =SUBTOTAL(109,M7:M214)
2025-11-13 17:06:24,266 - INFO -   Fórmula en columna 15: =SUBTOTAL(109,O7:O214)
2025-11-13 17:06:24,266 - INFO -   Fórmula en columna 16: =SUBTOTAL(109,P7:P214)
2025-11-13 17:06:24,266 - INFO -   Fórmula en columna 17: =SUBTOTAL(109,Q7:Q214)
2025-11-13 17:06:24,267 - INFO -   Fórmula en columna 18: =SUBTOTAL(109,R7:R214)
2025-11-13 17:06:24,267 - INFO -   Fórmula en columna 19: =SUBTOTAL(109,S7:S214)
2025-11-13 17:06:24,267 - INFO -   Fórmula en columna 20: =SUBTOTAL(109,T7:T214)
2025-11-13 17:06:24,267 - INFO -   Fórmula en columna 21: =SUBTOTAL(109,U7:U214)
2025-11-13 17:06:24,267 - INFO -   Fórmula en columna 22: =SUBTOTAL(109,V7:V214)
2025-11-13 17:06:24,267 - INFO -   Fórmula en columna 24: =SUBTOTAL(109,X7:X214)
2025-11-13 17:06:24,267 - INFO -   Fórmula en columna 25: =SUBTOTAL(109,Y7:Y214)
2025-11-13 17:06:24,268 - INFO -   Fórmula en columna 26: =SUBTOTAL(109,Z7:Z214)
2025-11-13 17:06:24,268 - INFO -   Fórmula en columna 33: =SUBTOTAL(109,AG7:AG214)
2025-11-13 17:06:24,268 - INFO - Tabla creada exitosamente con 208 filas de datos + fila totales
2025-11-13 17:06:24,268 - INFO - Totales configurados en 14 columnas con fórmulas SUBTOTAL
2025-11-13 17:06:24,268 - INFO - Fila de totales: Formato aplicado automáticamente por la tabla
2025-11-13 17:06:24,268 - INFO - 
6.1. Congelando paneles para mantener encabezados visibles...
2025-11-13 17:06:24,268 - INFO - Paneles congelados: Filas 1-6 siempre visibles
2025-11-13 17:06:24,269 - INFO - 
7. Guardando archivo: output_automatizado.xlsx
2025-11-13 17:06:24,378 - INFO - 
================================================================================
2025-11-13 17:06:24,378 - INFO - ARCHIVO GUARDADO EXITOSAMENTE
2025-11-13 17:06:24,379 - INFO - ================================================================================
2025-11-13 17:06:24,379 - INFO - 
Archivo: output_automatizado.xlsx
2025-11-13 17:06:24,379 - INFO - Filas de datos: 208
2025-11-13 17:06:24,379 - INFO - Columnas: 36
2025-11-13 17:06:24,379 - INFO - Formato: Idéntico al machote
2025-11-13 17:06:24,379 - INFO - Tabla Excel: Con totales automáticos y filtros
2025-11-13 17:06:24,379 - INFO - Encabezados: Siempre visibles (paneles congelados)
2025-11-13 17:06:24,379 - INFO - ================================================================================
2025-11-13 17:06:24,379 - INFO - OK - Archivo guardado con formato: output_automatizado.xlsx
2025-11-13 17:06:24,379 - INFO - 
--- PASO 4: GENERACIÓN DE HOJA MORA ---
2025-11-13 17:06:24,379 - INFO - 
Iniciando generación de hoja MORA...
2025-11-13 17:06:24,380 - INFO - Registros con %mora > 5%: 7 de 208
2025-11-13 17:06:24,382 - INFO - Hoja MORA generada con 7 registros y 14 columnas
2025-11-13 17:06:24,383 - INFO - 
================================================================================
2025-11-13 17:06:24,383 - INFO - AGREGANDO HOJA MORA
2025-11-13 17:06:24,383 - INFO - ================================================================================
2025-11-13 17:06:24,383 - INFO - 
1. Abriendo archivo: output_automatizado.xlsx
2025-11-13 17:06:24,550 - INFO - 
2. Creando hoja 'Mora'
2025-11-13 17:06:24,550 - INFO - 
3. Copiando formato de headers desde plantilla
2025-11-13 17:06:24,572 - INFO - 
4. Estableciendo headers de MORA
2025-11-13 17:06:24,572 - INFO - 
5. Pegando 7 filas de datos
2025-11-13 17:06:24,574 - INFO - 
6. Creando tabla Excel con totales
2025-11-13 17:06:24,574 - INFO -    Creando tabla: A6:N14
2025-11-13 17:06:24,575 - INFO -    Tabla 'TablaMora' creada con totales automáticos
2025-11-13 17:06:24,575 - INFO -    Filtros automáticos habilitados en rango: A6:N6
2025-11-13 17:06:24,575 - INFO -    Fórmulas SUBTOTAL escritas en 6 columnas
2025-11-13 17:06:24,575 - INFO - 
6.1. Congelando paneles para mantener encabezados visibles...
2025-11-13 17:06:24,575 - INFO - Paneles congelados: Filas 1-6 siempre visibles
2025-11-13 17:06:24,575 - INFO - 
7. Guardando archivo con hoja MORA
2025-11-13 17:06:24,698 - INFO - 
================================================================================
2025-11-13 17:06:24,698 - INFO - HOJA MORA AGREGADA EXITOSAMENTE
2025-11-13 17:06:24,698 - INFO - ================================================================================
2025-11-13 17:06:24,698 - INFO - 
Registros en MORA: 7
2025-11-13 17:06:24,698 - INFO - Filtro: %mora > 5%
2025-11-13 17:06:24,698 - INFO - Columnas amarillas: %mora, Días de mora
2025-11-13 17:06:24,698 - INFO - Tabla Excel: Con totales automáticos y filtros
2025-11-13 17:06:24,698 - INFO - Encabezados: Siempre visibles (paneles congelados)
2025-11-13 17:06:24,699 - INFO - ================================================================================
2025-11-13 17:06:24,699 - INFO - OK - Hoja MORA agregada con 7 registros
2025-11-13 17:06:24,699 - INFO - 
--- PASO 5: VALIDACIÓN ---
2025-11-13 17:06:24,699 - INFO - Machote no encontrado - validación omitida (no es necesario)
2025-11-13 17:06:24,700 - INFO - 
================================================================================
2025-11-13 17:06:24,700 - INFO - AUTOMATIZACIÓN COMPLETADA EXITOSAMENTE
2025-11-13 17:06:24,700 - INFO - ================================================================================
2025-11-13 17:24:15,974 - INFO - Cargando ANTIGÜEDAD desde: data\ReportedeAntiguedaddeCarteraGrupal_12112025.xlsx
2025-11-13 17:24:15,999 - INFO - Hoja detectada: '121125'
2025-11-13 17:24:16,162 - INFO - ANTIGÜEDAD cargado: (206, 59)
2025-11-13 17:24:16,163 - INFO - Columnas: ['cod_region', 'coordinacion', 'nombre_de_gerente', 'codigo_promotor', 'nombre_promotor', 'codigo_recuperador', 'nombre_recuperador', 'cod_grupo_solidario', 'ciclo', 'grupo_solidario']...
2025-11-13 17:24:16,167 - INFO - No se encontraron IDs duplicados
2025-11-13 17:24:16,167 - INFO - Cargando SITUACIÓN DE CARTERA desde: data\Situación_de_cartera_12112025.xlsx
2025-11-13 17:24:16,301 - INFO - SITUACIÓN DE CARTERA cargada: (206, 43)
2025-11-13 17:24:16,302 - INFO - Columnas: ['codigo_ofic_cred', 'nombre_oficial_de_credito', 'codigo_promotor_cred', 'nombre_promotor_cred', 'codigo_coord', 'nombre_coordinacion', 'codigo_ger_regi', 'nombre_gerencia_regional', 'nombre_codigo', 'nombre_acreditado_cliente']...
2025-11-13 17:24:16,304 - INFO - Columna de código renombrada: nombre_codigo -> codigo
2025-11-13 17:24:16,305 - INFO - Cargando REPORTE DE COBRANZA desde: data\Cobranza_12112025.xlsx
2025-11-13 17:24:16,485 - INFO - REPORTE DE COBRANZA cargado: (207, 68)
2025-11-13 17:24:16,486 - INFO - Columnas: ['regional', 'regional1', 'coordinacion', 'coordinacion1', 'de_credito', 'de_credito1', 'gpo', 'cliente_grupo', 'unnamed:_8', 'del_cliente']...
2025-11-13 17:24:16,486 - INFO - Cargando AHORROS (ACUMULADO) desde: data/AHORROS.xlsx
2025-11-13 17:24:16,525 - INFO - AHORROS cargado: (208, 4)
2025-11-13 17:24:16,525 - INFO - Columnas: ['id', 'grupo', 'ciclo', 'ahorro_acumulado']
2025-11-13 17:24:16,526 - INFO - Iniciando generación de cartera (VERSIÓN CORREGIDA)...
2025-11-13 17:24:16,526 - INFO - Registros en antiguedad: 206
2025-11-13 17:24:16,528 - INFO - ID de grupo generados: 0    000089
1    000145
2    000069
3    000079
4    000104
Name: id_de_grupo, dtype: object
2025-11-13 17:24:16,549 - INFO - Después de joins: 208 registros
2025-11-13 17:24:16,550 - INFO - NaN en situacion: 2
2025-11-13 17:24:16,550 - INFO - NaN en cobranza: 1
2025-11-13 17:24:16,551 - INFO - NaN en ahorros: 3
2025-11-13 17:24:16,553 - INFO - Parche aplicado: 1 correcciones
2025-11-13 17:24:16,555 - INFO - Estatus calculados: {'Vigente': 208}
2025-11-13 17:24:16,556 - INFO - Cartera vigente sistema calculada como: saldo_total (de ANTIGÜEDAD)
2025-11-13 17:24:16,572 - INFO - Cartera generada exitosamente: 208 filas x 36 columnas
2025-11-13 17:25:01,332 - INFO - Cargando ANTIGÜEDAD desde: data\ReportedeAntiguedaddeCarteraGrupal_12112025.xlsx
2025-11-13 17:25:01,352 - INFO - Hoja detectada: '121125'
2025-11-13 17:25:01,505 - INFO - ANTIGÜEDAD cargado: (206, 59)
2025-11-13 17:25:01,505 - INFO - Columnas: ['cod_region', 'coordinacion', 'nombre_de_gerente', 'codigo_promotor', 'nombre_promotor', 'codigo_recuperador', 'nombre_recuperador', 'cod_grupo_solidario', 'ciclo', 'grupo_solidario']...
2025-11-13 17:25:01,505 - INFO - No se encontraron IDs duplicados
2025-11-13 17:25:01,505 - INFO - Cargando SITUACIÓN DE CARTERA desde: data\Situación_de_cartera_12112025.xlsx
2025-11-13 17:25:01,628 - INFO - SITUACIÓN DE CARTERA cargada: (206, 43)
2025-11-13 17:25:01,628 - INFO - Columnas: ['codigo_ofic_cred', 'nombre_oficial_de_credito', 'codigo_promotor_cred', 'nombre_promotor_cred', 'codigo_coord', 'nombre_coordinacion', 'codigo_ger_regi', 'nombre_gerencia_regional', 'nombre_codigo', 'nombre_acreditado_cliente']...
2025-11-13 17:25:01,629 - INFO - Columna de código renombrada: nombre_codigo -> codigo
2025-11-13 17:25:01,630 - INFO - Cargando REPORTE DE COBRANZA desde: data\Cobranza_12112025.xlsx
2025-11-13 17:25:01,823 - INFO - REPORTE DE COBRANZA cargado: (207, 68)
2025-11-13 17:25:01,824 - INFO - Columnas: ['regional', 'regional1', 'coordinacion', 'coordinacion1', 'de_credito', 'de_credito1', 'gpo', 'cliente_grupo', 'unnamed:_8', 'del_cliente']...
2025-11-13 17:25:01,824 - INFO - Cargando AHORROS (ACUMULADO) desde: data/AHORROS.xlsx
2025-11-13 17:25:01,863 - INFO - AHORROS cargado: (208, 4)
2025-11-13 17:25:01,863 - INFO - Columnas: ['id', 'grupo', 'ciclo', 'ahorro_acumulado']
2025-11-13 17:25:01,864 - INFO - Iniciando generación de cartera (VERSIÓN CORREGIDA)...
2025-11-13 17:25:01,864 - INFO - Registros en antiguedad: 206
2025-11-13 17:25:01,865 - INFO - ID de grupo generados: 0    000089
1    000145
2    000069
3    000079
4    000104
Name: id_de_grupo, dtype: object
2025-11-13 17:25:01,883 - INFO - Después de joins: 208 registros
2025-11-13 17:25:01,883 - INFO - NaN en situacion: 2
2025-11-13 17:25:01,883 - INFO - NaN en cobranza: 1
2025-11-13 17:25:01,884 - INFO - NaN en ahorros: 3
2025-11-13 17:25:01,885 - INFO - Parche aplicado: 1 correcciones
2025-11-13 17:25:01,887 - INFO - Estatus calculados: {'Vigente': 208}
2025-11-13 17:25:01,888 - INFO - Cartera vigente sistema calculada como: saldo_total (de ANTIGÜEDAD)
2025-11-13 17:25:01,902 - INFO - Cartera generada exitosamente: 208 filas x 36 columnas
2025-11-13 17:25:22,168 - INFO - ================================================================================
2025-11-13 17:25:22,169 - INFO - INICIO DE AUTOMATIZACIÓN DE CARTERA
2025-11-13 17:25:22,169 - INFO - ================================================================================
2025-11-13 17:25:22,169 - INFO - 
--- PASO 0: BÚSQUEDA DE ARCHIVOS ---
2025-11-13 17:25:22,170 - INFO - Archivo encontrado: data\ReportedeAntiguedaddeCarteraGrupal_12112025.xlsx
2025-11-13 17:25:22,170 - INFO - Archivo encontrado: data\Situación_de_cartera_12112025.xlsx
2025-11-13 17:25:22,171 - INFO - Archivo encontrado: data\Cobranza_12112025.xlsx
2025-11-13 17:25:22,172 - INFO - Archivo encontrado: data/AHORROS.xlsx
2025-11-13 17:25:22,172 - INFO - 
--- PASO 1: CARGA DE ARCHIVOS ---
2025-11-13 17:25:22,172 - INFO - Cargando ANTIGÜEDAD desde: data\ReportedeAntiguedaddeCarteraGrupal_12112025.xlsx
2025-11-13 17:25:22,195 - INFO - Hoja detectada: '121125'
2025-11-13 17:25:22,349 - INFO - ANTIGÜEDAD cargado: (206, 59)
2025-11-13 17:25:22,349 - INFO - Columnas: ['cod_region', 'coordinacion', 'nombre_de_gerente', 'codigo_promotor', 'nombre_promotor', 'codigo_recuperador', 'nombre_recuperador', 'cod_grupo_solidario', 'ciclo', 'grupo_solidario']...
2025-11-13 17:25:22,350 - INFO - No se encontraron IDs duplicados
2025-11-13 17:25:22,350 - INFO - Cargando SITUACIÓN DE CARTERA desde: data\Situación_de_cartera_12112025.xlsx
2025-11-13 17:25:22,468 - INFO - SITUACIÓN DE CARTERA cargada: (206, 43)
2025-11-13 17:25:22,468 - INFO - Columnas: ['codigo_ofic_cred', 'nombre_oficial_de_credito', 'codigo_promotor_cred', 'nombre_promotor_cred', 'codigo_coord', 'nombre_coordinacion', 'codigo_ger_regi', 'nombre_gerencia_regional', 'nombre_codigo', 'nombre_acreditado_cliente']...
2025-11-13 17:25:22,469 - INFO - Columna de código renombrada: nombre_codigo -> codigo
2025-11-13 17:25:22,470 - INFO - Cargando REPORTE DE COBRANZA desde: data\Cobranza_12112025.xlsx
2025-11-13 17:25:22,673 - INFO - REPORTE DE COBRANZA cargado: (207, 68)
2025-11-13 17:25:22,673 - INFO - Columnas: ['regional', 'regional1', 'coordinacion', 'coordinacion1', 'de_credito', 'de_credito1', 'gpo', 'cliente_grupo', 'unnamed:_8', 'del_cliente']...
2025-11-13 17:25:22,673 - INFO - Cargando AHORROS (ACUMULADO) desde: data/AHORROS.xlsx
2025-11-13 17:25:22,711 - INFO - AHORROS cargado: (208, 4)
2025-11-13 17:25:22,712 - INFO - Columnas: ['id', 'grupo', 'ciclo', 'ahorro_acumulado']
2025-11-13 17:25:22,712 - INFO - PARCHE PROMOTORES cargado: 1 correcciones
2025-11-13 17:25:22,712 - INFO - 
--- PASO 2: GENERACIÓN DE CARTERA ---
2025-11-13 17:25:22,712 - INFO - Iniciando generación de cartera (VERSIÓN CORREGIDA)...
2025-11-13 17:25:22,712 - INFO - Registros en antiguedad: 206
2025-11-13 17:25:22,714 - INFO - ID de grupo generados: 0    000089
1    000145
2    000069
3    000079
4    000104
Name: id_de_grupo, dtype: object
2025-11-13 17:25:22,730 - INFO - Después de joins: 208 registros
2025-11-13 17:25:22,731 - INFO - NaN en situacion: 2
2025-11-13 17:25:22,731 - INFO - NaN en cobranza: 1
2025-11-13 17:25:22,732 - INFO - NaN en ahorros: 3
2025-11-13 17:25:22,734 - INFO - Parche aplicado: 1 correcciones
2025-11-13 17:25:22,736 - INFO - Estatus calculados: {'Vigente': 208}
2025-11-13 17:25:22,737 - INFO - Cartera vigente sistema calculada como: saldo_total (de ANTIGÜEDAD)
2025-11-13 17:25:22,756 - INFO - Cartera generada exitosamente: 208 filas x 36 columnas
2025-11-13 17:25:22,757 - INFO - 
--- PASO 3: GUARDADO DE RESULTADO CON FORMATO ---
2025-11-13 17:25:22,757 - INFO - ================================================================================
2025-11-13 17:25:22,757 - INFO - GUARDANDO DATAFRAME CON FORMATO
2025-11-13 17:25:22,757 - INFO - ================================================================================
2025-11-13 17:25:22,758 - INFO - 
1. Cargando plantilla de headers: plantilla/CARTERA_HEADERS.xlsx
2025-11-13 17:25:22,780 - INFO - Plantilla cargada: 6 filas x 36 columnas (6.1 KB)
2025-11-13 17:25:22,780 - INFO - 
2. Creando nuevo workbook...
2025-11-13 17:25:22,782 - INFO - 
3. Copiando headers desde plantilla...
2025-11-13 17:25:22,782 - INFO - Copiando headers (filas 1-6) con formato...
2025-11-13 17:25:22,825 - INFO - Headers copiados: 36 columnas
2025-11-13 17:25:22,825 - INFO - 
4. Pegando datos del DataFrame...
2025-11-13 17:25:22,825 - INFO - Pegando DataFrame (208 filas x 36 columnas) desde fila 7...
2025-11-13 17:25:22,871 - INFO - Datos pegados hasta fila 214
2025-11-13 17:25:22,872 - INFO - 
5. Formato de datos: Se aplicará automáticamente por la tabla Excel
2025-11-13 17:25:22,872 - INFO - 
6. Creando tabla de Excel con totales...
2025-11-13 17:25:22,872 - INFO - Creando tabla Excel 'TablaCartera' desde fila 6 hasta 214...
2025-11-13 17:25:22,872 - INFO - Rango de tabla: A6:AJ215
2025-11-13 17:25:22,872 - INFO - Fila de totales: 215
2025-11-13 17:25:22,872 - INFO - Nombres de columnas extraídos: 36
2025-11-13 17:25:22,872 - INFO -   Columna 6 'Monto del crédito': SUM
2025-11-13 17:25:22,873 - INFO -   Columna 13 'Pago Semanal': SUM
2025-11-13 17:25:22,873 - INFO -   Columna 15 'Cartera vigente sistema': SUM
2025-11-13 17:25:22,873 - INFO -   Columna 16 'Carera vigente inicial': SUM
2025-11-13 17:25:22,873 - INFO -   Columna 17 'Cartera vigente calculada': SUM
2025-11-13 17:25:22,873 - INFO -   Columna 18 'Cartera Insoluta': SUM
2025-11-13 17:25:22,873 - INFO -   Columna 19 'Diferencia Validación vigente': SUM
2025-11-13 17:25:22,874 - INFO -   Columna 20 'Ahorro Consumido': SUM
2025-11-13 17:25:22,874 - INFO -   Columna 21 'Cartera Vencida Estadistica': SUM
2025-11-13 17:25:22,874 - INFO -   Columna 22 'Cartera vencida Total': SUM
2025-11-13 17:25:22,874 - INFO -   Columna 24 'Saldo en riesgo': SUM
2025-11-13 17:25:22,874 - INFO -   Columna 25 'Saldo 
ahorro 
acumulado': SUM
2025-11-13 17:25:22,874 - INFO -   Columna 26 'Monto promedio del grupo': SUM
2025-11-13 17:25:22,875 - INFO -   Columna 33 'Ahorro Acumulado': SUM
2025-11-13 17:25:22,875 - INFO - Filtros automáticos habilitados en rango: A6:AJ6
2025-11-13 17:25:22,875 - INFO - Escribiendo fórmulas en fila de totales...
2025-11-13 17:25:22,875 - INFO -   Fórmula en columna 6: =SUBTOTAL(109,F7:F214)
2025-11-13 17:25:22,875 - INFO -   Fórmula en columna 13: =SUBTOTAL(109,M7:M214)
2025-11-13 17:25:22,876 - INFO -   Fórmula en columna 15: =SUBTOTAL(109,O7:O214)
2025-11-13 17:25:22,876 - INFO -   Fórmula en columna 16: =SUBTOTAL(109,P7:P214)
2025-11-13 17:25:22,876 - INFO -   Fórmula en columna 17: =SUBTOTAL(109,Q7:Q214)
2025-11-13 17:25:22,876 - INFO -   Fórmula en columna 18: =SUBTOTAL(109,R7:R214)
2025-11-13 17:25:22,876 - INFO -   Fórmula en columna 19: =SUBTOTAL(109,S7:S214)
2025-11-13 17:25:22,876 - INFO -   Fórmula en columna 20: =SUBTOTAL(109,T7:T214)
2025-11-13 17:25:22,876 - INFO -   Fórmula en columna 21: =SUBTOTAL(109,U7:U214)
2025-11-13 17:25:22,876 - INFO -   Fórmula en columna 22: =SUBTOTAL(109,V7:V214)
2025-11-13 17:25:22,876 - INFO -   Fórmula en columna 24: =SUBTOTAL(109,X7:X214)
2025-11-13 17:25:22,877 - INFO -   Fórmula en columna 25: =SUBTOTAL(109,Y7:Y214)
2025-11-13 17:25:22,877 - INFO -   Fórmula en columna 26: =SUBTOTAL(109,Z7:Z214)
2025-11-13 17:25:22,877 - INFO -   Fórmula en columna 33: =SUBTOTAL(109,AG7:AG214)
2025-11-13 17:25:22,877 - INFO - Tabla creada exitosamente con 208 filas de datos + fila totales
2025-11-13 17:25:22,877 - INFO - Totales configurados en 14 columnas con fórmulas SUBTOTAL
2025-11-13 17:25:22,877 - INFO - Fila de totales: Formato aplicado automáticamente por la tabla
2025-11-13 17:25:22,877 - INFO - 
6.1. Congelando paneles para mantener encabezados visibles...
2025-11-13 17:25:22,877 - INFO - Paneles congelados: Filas 1-6 siempre visibles
2025-11-13 17:25:22,877 - INFO - 
7. Guardando archivo: output_automatizado.xlsx
2025-11-13 17:25:22,878 - ERROR - 
ERROR: [Errno 13] Permission denied: 'output_automatizado.xlsx'
Traceback (most recent call last):
  File "C:\Users\uzzie\Documents\Jale\merge-dataframes\analizar_y_automatizar.py", line 314, in main
    guardar_con_formato(df_cartera, RUTA_PLANTILLA, RUTA_OUTPUT)
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\uzzie\Documents\Jale\merge-dataframes\formato_excel.py", line 316, in guardar_con_formato
    wb_nuevo.save(ruta_output)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\uzzie\miniconda3\Lib\site-packages\openpyxl\workbook\workbook.py", line 386, in save
    save_workbook(self, filename)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "C:\Users\uzzie\miniconda3\Lib\site-packages\openpyxl\writer\excel.py", line 291, in save_workbook
    archive = ZipFile(filename, 'w', ZIP_DEFLATED, allowZip64=True)
  File "C:\Users\uzzie\miniconda3\Lib\zipfile\__init__.py", line 1367, in __init__
    self.fp = io.open(file, filemode)
              ~~~~~~~^^^^^^^^^^^^^^^^
PermissionError: [Errno 13] Permission denied: 'output_automatizado.xlsx'
2025-11-13 17:28:54,299 - INFO - Cargando ANTIGÜEDAD desde: data\ReportedeAntiguedaddeCarteraGrupal_12112025.xlsx
2025-11-13 17:28:54,320 - INFO - Hoja detectada: '121125'
2025-11-13 17:28:54,471 - INFO - ANTIGÜEDAD cargado: (206, 59)
2025-11-13 17:28:54,471 - INFO - Columnas: ['cod_region', 'coordinacion', 'nombre_de_gerente', 'codigo_promotor', 'nombre_promotor', 'codigo_recuperador', 'nombre_recuperador', 'cod_grupo_solidario', 'ciclo', 'grupo_solidario']...
2025-11-13 17:28:54,472 - INFO - No se encontraron IDs duplicados
2025-11-13 17:28:54,472 - INFO - Cargando SITUACIÓN DE CARTERA desde: data\Situación_de_cartera_12112025.xlsx
2025-11-13 17:28:54,597 - INFO - SITUACIÓN DE CARTERA cargada: (206, 43)
2025-11-13 17:28:54,597 - INFO - Columnas: ['codigo_ofic_cred', 'nombre_oficial_de_credito', 'codigo_promotor_cred', 'nombre_promotor_cred', 'codigo_coord', 'nombre_coordinacion', 'codigo_ger_regi', 'nombre_gerencia_regional', 'nombre_codigo', 'nombre_acreditado_cliente']...
2025-11-13 17:28:54,597 - INFO - Columna de código renombrada: nombre_codigo -> codigo
2025-11-13 17:28:54,599 - INFO - Cargando REPORTE DE COBRANZA desde: data\Cobranza_12112025.xlsx
2025-11-13 17:28:54,789 - INFO - REPORTE DE COBRANZA cargado: (207, 68)
2025-11-13 17:28:54,789 - INFO - Columnas: ['regional', 'regional1', 'coordinacion', 'coordinacion1', 'de_credito', 'de_credito1', 'gpo', 'cliente_grupo', 'unnamed:_8', 'del_cliente']...
2025-11-13 17:28:54,790 - INFO - Cargando AHORROS (ACUMULADO) desde: data/AHORROS.xlsx
2025-11-13 17:28:54,829 - INFO - AHORROS cargado: (208, 4)
2025-11-13 17:28:54,830 - INFO - Columnas: ['id', 'grupo', 'ciclo', 'ahorro_acumulado']
2025-11-13 17:29:15,791 - INFO - Cargando ANTIGÜEDAD desde: data\ReportedeAntiguedaddeCarteraGrupal_12112025.xlsx
2025-11-13 17:29:15,812 - INFO - Hoja detectada: '121125'
2025-11-13 17:29:15,961 - INFO - ANTIGÜEDAD cargado: (206, 59)
2025-11-13 17:29:15,962 - INFO - Columnas: ['cod_region', 'coordinacion', 'nombre_de_gerente', 'codigo_promotor', 'nombre_promotor', 'codigo_recuperador', 'nombre_recuperador', 'cod_grupo_solidario', 'ciclo', 'grupo_solidario']...
2025-11-13 17:29:15,962 - INFO - No se encontraron IDs duplicados
2025-11-13 17:29:15,963 - INFO - Cargando SITUACIÓN DE CARTERA desde: data\Situación_de_cartera_12112025.xlsx
2025-11-13 17:29:16,085 - INFO - SITUACIÓN DE CARTERA cargada: (206, 43)
2025-11-13 17:29:16,086 - INFO - Columnas: ['codigo_ofic_cred', 'nombre_oficial_de_credito', 'codigo_promotor_cred', 'nombre_promotor_cred', 'codigo_coord', 'nombre_coordinacion', 'codigo_ger_regi', 'nombre_gerencia_regional', 'nombre_codigo', 'nombre_acreditado_cliente']...
2025-11-13 17:29:16,086 - INFO - Columna de código renombrada: nombre_codigo -> codigo
2025-11-13 17:29:16,088 - INFO - Cargando REPORTE DE COBRANZA desde: data\Cobranza_12112025.xlsx
2025-11-13 17:29:16,273 - INFO - REPORTE DE COBRANZA cargado: (207, 68)
2025-11-13 17:29:16,274 - INFO - Columnas: ['regional', 'regional1', 'coordinacion', 'coordinacion1', 'de_credito', 'de_credito1', 'gpo', 'cliente_grupo', 'unnamed:_8', 'del_cliente']...
2025-11-13 17:29:16,274 - INFO - Cargando AHORROS (ACUMULADO) desde: data/AHORROS.xlsx
2025-11-13 17:29:16,312 - INFO - AHORROS cargado: (208, 4)
2025-11-13 17:29:16,312 - INFO - Columnas: ['id', 'grupo', 'ciclo', 'ahorro_acumulado']
2025-11-13 17:29:16,312 - INFO - Iniciando generación de cartera (VERSIÓN CORREGIDA)...
2025-11-13 17:29:16,312 - INFO - Registros en antiguedad: 206
2025-11-13 17:29:16,314 - INFO - ID de grupo generados: 0    000089
1    000145
2    000069
3    000079
4    000104
Name: id_de_grupo, dtype: object
2025-11-13 17:29:16,330 - INFO - Después de joins: 208 registros
2025-11-13 17:29:16,330 - INFO - NaN en situacion: 2
2025-11-13 17:29:16,330 - INFO - NaN en cobranza: 1
2025-11-13 17:29:16,331 - INFO - NaN en ahorros: 3
2025-11-13 17:29:16,332 - INFO - Parche aplicado: 1 correcciones
2025-11-13 17:29:16,335 - INFO - Estatus calculados: {'Vigente': 208}
2025-11-13 17:29:16,336 - INFO - Cartera vigente sistema calculada como: saldo_total (de ANTIGÜEDAD)
2025-11-13 17:29:16,348 - INFO - Cartera generada exitosamente: 208 filas x 36 columnas
2025-11-13 17:29:36,661 - INFO - Cargando ANTIGÜEDAD desde: data\ReportedeAntiguedaddeCarteraGrupal_12112025.xlsx
2025-11-13 17:29:36,682 - INFO - Hoja detectada: '121125'
2025-11-13 17:29:36,836 - INFO - ANTIGÜEDAD cargado: (206, 59)
2025-11-13 17:29:36,836 - INFO - Columnas: ['cod_region', 'coordinacion', 'nombre_de_gerente', 'codigo_promotor', 'nombre_promotor', 'codigo_recuperador', 'nombre_recuperador', 'cod_grupo_solidario', 'ciclo', 'grupo_solidario']...
2025-11-13 17:29:36,837 - INFO - No se encontraron IDs duplicados
2025-11-13 17:29:36,837 - INFO - Cargando SITUACIÓN DE CARTERA desde: data\Situación_de_cartera_12112025.xlsx
2025-11-13 17:29:36,955 - INFO - SITUACIÓN DE CARTERA cargada: (206, 43)
2025-11-13 17:29:36,960 - INFO - Columnas: ['codigo_ofic_cred', 'nombre_oficial_de_credito', 'codigo_promotor_cred', 'nombre_promotor_cred', 'codigo_coord', 'nombre_coordinacion', 'codigo_ger_regi', 'nombre_gerencia_regional', 'nombre_codigo', 'nombre_acreditado_cliente']...
2025-11-13 17:29:36,960 - INFO - Columna de código renombrada: nombre_codigo -> codigo
2025-11-13 17:29:36,962 - INFO - Cargando REPORTE DE COBRANZA desde: data\Cobranza_12112025.xlsx
2025-11-13 17:29:37,149 - INFO - REPORTE DE COBRANZA cargado: (207, 68)
2025-11-13 17:29:37,150 - INFO - Columnas: ['regional', 'regional1', 'coordinacion', 'coordinacion1', 'de_credito', 'de_credito1', 'gpo', 'cliente_grupo', 'unnamed:_8', 'del_cliente']...
2025-11-13 17:29:37,150 - INFO - Cargando AHORROS (ACUMULADO) desde: data/AHORROS.xlsx
2025-11-13 17:29:37,187 - INFO - AHORROS cargado: (208, 4)
2025-11-13 17:29:37,187 - INFO - Columnas: ['id', 'grupo', 'ciclo', 'ahorro_acumulado']
2025-11-13 17:29:37,187 - INFO - Iniciando generación de cartera (VERSIÓN CORREGIDA)...
2025-11-13 17:29:37,188 - INFO - Registros en antiguedad: 206
2025-11-13 17:29:37,189 - INFO - ID de grupo generados: 0    000089
1    000145
2    000069
3    000079
4    000104
Name: id_de_grupo, dtype: object
2025-11-13 17:29:37,204 - INFO - Después de joins: 208 registros
2025-11-13 17:29:37,205 - INFO - NaN en situacion: 2
2025-11-13 17:29:37,205 - INFO - NaN en cobranza: 1
2025-11-13 17:29:37,205 - INFO - NaN en ahorros: 3
2025-11-13 17:29:37,207 - INFO - Parche aplicado: 1 correcciones
2025-11-13 17:29:37,209 - INFO - Estatus calculados: {'Vigente': 208}
2025-11-13 17:29:37,209 - INFO - Cartera vigente sistema calculada como: saldo_total (de ANTIGÜEDAD)
2025-11-13 17:29:37,227 - INFO - Cartera generada exitosamente: 208 filas x 36 columnas
2025-11-13 17:30:07,907 - INFO - Cargando ANTIGÜEDAD desde: data\ReportedeAntiguedaddeCarteraGrupal_12112025.xlsx
2025-11-13 17:30:07,930 - INFO - Hoja detectada: '121125'
2025-11-13 17:30:08,076 - INFO - ANTIGÜEDAD cargado: (206, 59)
2025-11-13 17:30:08,077 - INFO - Columnas: ['cod_region', 'coordinacion', 'nombre_de_gerente', 'codigo_promotor', 'nombre_promotor', 'codigo_recuperador', 'nombre_recuperador', 'cod_grupo_solidario', 'ciclo', 'grupo_solidario']...
2025-11-13 17:30:08,078 - INFO - No se encontraron IDs duplicados
2025-11-13 17:30:08,078 - INFO - Cargando SITUACIÓN DE CARTERA desde: data\Situación_de_cartera_12112025.xlsx
2025-11-13 17:30:08,199 - INFO - SITUACIÓN DE CARTERA cargada: (206, 43)
2025-11-13 17:30:08,199 - INFO - Columnas: ['codigo_ofic_cred', 'nombre_oficial_de_credito', 'codigo_promotor_cred', 'nombre_promotor_cred', 'codigo_coord', 'nombre_coordinacion', 'codigo_ger_regi', 'nombre_gerencia_regional', 'nombre_codigo', 'nombre_acreditado_cliente']...
2025-11-13 17:30:08,199 - INFO - Columna de código renombrada: nombre_codigo -> codigo
2025-11-13 17:30:08,201 - INFO - Cargando REPORTE DE COBRANZA desde: data\Cobranza_12112025.xlsx
2025-11-13 17:30:08,384 - INFO - REPORTE DE COBRANZA cargado: (207, 68)
2025-11-13 17:30:08,384 - INFO - Columnas: ['regional', 'regional1', 'coordinacion', 'coordinacion1', 'de_credito', 'de_credito1', 'gpo', 'cliente_grupo', 'unnamed:_8', 'del_cliente']...
2025-11-13 17:30:08,384 - INFO - Cargando AHORROS (ACUMULADO) desde: data/AHORROS.xlsx
2025-11-13 17:30:08,421 - INFO - AHORROS cargado: (208, 4)
2025-11-13 17:30:08,421 - INFO - Columnas: ['id', 'grupo', 'ciclo', 'ahorro_acumulado']
2025-11-13 17:30:08,422 - INFO - Iniciando generación de cartera (VERSIÓN CORREGIDA)...
2025-11-13 17:30:08,422 - INFO - Registros en antiguedad: 206
2025-11-13 17:30:08,424 - INFO - ID de grupo generados: 0    000089
1    000145
2    000069
3    000079
4    000104
Name: id_de_grupo, dtype: object
2025-11-13 17:30:08,439 - INFO - Después de joins: 208 registros
2025-11-13 17:30:08,439 - INFO - NaN en situacion: 2
2025-11-13 17:30:08,440 - INFO - NaN en cobranza: 1
2025-11-13 17:30:08,440 - INFO - NaN en ahorros: 3
2025-11-13 17:30:08,442 - INFO - Parche aplicado: 1 correcciones
2025-11-13 17:30:08,444 - INFO - Estatus calculados: {'Vigente': 208}
2025-11-13 17:30:08,445 - INFO - Cartera vigente sistema calculada como: saldo_total (de ANTIGÜEDAD)
2025-11-13 17:30:08,459 - INFO - Cartera generada exitosamente: 208 filas x 36 columnas
2025-11-13 17:31:00,076 - INFO - Cargando ANTIGÜEDAD desde: data\ReportedeAntiguedaddeCarteraGrupal_12112025.xlsx
2025-11-13 17:31:00,100 - INFO - Hoja detectada: '121125'
2025-11-13 17:31:00,251 - INFO - ANTIGÜEDAD cargado: (206, 59)
2025-11-13 17:31:00,251 - INFO - Columnas: ['cod_region', 'coordinacion', 'nombre_de_gerente', 'codigo_promotor', 'nombre_promotor', 'codigo_recuperador', 'nombre_recuperador', 'cod_grupo_solidario', 'ciclo', 'grupo_solidario']...
2025-11-13 17:31:00,255 - INFO - No se encontraron IDs duplicados
2025-11-13 17:31:00,255 - INFO - Cargando SITUACIÓN DE CARTERA desde: data\Situación_de_cartera_12112025.xlsx
2025-11-13 17:31:00,379 - INFO - SITUACIÓN DE CARTERA cargada: (206, 43)
2025-11-13 17:31:00,379 - INFO - Columnas: ['codigo_ofic_cred', 'nombre_oficial_de_credito', 'codigo_promotor_cred', 'nombre_promotor_cred', 'codigo_coord', 'nombre_coordinacion', 'codigo_ger_regi', 'nombre_gerencia_regional', 'nombre_codigo', 'nombre_acreditado_cliente']...
2025-11-13 17:31:00,379 - INFO - Columna de código renombrada: nombre_codigo -> codigo
2025-11-13 17:31:00,381 - INFO - Cargando REPORTE DE COBRANZA desde: data\Cobranza_12112025.xlsx
2025-11-13 17:31:00,566 - INFO - REPORTE DE COBRANZA cargado: (207, 68)
2025-11-13 17:31:00,566 - INFO - Columnas: ['regional', 'regional1', 'coordinacion', 'coordinacion1', 'de_credito', 'de_credito1', 'gpo', 'cliente_grupo', 'unnamed:_8', 'del_cliente']...
2025-11-13 17:31:00,567 - INFO - Cargando AHORROS (ACUMULADO) desde: data/AHORROS.xlsx
2025-11-13 17:31:00,605 - INFO - AHORROS cargado: (208, 4)
2025-11-13 17:31:00,605 - INFO - Columnas: ['id', 'grupo', 'ciclo', 'ahorro_acumulado']
2025-11-13 17:31:00,606 - INFO - Iniciando generación de cartera (VERSIÓN CORREGIDA)...
2025-11-13 17:31:00,606 - INFO - Registros en antiguedad: 206
2025-11-13 17:31:00,609 - INFO - ID de grupo generados: 0    000089
1    000145
2    000069
3    000079
4    000104
Name: id_de_grupo, dtype: object
2025-11-13 17:31:00,626 - INFO - Después de joins: 208 registros
2025-11-13 17:31:00,627 - INFO - NaN en situacion: 2
2025-11-13 17:31:00,627 - INFO - NaN en cobranza: 1
2025-11-13 17:31:00,628 - INFO - NaN en ahorros: 3
2025-11-13 17:31:00,629 - INFO - Parche aplicado: 1 correcciones
2025-11-13 17:31:00,632 - INFO - Estatus calculados: {'Vigente': 208}
2025-11-13 17:31:00,633 - INFO - Cartera vigente sistema calculada como: saldo_total (de ANTIGÜEDAD)
2025-11-13 17:31:00,651 - INFO - Cartera generada exitosamente: 208 filas x 36 columnas
2025-11-13 17:31:30,552 - INFO - Cargando ANTIGÜEDAD desde: data\ReportedeAntiguedaddeCarteraGrupal_12112025.xlsx
2025-11-13 17:31:30,572 - INFO - Hoja detectada: '121125'
2025-11-13 17:31:30,730 - INFO - ANTIGÜEDAD cargado: (206, 59)
2025-11-13 17:31:30,730 - INFO - Columnas: ['cod_region', 'coordinacion', 'nombre_de_gerente', 'codigo_promotor', 'nombre_promotor', 'codigo_recuperador', 'nombre_recuperador', 'cod_grupo_solidario', 'ciclo', 'grupo_solidario']...
2025-11-13 17:31:30,731 - INFO - No se encontraron IDs duplicados
2025-11-13 17:31:30,731 - INFO - Cargando SITUACIÓN DE CARTERA desde: data\Situación_de_cartera_12112025.xlsx
2025-11-13 17:31:30,844 - INFO - SITUACIÓN DE CARTERA cargada: (206, 43)
2025-11-13 17:31:30,844 - INFO - Columnas: ['codigo_ofic_cred', 'nombre_oficial_de_credito', 'codigo_promotor_cred', 'nombre_promotor_cred', 'codigo_coord', 'nombre_coordinacion', 'codigo_ger_regi', 'nombre_gerencia_regional', 'nombre_codigo', 'nombre_acreditado_cliente']...
2025-11-13 17:31:30,844 - INFO - Columna de código renombrada: nombre_codigo -> codigo
2025-11-13 17:31:30,845 - INFO - Cargando REPORTE DE COBRANZA desde: data\Cobranza_12112025.xlsx
2025-11-13 17:31:31,025 - INFO - REPORTE DE COBRANZA cargado: (207, 68)
2025-11-13 17:31:31,025 - INFO - Columnas: ['regional', 'regional1', 'coordinacion', 'coordinacion1', 'de_credito', 'de_credito1', 'gpo', 'cliente_grupo', 'unnamed:_8', 'del_cliente']...
2025-11-13 17:31:31,025 - INFO - Cargando AHORROS (ACUMULADO) desde: data/AHORROS.xlsx
2025-11-13 17:31:31,068 - INFO - AHORROS cargado: (208, 4)
2025-11-13 17:31:31,068 - INFO - Columnas: ['id', 'grupo', 'ciclo', 'ahorro_acumulado']
2025-11-13 17:54:20,860 - INFO - ================================================================================
2025-11-13 17:54:20,860 - INFO - INICIO DE AUTOMATIZACIÓN DE CARTERA
2025-11-13 17:54:20,861 - INFO - ================================================================================
2025-11-13 17:54:20,861 - INFO - 
--- PASO 0: BÚSQUEDA DE ARCHIVOS ---
2025-11-13 17:54:20,861 - INFO - Archivo encontrado: data\ReportedeAntiguedaddeCarteraGrupal_12112025.xlsx
2025-11-13 17:54:20,862 - INFO - Archivo encontrado: data\Situación_de_cartera_12112025.xlsx
2025-11-13 17:54:20,862 - INFO - Archivo encontrado: data\Cobranza_12112025.xlsx
2025-11-13 17:54:20,863 - INFO - Archivo encontrado: data/AHORROS.xlsx
2025-11-13 17:54:20,863 - INFO - 
--- PASO 1: CARGA DE ARCHIVOS ---
2025-11-13 17:54:20,863 - INFO - Cargando ANTIGÜEDAD desde: data\ReportedeAntiguedaddeCarteraGrupal_12112025.xlsx
2025-11-13 17:54:20,890 - INFO - Hoja detectada: '121125'
2025-11-13 17:54:21,053 - INFO - ANTIGÜEDAD cargado: (206, 59)
2025-11-13 17:54:21,054 - INFO - Columnas: ['cod_region', 'coordinacion', 'nombre_de_gerente', 'codigo_promotor', 'nombre_promotor', 'codigo_recuperador', 'nombre_recuperador', 'cod_grupo_solidario', 'ciclo', 'grupo_solidario']...
2025-11-13 17:54:21,058 - INFO - No se encontraron IDs duplicados
2025-11-13 17:54:21,058 - INFO - Cargando SITUACIÓN DE CARTERA desde: data\Situación_de_cartera_12112025.xlsx
2025-11-13 17:54:21,195 - INFO - SITUACIÓN DE CARTERA cargada: (206, 43)
2025-11-13 17:54:21,195 - INFO - Columnas: ['codigo_ofic_cred', 'nombre_oficial_de_credito', 'codigo_promotor_cred', 'nombre_promotor_cred', 'codigo_coord', 'nombre_coordinacion', 'codigo_ger_regi', 'nombre_gerencia_regional', 'nombre_codigo', 'nombre_acreditado_cliente']...
2025-11-13 17:54:21,196 - INFO - Columna de código renombrada: nombre_codigo -> codigo
2025-11-13 17:54:21,198 - INFO - Cargando REPORTE DE COBRANZA desde: data\Cobranza_12112025.xlsx
2025-11-13 17:54:21,399 - INFO - REPORTE DE COBRANZA cargado: (207, 68)
2025-11-13 17:54:21,399 - INFO - Columnas: ['regional', 'regional1', 'coordinacion', 'coordinacion1', 'de_credito', 'de_credito1', 'gpo', 'cliente_grupo', 'unnamed:_8', 'del_cliente']...
2025-11-13 17:54:21,400 - INFO - Cargando AHORROS (ACUMULADO) desde: data/AHORROS.xlsx
2025-11-13 17:54:21,441 - INFO - AHORROS cargado: (208, 4)
2025-11-13 17:54:21,441 - INFO - Columnas: ['id', 'grupo', 'ciclo', 'ahorro_acumulado']
2025-11-13 17:54:21,442 - INFO - PARCHE PROMOTORES cargado: 1 correcciones
2025-11-13 17:54:21,442 - INFO - 
--- PASO 2: GENERACIÓN DE CARTERA ---
2025-11-13 17:54:21,442 - INFO - Iniciando generación de cartera (VERSIÓN CORREGIDA)...
2025-11-13 17:54:21,442 - INFO - Registros en antiguedad: 206
2025-11-13 17:54:21,445 - INFO - ID de grupo generados: 0    000089
1    000145
2    000069
3    000079
4    000104
Name: id_de_grupo, dtype: object
2025-11-13 17:54:21,471 - INFO - Después de joins: 208 registros
2025-11-13 17:54:21,472 - INFO - NaN en situacion: 2
2025-11-13 17:54:21,472 - INFO - NaN en cobranza: 1
2025-11-13 17:54:21,473 - INFO - NaN en ahorros: 3
2025-11-13 17:54:21,474 - INFO - Parche aplicado: 1 correcciones
2025-11-13 17:54:21,485 - INFO - Estatus calculados: {'Vigente': 208}
2025-11-13 17:54:21,487 - INFO - Cartera vigente sistema calculada como: saldo_total (de ANTIGÜEDAD)
2025-11-13 17:54:21,506 - INFO - Cartera generada exitosamente: 208 filas x 36 columnas
2025-11-13 17:54:21,506 - INFO - 
--- PASO 3: GUARDADO DE RESULTADO CON FORMATO ---
2025-11-13 17:54:21,507 - INFO - ================================================================================
2025-11-13 17:54:21,507 - INFO - GUARDANDO DATAFRAME CON FORMATO
2025-11-13 17:54:21,507 - INFO - ================================================================================
2025-11-13 17:54:21,507 - INFO - 
1. Cargando plantilla de headers: plantilla/CARTERA_HEADERS.xlsx
2025-11-13 17:54:21,517 - INFO - Plantilla cargada: 6 filas x 36 columnas (6.1 KB)
2025-11-13 17:54:21,517 - INFO - 
2. Creando nuevo workbook...
2025-11-13 17:54:21,519 - INFO - 
3. Copiando headers desde plantilla...
2025-11-13 17:54:21,519 - INFO - Copiando headers (filas 1-6) con formato...
2025-11-13 17:54:21,565 - INFO - Headers copiados: 36 columnas
2025-11-13 17:54:21,565 - INFO - 
4. Pegando datos del DataFrame...
2025-11-13 17:54:21,565 - INFO - Pegando DataFrame (208 filas x 36 columnas) desde fila 7...
2025-11-13 17:54:21,619 - INFO - Datos pegados hasta fila 214
2025-11-13 17:54:21,619 - INFO - 
5. Aplicando formatos de columnas...
2025-11-13 17:54:21,619 - INFO - Aplicando formatos de columnas desde fila 7 hasta 214...
2025-11-13 17:54:21,629 - INFO - Formatos aplicados a 208 filas
2025-11-13 17:54:21,629 - INFO - 
6. Creando tabla de Excel con totales...
2025-11-13 17:54:21,629 - INFO - Creando tabla Excel 'TablaCartera' desde fila 6 hasta 214...
2025-11-13 17:54:21,629 - INFO - Rango de tabla: A6:AJ215
2025-11-13 17:54:21,629 - INFO - Fila de totales: 215
2025-11-13 17:54:21,629 - INFO - Nombres de columnas extraídos: 36
2025-11-13 17:54:21,630 - INFO -   Columna 6 'Monto del crédito': SUM
2025-11-13 17:54:21,630 - INFO -   Columna 13 'Pago Semanal': SUM
2025-11-13 17:54:21,630 - INFO -   Columna 15 'Cartera vigente sistema': SUM
2025-11-13 17:54:21,630 - INFO -   Columna 16 'Carera vigente inicial': SUM
2025-11-13 17:54:21,630 - INFO -   Columna 17 'Cartera vigente calculada': SUM
2025-11-13 17:54:21,630 - INFO -   Columna 18 'Cartera Insoluta': SUM
2025-11-13 17:54:21,630 - INFO -   Columna 19 'Diferencia Validación vigente': SUM
2025-11-13 17:54:21,630 - INFO -   Columna 20 'Ahorro Consumido': SUM
2025-11-13 17:54:21,630 - INFO -   Columna 21 'Cartera Vencida Estadistica': SUM
2025-11-13 17:54:21,630 - INFO -   Columna 22 'Cartera vencida Total': SUM
2025-11-13 17:54:21,631 - INFO -   Columna 24 'Saldo en riesgo': SUM
2025-11-13 17:54:21,631 - INFO -   Columna 25 'Saldo 
ahorro 
acumulado': SUM
2025-11-13 17:54:21,631 - INFO -   Columna 26 'Monto promedio del grupo': SUM
2025-11-13 17:54:21,631 - INFO -   Columna 33 'Ahorro Acumulado': SUM
2025-11-13 17:54:21,631 - INFO - Filtros automáticos habilitados en rango: A6:AJ6
2025-11-13 17:54:21,631 - INFO - Escribiendo fórmulas en fila de totales...
2025-11-13 17:54:21,632 - INFO -   Fórmula en columna 6: =SUBTOTAL(109,F7:F214)
2025-11-13 17:54:21,632 - INFO -   Fórmula en columna 13: =SUBTOTAL(109,M7:M214)
2025-11-13 17:54:21,632 - INFO -   Fórmula en columna 15: =SUBTOTAL(109,O7:O214)
2025-11-13 17:54:21,632 - INFO -   Fórmula en columna 16: =SUBTOTAL(109,P7:P214)
2025-11-13 17:54:21,632 - INFO -   Fórmula en columna 17: =SUBTOTAL(109,Q7:Q214)
2025-11-13 17:54:21,632 - INFO -   Fórmula en columna 18: =SUBTOTAL(109,R7:R214)
2025-11-13 17:54:21,632 - INFO -   Fórmula en columna 19: =SUBTOTAL(109,S7:S214)
2025-11-13 17:54:21,632 - INFO -   Fórmula en columna 20: =SUBTOTAL(109,T7:T214)
2025-11-13 17:54:21,633 - INFO -   Fórmula en columna 21: =SUBTOTAL(109,U7:U214)
2025-11-13 17:54:21,633 - INFO -   Fórmula en columna 22: =SUBTOTAL(109,V7:V214)
2025-11-13 17:54:21,633 - INFO -   Fórmula en columna 24: =SUBTOTAL(109,X7:X214)
2025-11-13 17:54:21,633 - INFO -   Fórmula en columna 25: =SUBTOTAL(109,Y7:Y214)
2025-11-13 17:54:21,633 - INFO -   Fórmula en columna 26: =SUBTOTAL(109,Z7:Z214)
2025-11-13 17:54:21,633 - INFO -   Fórmula en columna 33: =SUBTOTAL(109,AG7:AG214)
2025-11-13 17:54:21,633 - INFO - Tabla creada exitosamente con 208 filas de datos + fila totales
2025-11-13 17:54:21,633 - INFO - Totales configurados en 14 columnas con fórmulas SUBTOTAL
2025-11-13 17:54:21,634 - INFO - Fila de totales: Formato aplicado automáticamente por la tabla
2025-11-13 17:54:21,634 - INFO - 
6.1. Congelando paneles para mantener encabezados visibles...
2025-11-13 17:54:21,634 - INFO - Paneles congelados: Filas 1-6 siempre visibles
2025-11-13 17:54:21,634 - INFO - 
7. Guardando archivo: output_automatizado.xlsx
2025-11-13 17:54:21,821 - INFO - 
================================================================================
2025-11-13 17:54:21,821 - INFO - ARCHIVO GUARDADO EXITOSAMENTE
2025-11-13 17:54:21,821 - INFO - ================================================================================
2025-11-13 17:54:21,821 - INFO - 
Archivo: output_automatizado.xlsx
2025-11-13 17:54:21,821 - INFO - Filas de datos: 208
2025-11-13 17:54:21,821 - INFO - Columnas: 36
2025-11-13 17:54:21,821 - INFO - Formato: Idéntico al machote
2025-11-13 17:54:21,821 - INFO - Tabla Excel: Con totales automáticos y filtros
2025-11-13 17:54:21,821 - INFO - Encabezados: Siempre visibles (paneles congelados)
2025-11-13 17:54:21,821 - INFO - ================================================================================
2025-11-13 17:54:21,821 - INFO - OK - Archivo guardado con formato: output_automatizado.xlsx
2025-11-13 17:54:21,821 - INFO - 
--- PASO 4: GENERACIÓN DE HOJA MORA ---
2025-11-13 17:54:21,822 - INFO - 
Iniciando generación de hoja MORA...
2025-11-13 17:54:21,823 - INFO - Registros con %mora > 5%: 7 de 208
2025-11-13 17:54:21,827 - INFO - Hoja MORA generada con 7 registros y 14 columnas
2025-11-13 17:54:21,828 - INFO - 
================================================================================
2025-11-13 17:54:21,828 - INFO - AGREGANDO HOJA MORA
2025-11-13 17:54:21,828 - INFO - ================================================================================
2025-11-13 17:54:21,828 - INFO - 
1. Abriendo archivo: output_automatizado.xlsx
2025-11-13 17:54:22,045 - INFO - 
2. Creando hoja 'Mora'
2025-11-13 17:54:22,045 - INFO - 
3. Copiando formato de headers desde plantilla
2025-11-13 17:54:22,068 - INFO - 
4. Estableciendo headers de MORA
2025-11-13 17:54:22,068 - INFO - 
5. Pegando 7 filas de datos
2025-11-13 17:54:22,070 - INFO - 
6. Creando tabla Excel con totales
2025-11-13 17:54:22,070 - INFO -    Creando tabla: A6:N14
2025-11-13 17:54:22,071 - INFO -    Tabla 'TablaMora' creada con totales automáticos
2025-11-13 17:54:22,071 - INFO -    Filtros automáticos habilitados en rango: A6:N6
2025-11-13 17:54:22,071 - INFO -    Fórmulas SUBTOTAL escritas en 6 columnas
2025-11-13 17:54:22,071 - INFO - 
6.1. Congelando paneles para mantener encabezados visibles...
2025-11-13 17:54:22,071 - INFO - Paneles congelados: Filas 1-6 siempre visibles
2025-11-13 17:54:22,071 - INFO - 
7. Guardando archivo con hoja MORA
2025-11-13 17:54:22,243 - INFO - 
================================================================================
2025-11-13 17:54:22,243 - INFO - HOJA MORA AGREGADA EXITOSAMENTE
2025-11-13 17:54:22,244 - INFO - ================================================================================
2025-11-13 17:54:22,244 - INFO - 
Registros en MORA: 7
2025-11-13 17:54:22,244 - INFO - Filtro: %mora > 5%
2025-11-13 17:54:22,244 - INFO - Columnas amarillas: %mora, Días de mora
2025-11-13 17:54:22,244 - INFO - Tabla Excel: Con totales automáticos y filtros
2025-11-13 17:54:22,244 - INFO - Encabezados: Siempre visibles (paneles congelados)
2025-11-13 17:54:22,244 - INFO - ================================================================================
2025-11-13 17:54:22,244 - INFO - OK - Hoja MORA agregada con 7 registros
2025-11-13 17:54:22,244 - INFO - 
--- PASO 5: VALIDACIÓN ---
2025-11-13 17:54:22,245 - INFO - Machote no encontrado - validación omitida (no es necesario)
2025-11-13 17:54:22,245 - INFO - 
================================================================================
2025-11-13 17:54:22,245 - INFO - AUTOMATIZACIÓN COMPLETADA EXITOSAMENTE
2025-11-13 17:54:22,245 - INFO - ================================================================================
2025-11-17 16:44:29,494 - INFO - ================================================================================
2025-11-17 16:44:29,497 - INFO - INICIO DE AUTOMATIZACIÓN DE CARTERA
2025-11-17 16:44:29,497 - INFO - ================================================================================
2025-11-17 16:44:29,500 - INFO - 
--- PASO 0: BÚSQUEDA DE ARCHIVOS ---
2025-11-17 16:44:29,503 - INFO - Archivo encontrado: data\ReportedeAntiguedaddeCarteraGrupal_12112025.xlsx
2025-11-17 16:44:29,506 - INFO - Archivo encontrado: data\Situación_de_cartera_12112025.xlsx
2025-11-17 16:44:29,507 - INFO - Archivo encontrado: data\Cobranza_12112025.xlsx
2025-11-17 16:44:29,509 - INFO - Archivo encontrado: data/AHORROS.xlsx
2025-11-17 16:44:29,510 - INFO - 
--- PASO 1: CARGA DE ARCHIVOS ---
2025-11-17 16:44:29,511 - INFO - Cargando ANTIGÜEDAD desde: data\ReportedeAntiguedaddeCarteraGrupal_12112025.xlsx
2025-11-17 16:44:29,649 - INFO - Hoja detectada: '121125'
2025-11-17 16:44:30,260 - INFO - ANTIGÜEDAD cargado: (206, 59)
2025-11-17 16:44:30,261 - INFO - Columnas: ['cod_region', 'coordinacion', 'nombre_de_gerente', 'codigo_promotor', 'nombre_promotor', 'codigo_recuperador', 'nombre_recuperador', 'cod_grupo_solidario', 'ciclo', 'grupo_solidario']...
2025-11-17 16:44:30,269 - INFO - No se encontraron IDs duplicados
2025-11-17 16:44:30,269 - INFO - Cargando SITUACIÓN DE CARTERA desde: data\Situación_de_cartera_12112025.xlsx
2025-11-17 16:44:30,822 - INFO - SITUACIÓN DE CARTERA cargada: (206, 43)
2025-11-17 16:44:30,823 - INFO - Columnas: ['codigo_ofic_cred', 'nombre_oficial_de_credito', 'codigo_promotor_cred', 'nombre_promotor_cred', 'codigo_coord', 'nombre_coordinacion', 'codigo_ger_regi', 'nombre_gerencia_regional', 'nombre_codigo', 'nombre_acreditado_cliente']...
2025-11-17 16:44:30,832 - INFO - Columna de código renombrada: nombre_codigo -> codigo
2025-11-17 16:44:30,839 - INFO - Cargando REPORTE DE COBRANZA desde: data\Cobranza_12112025.xlsx
2025-11-17 16:44:31,651 - INFO - REPORTE DE COBRANZA cargado: (207, 68)
2025-11-17 16:44:31,651 - INFO - Columnas: ['regional', 'regional1', 'coordinacion', 'coordinacion1', 'de_credito', 'de_credito1', 'gpo', 'cliente_grupo', 'unnamed:_8', 'del_cliente']...
2025-11-17 16:44:31,653 - INFO - Cargando AHORROS (ACUMULADO) desde: data/AHORROS.xlsx
2025-11-17 16:44:31,818 - INFO - AHORROS cargado: (208, 4)
2025-11-17 16:44:31,819 - INFO - Columnas: ['id', 'grupo', 'ciclo', 'ahorro_acumulado']
2025-11-17 16:44:31,821 - INFO - PARCHE PROMOTORES cargado: 1 correcciones
2025-11-17 16:44:31,822 - INFO - 
--- PASO 2: GENERACIÓN DE CARTERA ---
2025-11-17 16:44:31,823 - INFO - Iniciando generación de cartera (VERSIÓN CORREGIDA)...
2025-11-17 16:44:31,823 - INFO - Registros en antiguedad: 206
2025-11-17 16:44:31,829 - INFO - ID de grupo generados: 0    000089
1    000145
2    000069
3    000079
4    000104
Name: id_de_grupo, dtype: object
2025-11-17 16:44:31,902 - INFO - Después de joins: 208 registros
2025-11-17 16:44:31,905 - INFO - NaN en situacion: 2
2025-11-17 16:44:31,906 - INFO - NaN en cobranza: 1
2025-11-17 16:44:31,907 - INFO - NaN en ahorros: 3
2025-11-17 16:44:31,914 - INFO - Parche aplicado: 1 correcciones
2025-11-17 16:44:31,946 - INFO - Estatus calculados: {'Vigente': 208}
2025-11-17 16:44:31,951 - INFO - Cartera vigente sistema calculada como: saldo_total (de ANTIGÜEDAD)
2025-11-17 16:44:32,023 - INFO - Cartera generada exitosamente: 208 filas x 36 columnas
2025-11-17 16:44:32,025 - INFO - 
--- PASO 3: GUARDADO DE RESULTADO CON FORMATO ---
2025-11-17 16:44:32,026 - INFO - ================================================================================
2025-11-17 16:44:32,026 - INFO - GUARDANDO DATAFRAME CON FORMATO
2025-11-17 16:44:32,027 - INFO - ================================================================================
2025-11-17 16:44:32,027 - INFO - 
1. Cargando plantilla de headers: plantilla/CARTERA_HEADERS.xlsx
2025-11-17 16:44:32,066 - INFO - Plantilla cargada: 6 filas x 36 columnas (6.1 KB)
2025-11-17 16:44:32,067 - INFO - 
2. Creando nuevo workbook...
2025-11-17 16:44:32,073 - INFO - 
3. Copiando headers desde plantilla...
2025-11-17 16:44:32,073 - INFO - Copiando headers (filas 1-6) con formato...
2025-11-17 16:44:32,268 - INFO - Headers copiados: 36 columnas
2025-11-17 16:44:32,269 - INFO - 
4. Pegando datos del DataFrame...
2025-11-17 16:44:32,269 - INFO - Pegando DataFrame (208 filas x 36 columnas) desde fila 7...
2025-11-17 16:44:32,481 - INFO - Datos pegados hasta fila 214
2025-11-17 16:44:32,482 - INFO - 
5. Aplicando formatos de columnas...
2025-11-17 16:44:32,482 - INFO - Aplicando formatos de columnas desde fila 7 hasta 214...
2025-11-17 16:44:32,513 - INFO - Formatos aplicados a 208 filas
2025-11-17 16:44:32,514 - INFO - 
6. Creando tabla de Excel con totales...
2025-11-17 16:44:32,514 - INFO - Creando tabla Excel 'TablaCartera' desde fila 6 hasta 214...
2025-11-17 16:44:32,515 - INFO - Rango de tabla: A6:AJ215
2025-11-17 16:44:32,515 - INFO - Fila de totales: 215
2025-11-17 16:44:32,516 - INFO - Nombres de columnas extraídos: 36
2025-11-17 16:44:32,516 - INFO -   Columna 6 'Monto del crédito': SUM
2025-11-17 16:44:32,517 - INFO -   Columna 13 'Pago Semanal': SUM
2025-11-17 16:44:32,518 - INFO -   Columna 15 'Cartera vigente sistema': SUM
2025-11-17 16:44:32,518 - INFO -   Columna 16 'Carera vigente inicial': SUM
2025-11-17 16:44:32,519 - INFO -   Columna 17 'Cartera vigente calculada': SUM
2025-11-17 16:44:32,519 - INFO -   Columna 18 'Cartera Insoluta': SUM
2025-11-17 16:44:32,520 - INFO -   Columna 19 'Diferencia Validación vigente': SUM
2025-11-17 16:44:32,522 - INFO -   Columna 20 'Ahorro Consumido': SUM
2025-11-17 16:44:32,523 - INFO -   Columna 21 'Cartera Vencida Estadistica': SUM
2025-11-17 16:44:32,524 - INFO -   Columna 22 'Cartera vencida Total': SUM
2025-11-17 16:44:32,528 - INFO -   Columna 24 'Saldo en riesgo': SUM
2025-11-17 16:44:32,529 - INFO -   Columna 25 'Saldo 
ahorro 
acumulado': SUM
2025-11-17 16:44:32,531 - INFO -   Columna 26 'Monto promedio del grupo': SUM
2025-11-17 16:44:32,532 - INFO -   Columna 33 'Ahorro Acumulado': SUM
2025-11-17 16:44:32,533 - INFO - Filtros automáticos habilitados en rango: A6:AJ6
2025-11-17 16:44:32,534 - INFO - Escribiendo fórmulas en fila de totales...
2025-11-17 16:44:32,534 - INFO -   Fórmula en columna 6: =SUBTOTAL(109,F7:F214)
2025-11-17 16:44:32,535 - INFO -   Fórmula en columna 13: =SUBTOTAL(109,M7:M214)
2025-11-17 16:44:32,536 - INFO -   Fórmula en columna 15: =SUBTOTAL(109,O7:O214)
2025-11-17 16:44:32,536 - INFO -   Fórmula en columna 16: =SUBTOTAL(109,P7:P214)
2025-11-17 16:44:32,537 - INFO -   Fórmula en columna 17: =SUBTOTAL(109,Q7:Q214)
2025-11-17 16:44:32,537 - INFO -   Fórmula en columna 18: =SUBTOTAL(109,R7:R214)
2025-11-17 16:44:32,538 - INFO -   Fórmula en columna 19: =SUBTOTAL(109,S7:S214)
2025-11-17 16:44:32,539 - INFO -   Fórmula en columna 20: =SUBTOTAL(109,T7:T214)
2025-11-17 16:44:32,539 - INFO -   Fórmula en columna 21: =SUBTOTAL(109,U7:U214)
2025-11-17 16:44:32,540 - INFO -   Fórmula en columna 22: =SUBTOTAL(109,V7:V214)
2025-11-17 16:44:32,541 - INFO -   Fórmula en columna 24: =SUBTOTAL(109,X7:X214)
2025-11-17 16:44:32,541 - INFO -   Fórmula en columna 25: =SUBTOTAL(109,Y7:Y214)
2025-11-17 16:44:32,541 - INFO -   Fórmula en columna 26: =SUBTOTAL(109,Z7:Z214)
2025-11-17 16:44:32,542 - INFO -   Fórmula en columna 33: =SUBTOTAL(109,AG7:AG214)
2025-11-17 16:44:32,543 - INFO - Tabla creada exitosamente con 208 filas de datos + fila totales
2025-11-17 16:44:32,543 - INFO - Totales configurados en 14 columnas con fórmulas SUBTOTAL
2025-11-17 16:44:32,544 - INFO - Fila de totales: Formato aplicado automáticamente por la tabla
2025-11-17 16:44:32,544 - INFO - 
6.1. Congelando paneles para mantener encabezados visibles...
2025-11-17 16:44:32,545 - INFO - Paneles congelados: Filas 1-6 siempre visibles
2025-11-17 16:44:32,545 - INFO - 
7. Guardando archivo: output_automatizado.xlsx
2025-11-17 16:44:32,547 - ERROR - 
ERROR: [Errno 13] Permission denied: 'output_automatizado.xlsx'
Traceback (most recent call last):
  File "C:\Users\uzzie\Documents\Jale\merge-dataframes\analizar_y_automatizar.py", line 314, in main
    guardar_con_formato(df_cartera, RUTA_PLANTILLA, RUTA_OUTPUT)
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\uzzie\Documents\Jale\merge-dataframes\formato_excel.py", line 385, in guardar_con_formato
    wb_nuevo.save(ruta_output)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\uzzie\miniconda3\Lib\site-packages\openpyxl\workbook\workbook.py", line 386, in save
    save_workbook(self, filename)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "C:\Users\uzzie\miniconda3\Lib\site-packages\openpyxl\writer\excel.py", line 291, in save_workbook
    archive = ZipFile(filename, 'w', ZIP_DEFLATED, allowZip64=True)
  File "C:\Users\uzzie\miniconda3\Lib\zipfile\__init__.py", line 1367, in __init__
    self.fp = io.open(file, filemode)
              ~~~~~~~^^^^^^^^^^^^^^^^
PermissionError: [Errno 13] Permission denied: 'output_automatizado.xlsx'
2025-11-17 16:45:29,639 - INFO - ================================================================================
2025-11-17 16:45:29,639 - INFO - INICIO DE AUTOMATIZACIÓN DE CARTERA
2025-11-17 16:45:29,639 - INFO - ================================================================================
2025-11-17 16:45:29,639 - INFO - 
--- PASO 0: BÚSQUEDA DE ARCHIVOS ---
2025-11-17 16:45:29,640 - INFO - Archivo encontrado: data\ReportedeAntiguedaddeCarteraGrupal_12112025.xlsx
2025-11-17 16:45:29,640 - INFO - Archivo encontrado: data\Situación_de_cartera_12112025.xlsx
2025-11-17 16:45:29,641 - INFO - Archivo encontrado: data\Cobranza_12112025.xlsx
2025-11-17 16:45:29,641 - INFO - Archivo encontrado: data/AHORROS.xlsx
2025-11-17 16:45:29,641 - INFO - 
--- PASO 1: CARGA DE ARCHIVOS ---
2025-11-17 16:45:29,641 - INFO - Cargando ANTIGÜEDAD desde: data\ReportedeAntiguedaddeCarteraGrupal_12112025.xlsx
2025-11-17 16:45:29,663 - INFO - Hoja detectada: '121125'
2025-11-17 16:45:29,820 - INFO - ANTIGÜEDAD cargado: (206, 59)
2025-11-17 16:45:29,820 - INFO - Columnas: ['cod_region', 'coordinacion', 'nombre_de_gerente', 'codigo_promotor', 'nombre_promotor', 'codigo_recuperador', 'nombre_recuperador', 'cod_grupo_solidario', 'ciclo', 'grupo_solidario']...
2025-11-17 16:45:29,821 - INFO - No se encontraron IDs duplicados
2025-11-17 16:45:29,821 - INFO - Cargando SITUACIÓN DE CARTERA desde: data\Situación_de_cartera_12112025.xlsx
2025-11-17 16:45:29,942 - INFO - SITUACIÓN DE CARTERA cargada: (206, 43)
2025-11-17 16:45:29,942 - INFO - Columnas: ['codigo_ofic_cred', 'nombre_oficial_de_credito', 'codigo_promotor_cred', 'nombre_promotor_cred', 'codigo_coord', 'nombre_coordinacion', 'codigo_ger_regi', 'nombre_gerencia_regional', 'nombre_codigo', 'nombre_acreditado_cliente']...
2025-11-17 16:45:29,943 - INFO - Columna de código renombrada: nombre_codigo -> codigo
2025-11-17 16:45:29,944 - INFO - Cargando REPORTE DE COBRANZA desde: data\Cobranza_12112025.xlsx
2025-11-17 16:45:30,131 - INFO - REPORTE DE COBRANZA cargado: (207, 68)
2025-11-17 16:45:30,131 - INFO - Columnas: ['regional', 'regional1', 'coordinacion', 'coordinacion1', 'de_credito', 'de_credito1', 'gpo', 'cliente_grupo', 'unnamed:_8', 'del_cliente']...
2025-11-17 16:45:30,131 - INFO - Cargando AHORROS (ACUMULADO) desde: data/AHORROS.xlsx
2025-11-17 16:45:30,171 - INFO - AHORROS cargado: (208, 4)
2025-11-17 16:45:30,171 - INFO - Columnas: ['id', 'grupo', 'ciclo', 'ahorro_acumulado']
2025-11-17 16:45:30,172 - INFO - PARCHE PROMOTORES cargado: 1 correcciones
2025-11-17 16:45:30,172 - INFO - 
--- PASO 2: GENERACIÓN DE CARTERA ---
2025-11-17 16:45:30,172 - INFO - Iniciando generación de cartera (VERSIÓN CORREGIDA)...
2025-11-17 16:45:30,172 - INFO - Registros en antiguedad: 206
2025-11-17 16:45:30,174 - INFO - ID de grupo generados: 0    000089
1    000145
2    000069
3    000079
4    000104
Name: id_de_grupo, dtype: object
2025-11-17 16:45:30,189 - INFO - Después de joins: 208 registros
2025-11-17 16:45:30,190 - INFO - NaN en situacion: 2
2025-11-17 16:45:30,190 - INFO - NaN en cobranza: 1
2025-11-17 16:45:30,190 - INFO - NaN en ahorros: 3
2025-11-17 16:45:30,192 - INFO - Parche aplicado: 1 correcciones
2025-11-17 16:45:30,199 - INFO - Estatus calculados: {'Vigente': 208}
2025-11-17 16:45:30,200 - INFO - Cartera vigente sistema calculada como: saldo_total (de ANTIGÜEDAD)
2025-11-17 16:45:30,218 - INFO - Cartera generada exitosamente: 208 filas x 36 columnas
2025-11-17 16:45:30,218 - INFO - 
--- PASO 3: GUARDADO DE RESULTADO CON FORMATO ---
2025-11-17 16:45:30,218 - INFO - ================================================================================
2025-11-17 16:45:30,218 - INFO - GUARDANDO DATAFRAME CON FORMATO
2025-11-17 16:45:30,219 - INFO - ================================================================================
2025-11-17 16:45:30,219 - INFO - 
1. Cargando plantilla de headers: plantilla/CARTERA_HEADERS.xlsx
2025-11-17 16:45:30,227 - INFO - Plantilla cargada: 6 filas x 36 columnas (6.1 KB)
2025-11-17 16:45:30,227 - INFO - 
2. Creando nuevo workbook...
2025-11-17 16:45:30,228 - INFO - 
3. Copiando headers desde plantilla...
2025-11-17 16:45:30,229 - INFO - Copiando headers (filas 1-6) con formato...
2025-11-17 16:45:30,268 - INFO - Headers copiados: 36 columnas
2025-11-17 16:45:30,268 - INFO - 
4. Pegando datos del DataFrame...
2025-11-17 16:45:30,268 - INFO - Pegando DataFrame (208 filas x 36 columnas) desde fila 7...
2025-11-17 16:45:30,312 - INFO - Datos pegados hasta fila 214
2025-11-17 16:45:30,313 - INFO - 
5. Aplicando formatos de columnas...
2025-11-17 16:45:30,313 - INFO - Aplicando formatos de columnas desde fila 7 hasta 214...
2025-11-17 16:45:30,323 - INFO - Formatos aplicados a 208 filas
2025-11-17 16:45:30,324 - INFO - 
6. Creando tabla de Excel con totales...
2025-11-17 16:45:30,324 - INFO - Creando tabla Excel 'TablaCartera' desde fila 6 hasta 214...
2025-11-17 16:45:30,324 - INFO - Rango de tabla: A6:AJ215
2025-11-17 16:45:30,324 - INFO - Fila de totales: 215
2025-11-17 16:45:30,324 - INFO - Nombres de columnas extraídos: 36
2025-11-17 16:45:30,324 - INFO -   Columna 6 'Monto del crédito': SUM
2025-11-17 16:45:30,324 - INFO -   Columna 13 'Pago Semanal': SUM
2025-11-17 16:45:30,325 - INFO -   Columna 15 'Cartera vigente sistema': SUM
2025-11-17 16:45:30,325 - INFO -   Columna 16 'Carera vigente inicial': SUM
2025-11-17 16:45:30,325 - INFO -   Columna 17 'Cartera vigente calculada': SUM
2025-11-17 16:45:30,325 - INFO -   Columna 18 'Cartera Insoluta': SUM
2025-11-17 16:45:30,325 - INFO -   Columna 19 'Diferencia Validación vigente': SUM
2025-11-17 16:45:30,325 - INFO -   Columna 20 'Ahorro Consumido': SUM
2025-11-17 16:45:30,325 - INFO -   Columna 21 'Cartera Vencida Estadistica': SUM
2025-11-17 16:45:30,325 - INFO -   Columna 22 'Cartera vencida Total': SUM
2025-11-17 16:45:30,325 - INFO -   Columna 24 'Saldo en riesgo': SUM
2025-11-17 16:45:30,326 - INFO -   Columna 25 'Saldo 
ahorro 
acumulado': SUM
2025-11-17 16:45:30,326 - INFO -   Columna 26 'Monto promedio del grupo': SUM
2025-11-17 16:45:30,326 - INFO -   Columna 33 'Ahorro Acumulado': SUM
2025-11-17 16:45:30,326 - INFO - Filtros automáticos habilitados en rango: A6:AJ6
2025-11-17 16:45:30,326 - INFO - Escribiendo fórmulas en fila de totales...
2025-11-17 16:45:30,326 - INFO -   Fórmula en columna 6: =SUBTOTAL(109,F7:F214)
2025-11-17 16:45:30,326 - INFO -   Fórmula en columna 13: =SUBTOTAL(109,M7:M214)
2025-11-17 16:45:30,326 - INFO -   Fórmula en columna 15: =SUBTOTAL(109,O7:O214)
2025-11-17 16:45:30,326 - INFO -   Fórmula en columna 16: =SUBTOTAL(109,P7:P214)
2025-11-17 16:45:30,327 - INFO -   Fórmula en columna 17: =SUBTOTAL(109,Q7:Q214)
2025-11-17 16:45:30,327 - INFO -   Fórmula en columna 18: =SUBTOTAL(109,R7:R214)
2025-11-17 16:45:30,327 - INFO -   Fórmula en columna 19: =SUBTOTAL(109,S7:S214)
2025-11-17 16:45:30,327 - INFO -   Fórmula en columna 20: =SUBTOTAL(109,T7:T214)
2025-11-17 16:45:30,327 - INFO -   Fórmula en columna 21: =SUBTOTAL(109,U7:U214)
2025-11-17 16:45:30,327 - INFO -   Fórmula en columna 22: =SUBTOTAL(109,V7:V214)
2025-11-17 16:45:30,327 - INFO -   Fórmula en columna 24: =SUBTOTAL(109,X7:X214)
2025-11-17 16:45:30,327 - INFO -   Fórmula en columna 25: =SUBTOTAL(109,Y7:Y214)
2025-11-17 16:45:30,327 - INFO -   Fórmula en columna 26: =SUBTOTAL(109,Z7:Z214)
2025-11-17 16:45:30,327 - INFO -   Fórmula en columna 33: =SUBTOTAL(109,AG7:AG214)
2025-11-17 16:45:30,327 - INFO - Tabla creada exitosamente con 208 filas de datos + fila totales
2025-11-17 16:45:30,327 - INFO - Totales configurados en 14 columnas con fórmulas SUBTOTAL
2025-11-17 16:45:30,327 - INFO - Fila de totales: Formato aplicado automáticamente por la tabla
2025-11-17 16:45:30,327 - INFO - 
6.1. Congelando paneles para mantener encabezados visibles...
2025-11-17 16:45:30,327 - INFO - Paneles congelados: Filas 1-6 siempre visibles
2025-11-17 16:45:30,328 - INFO - 
7. Guardando archivo: output_automatizado.xlsx
2025-11-17 16:45:30,488 - INFO - 
================================================================================
2025-11-17 16:45:30,488 - INFO - ARCHIVO GUARDADO EXITOSAMENTE
2025-11-17 16:45:30,489 - INFO - ================================================================================
2025-11-17 16:45:30,489 - INFO - 
Archivo: output_automatizado.xlsx
2025-11-17 16:45:30,489 - INFO - Filas de datos: 208
2025-11-17 16:45:30,489 - INFO - Columnas: 36
2025-11-17 16:45:30,489 - INFO - Formato: Idéntico al machote
2025-11-17 16:45:30,489 - INFO - Tabla Excel: Con totales automáticos y filtros
2025-11-17 16:45:30,489 - INFO - Encabezados: Siempre visibles (paneles congelados)
2025-11-17 16:45:30,489 - INFO - ================================================================================
2025-11-17 16:45:30,489 - INFO - OK - Archivo guardado con formato: output_automatizado.xlsx
2025-11-17 16:45:30,489 - INFO - 
--- PASO 4: GENERACIÓN DE HOJA MORA ---
2025-11-17 16:45:30,490 - INFO - 
Iniciando generación de hoja MORA...
2025-11-17 16:45:30,491 - INFO - Registros con %mora > 5%: 7 de 208
2025-11-17 16:45:30,493 - INFO - Hoja MORA generada con 7 registros y 14 columnas
2025-11-17 16:45:30,493 - INFO - 
================================================================================
2025-11-17 16:45:30,493 - INFO - AGREGANDO HOJA MORA
2025-11-17 16:45:30,493 - INFO - ================================================================================
2025-11-17 16:45:30,493 - INFO - 
1. Abriendo archivo: output_automatizado.xlsx
2025-11-17 16:45:30,692 - INFO - 
2. Creando hoja 'Mora'
2025-11-17 16:45:30,692 - INFO - 
3. Copiando formato de headers desde plantilla
2025-11-17 16:45:30,714 - INFO - 
4. Estableciendo headers de MORA
2025-11-17 16:45:30,715 - INFO - 
5. Pegando 7 filas de datos
2025-11-17 16:45:30,717 - INFO - 
6. Creando tabla Excel con totales
2025-11-17 16:45:30,717 - INFO -    Creando tabla: A6:N14
2025-11-17 16:45:30,718 - INFO -    Tabla 'TablaMora' creada con totales automáticos
2025-11-17 16:45:30,718 - INFO -    Filtros automáticos habilitados en rango: A6:N6
2025-11-17 16:45:30,718 - INFO -    Fórmulas SUBTOTAL escritas en 6 columnas
2025-11-17 16:45:30,718 - INFO - 
6.1. Congelando paneles para mantener encabezados visibles...
2025-11-17 16:45:30,718 - INFO - Paneles congelados: Filas 1-6 siempre visibles
2025-11-17 16:45:30,718 - INFO - 
7. Guardando archivo con hoja MORA
2025-11-17 16:45:30,880 - INFO - 
================================================================================
2025-11-17 16:45:30,880 - INFO - HOJA MORA AGREGADA EXITOSAMENTE
2025-11-17 16:45:30,880 - INFO - ================================================================================
2025-11-17 16:45:30,881 - INFO - 
Registros en MORA: 7
2025-11-17 16:45:30,881 - INFO - Filtro: %mora > 5%
2025-11-17 16:45:30,881 - INFO - Columnas amarillas: %mora, Días de mora
2025-11-17 16:45:30,881 - INFO - Tabla Excel: Con totales automáticos y filtros
2025-11-17 16:45:30,881 - INFO - Encabezados: Siempre visibles (paneles congelados)
2025-11-17 16:45:30,881 - INFO - ================================================================================
2025-11-17 16:45:30,881 - INFO - OK - Hoja MORA agregada con 7 registros
2025-11-17 16:45:30,881 - INFO - 
--- PASO 5: VALIDACIÓN ---
2025-11-17 16:45:30,882 - INFO - Machote no encontrado - validación omitida (no es necesario)
2025-11-17 16:45:30,882 - INFO - 
================================================================================
2025-11-17 16:45:30,882 - INFO - AUTOMATIZACIÓN COMPLETADA EXITOSAMENTE
2025-11-17 16:45:30,882 - INFO - ================================================================================
2025-11-17 16:48:01,529 - INFO - ================================================================================
2025-11-17 16:48:01,529 - INFO - INICIO DE AUTOMATIZACIÓN DE CARTERA
2025-11-17 16:48:01,529 - INFO - ================================================================================
2025-11-17 16:48:01,529 - INFO - 
--- PASO 0: BÚSQUEDA DE ARCHIVOS ---
2025-11-17 16:48:01,530 - INFO - Archivo encontrado: data\ReportedeAntiguedaddeCarteraGrupal_12112025.xlsx
2025-11-17 16:48:01,530 - INFO - Archivo encontrado: data\Situación_de_cartera_12112025.xlsx
2025-11-17 16:48:01,531 - INFO - Archivo encontrado: data\Cobranza_12112025.xlsx
2025-11-17 16:48:01,531 - INFO - Archivo encontrado: data/AHORROS.xlsx
2025-11-17 16:48:01,531 - INFO - 
--- PASO 1: CARGA DE ARCHIVOS ---
2025-11-17 16:48:01,531 - INFO - Cargando ANTIGÜEDAD desde: data\ReportedeAntiguedaddeCarteraGrupal_12112025.xlsx
2025-11-17 16:48:01,551 - INFO - Hoja detectada: '121125'
2025-11-17 16:48:01,698 - INFO - ANTIGÜEDAD cargado: (206, 59)
2025-11-17 16:48:01,698 - INFO - Columnas: ['cod_region', 'coordinacion', 'nombre_de_gerente', 'codigo_promotor', 'nombre_promotor', 'codigo_recuperador', 'nombre_recuperador', 'cod_grupo_solidario', 'ciclo', 'grupo_solidario']...
2025-11-17 16:48:01,699 - INFO - No se encontraron IDs duplicados
2025-11-17 16:48:01,699 - INFO - Cargando SITUACIÓN DE CARTERA desde: data\Situación_de_cartera_12112025.xlsx
2025-11-17 16:48:01,825 - INFO - SITUACIÓN DE CARTERA cargada: (206, 43)
2025-11-17 16:48:01,825 - INFO - Columnas: ['codigo_ofic_cred', 'nombre_oficial_de_credito', 'codigo_promotor_cred', 'nombre_promotor_cred', 'codigo_coord', 'nombre_coordinacion', 'codigo_ger_regi', 'nombre_gerencia_regional', 'nombre_codigo', 'nombre_acreditado_cliente']...
2025-11-17 16:48:01,826 - INFO - Columna de código renombrada: nombre_codigo -> codigo
2025-11-17 16:48:01,827 - INFO - Cargando REPORTE DE COBRANZA desde: data\Cobranza_12112025.xlsx
2025-11-17 16:48:02,012 - INFO - REPORTE DE COBRANZA cargado: (207, 68)
2025-11-17 16:48:02,012 - INFO - Columnas: ['regional', 'regional1', 'coordinacion', 'coordinacion1', 'de_credito', 'de_credito1', 'gpo', 'cliente_grupo', 'unnamed:_8', 'del_cliente']...
2025-11-17 16:48:02,012 - INFO - Cargando AHORROS (ACUMULADO) desde: data/AHORROS.xlsx
2025-11-17 16:48:02,049 - INFO - AHORROS cargado: (208, 4)
2025-11-17 16:48:02,049 - INFO - Columnas: ['id', 'grupo', 'ciclo', 'ahorro_acumulado']
2025-11-17 16:48:02,050 - INFO - PARCHE PROMOTORES cargado: 1 correcciones
2025-11-17 16:48:02,050 - INFO - 
--- PASO 2: GENERACIÓN DE CARTERA ---
2025-11-17 16:48:02,050 - INFO - Iniciando generación de cartera (VERSIÓN CORREGIDA)...
2025-11-17 16:48:02,050 - INFO - Registros en antiguedad: 206
2025-11-17 16:48:02,052 - INFO - ID de grupo generados: 0    000089
1    000145
2    000069
3    000079
4    000104
Name: id_de_grupo, dtype: object
2025-11-17 16:48:02,068 - INFO - Después de joins: 208 registros
2025-11-17 16:48:02,068 - INFO - NaN en situacion: 2
2025-11-17 16:48:02,069 - INFO - NaN en cobranza: 1
2025-11-17 16:48:02,069 - INFO - NaN en ahorros: 3
2025-11-17 16:48:02,070 - INFO - Parche aplicado: 1 correcciones
2025-11-17 16:48:02,078 - INFO - Estatus calculados: {'Vigente': 208}
2025-11-17 16:48:02,079 - INFO - Cartera vigente sistema calculada como: saldo_total (de ANTIGÜEDAD)
2025-11-17 16:48:02,094 - INFO - Cartera generada exitosamente: 208 filas x 36 columnas
2025-11-17 16:48:02,094 - INFO - 
--- PASO 3: GUARDADO DE RESULTADO CON FORMATO ---
2025-11-17 16:48:02,094 - INFO - ================================================================================
2025-11-17 16:48:02,094 - INFO - GUARDANDO DATAFRAME CON FORMATO
2025-11-17 16:48:02,094 - INFO - ================================================================================
2025-11-17 16:48:02,094 - INFO - 
1. Cargando plantilla de headers: plantilla/CARTERA_HEADERS.xlsx
2025-11-17 16:48:02,103 - INFO - Plantilla cargada: 6 filas x 36 columnas (6.1 KB)
2025-11-17 16:48:02,103 - INFO - 
2. Creando nuevo workbook...
2025-11-17 16:48:02,105 - INFO - 
3. Copiando headers desde plantilla...
2025-11-17 16:48:02,105 - INFO - Copiando headers (filas 1-6) con formato...
2025-11-17 16:48:02,158 - INFO - Headers copiados: 36 columnas
2025-11-17 16:48:02,158 - INFO - 
4. Pegando datos del DataFrame...
2025-11-17 16:48:02,158 - INFO - Pegando DataFrame (208 filas x 36 columnas) desde fila 7...
2025-11-17 16:48:02,205 - INFO - Datos pegados hasta fila 214
2025-11-17 16:48:02,205 - INFO - 
5. Aplicando formatos de columnas...
2025-11-17 16:48:02,205 - INFO - Aplicando formatos de columnas desde fila 7 hasta 214...
2025-11-17 16:48:02,217 - INFO - Formatos aplicados a 208 filas
2025-11-17 16:48:02,217 - INFO - 
6. Creando tabla de Excel con totales...
2025-11-17 16:48:02,218 - INFO - Creando tabla Excel 'TablaCartera' desde fila 6 hasta 214...
2025-11-17 16:48:02,218 - INFO - Rango de tabla: A6:AJ215
2025-11-17 16:48:02,218 - INFO - Fila de totales: 215
2025-11-17 16:48:02,218 - INFO - Nombres de columnas extraídos: 36
2025-11-17 16:48:02,218 - INFO -   Columna 6 'Monto del crédito': SUM
2025-11-17 16:48:02,218 - INFO -   Columna 13 'Pago Semanal': SUM
2025-11-17 16:48:02,218 - INFO -   Columna 15 'Cartera vigente sistema': SUM
2025-11-17 16:48:02,218 - INFO -   Columna 16 'Carera vigente inicial': SUM
2025-11-17 16:48:02,218 - INFO -   Columna 17 'Cartera vigente calculada': SUM
2025-11-17 16:48:02,218 - INFO -   Columna 18 'Cartera Insoluta': SUM
2025-11-17 16:48:02,219 - INFO -   Columna 19 'Diferencia Validación vigente': SUM
2025-11-17 16:48:02,219 - INFO -   Columna 20 'Ahorro Consumido': SUM
2025-11-17 16:48:02,219 - INFO -   Columna 21 'Cartera Vencida Estadistica': SUM
2025-11-17 16:48:02,219 - INFO -   Columna 22 'Cartera vencida Total': SUM
2025-11-17 16:48:02,219 - INFO -   Columna 24 'Saldo en riesgo': SUM
2025-11-17 16:48:02,219 - INFO -   Columna 25 'Saldo 
ahorro 
acumulado': SUM
2025-11-17 16:48:02,219 - INFO -   Columna 26 'Monto promedio del grupo': SUM
2025-11-17 16:48:02,219 - INFO -   Columna 33 'Ahorro Acumulado': SUM
2025-11-17 16:48:02,219 - INFO - Filtros automáticos habilitados en rango: A6:AJ6
2025-11-17 16:48:02,219 - INFO - Escribiendo fórmulas en fila de totales...
2025-11-17 16:48:02,220 - INFO -   Fórmula en columna 6: =SUBTOTAL(109,F7:F214)
2025-11-17 16:48:02,220 - INFO -   Fórmula en columna 13: =SUBTOTAL(109,M7:M214)
2025-11-17 16:48:02,220 - INFO -   Fórmula en columna 15: =SUBTOTAL(109,O7:O214)
2025-11-17 16:48:02,220 - INFO -   Fórmula en columna 16: =SUBTOTAL(109,P7:P214)
2025-11-17 16:48:02,220 - INFO -   Fórmula en columna 17: =SUBTOTAL(109,Q7:Q214)
2025-11-17 16:48:02,220 - INFO -   Fórmula en columna 18: =SUBTOTAL(109,R7:R214)
2025-11-17 16:48:02,220 - INFO -   Fórmula en columna 19: =SUBTOTAL(109,S7:S214)
2025-11-17 16:48:02,220 - INFO -   Fórmula en columna 20: =SUBTOTAL(109,T7:T214)
2025-11-17 16:48:02,220 - INFO -   Fórmula en columna 21: =SUBTOTAL(109,U7:U214)
2025-11-17 16:48:02,220 - INFO -   Fórmula en columna 22: =SUBTOTAL(109,V7:V214)
2025-11-17 16:48:02,220 - INFO -   Fórmula en columna 24: =SUBTOTAL(109,X7:X214)
2025-11-17 16:48:02,220 - INFO -   Fórmula en columna 25: =SUBTOTAL(109,Y7:Y214)
2025-11-17 16:48:02,221 - INFO -   Fórmula en columna 26: =SUBTOTAL(109,Z7:Z214)
2025-11-17 16:48:02,221 - INFO -   Fórmula en columna 33: =SUBTOTAL(109,AG7:AG214)
2025-11-17 16:48:02,221 - INFO - Tabla creada exitosamente con 208 filas de datos + fila totales
2025-11-17 16:48:02,221 - INFO - Totales configurados en 14 columnas con fórmulas SUBTOTAL
2025-11-17 16:48:02,221 - INFO - Fila de totales: Formato aplicado automáticamente por la tabla
2025-11-17 16:48:02,221 - INFO - 
6.1. Congelando paneles para mantener encabezados visibles...
2025-11-17 16:48:02,221 - INFO - Paneles congelados: Filas 1-6 siempre visibles
2025-11-17 16:48:02,221 - INFO - 
7. Guardando archivo: output_automatizado.xlsx
2025-11-17 16:48:02,222 - ERROR - 
ERROR: [Errno 13] Permission denied: 'output_automatizado.xlsx'
Traceback (most recent call last):
  File "C:\Users\uzzie\Documents\Jale\merge-dataframes\analizar_y_automatizar.py", line 314, in main
    guardar_con_formato(df_cartera, RUTA_PLANTILLA, RUTA_OUTPUT)
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\uzzie\Documents\Jale\merge-dataframes\formato_excel.py", line 386, in guardar_con_formato
    wb_nuevo.save(ruta_output)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\uzzie\miniconda3\Lib\site-packages\openpyxl\workbook\workbook.py", line 386, in save
    save_workbook(self, filename)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "C:\Users\uzzie\miniconda3\Lib\site-packages\openpyxl\writer\excel.py", line 291, in save_workbook
    archive = ZipFile(filename, 'w', ZIP_DEFLATED, allowZip64=True)
  File "C:\Users\uzzie\miniconda3\Lib\zipfile\__init__.py", line 1367, in __init__
    self.fp = io.open(file, filemode)
              ~~~~~~~^^^^^^^^^^^^^^^^
PermissionError: [Errno 13] Permission denied: 'output_automatizado.xlsx'
2025-11-17 16:51:19,400 - INFO - ================================================================================
2025-11-17 16:51:19,401 - INFO - INICIO DE AUTOMATIZACIÓN DE CARTERA
2025-11-17 16:51:19,401 - INFO - ================================================================================
2025-11-17 16:51:19,401 - INFO - 
--- PASO 0: BÚSQUEDA DE ARCHIVOS ---
2025-11-17 16:51:19,402 - INFO - Archivo encontrado: data\ReportedeAntiguedaddeCarteraGrupal_12112025.xlsx
2025-11-17 16:51:19,403 - INFO - Archivo encontrado: data\Situación_de_cartera_12112025.xlsx
2025-11-17 16:51:19,404 - INFO - Archivo encontrado: data\Cobranza_12112025.xlsx
2025-11-17 16:51:19,404 - INFO - Archivo encontrado: data/AHORROS.xlsx
2025-11-17 16:51:19,404 - INFO - 
--- PASO 1: CARGA DE ARCHIVOS ---
2025-11-17 16:51:19,404 - INFO - Cargando ANTIGÜEDAD desde: data\ReportedeAntiguedaddeCarteraGrupal_12112025.xlsx
2025-11-17 16:51:19,431 - INFO - Hoja detectada: '121125'
2025-11-17 16:51:19,576 - INFO - ANTIGÜEDAD cargado: (206, 59)
2025-11-17 16:51:19,576 - INFO - Columnas: ['cod_region', 'coordinacion', 'nombre_de_gerente', 'codigo_promotor', 'nombre_promotor', 'codigo_recuperador', 'nombre_recuperador', 'cod_grupo_solidario', 'ciclo', 'grupo_solidario']...
2025-11-17 16:51:19,576 - INFO - No se encontraron IDs duplicados
2025-11-17 16:51:19,577 - INFO - Cargando SITUACIÓN DE CARTERA desde: data\Situación_de_cartera_12112025.xlsx
2025-11-17 16:51:19,693 - INFO - SITUACIÓN DE CARTERA cargada: (206, 43)
2025-11-17 16:51:19,694 - INFO - Columnas: ['codigo_ofic_cred', 'nombre_oficial_de_credito', 'codigo_promotor_cred', 'nombre_promotor_cred', 'codigo_coord', 'nombre_coordinacion', 'codigo_ger_regi', 'nombre_gerencia_regional', 'nombre_codigo', 'nombre_acreditado_cliente']...
2025-11-17 16:51:19,694 - INFO - Columna de código renombrada: nombre_codigo -> codigo
2025-11-17 16:51:19,696 - INFO - Cargando REPORTE DE COBRANZA desde: data\Cobranza_12112025.xlsx
2025-11-17 16:51:19,884 - INFO - REPORTE DE COBRANZA cargado: (207, 68)
2025-11-17 16:51:19,884 - INFO - Columnas: ['regional', 'regional1', 'coordinacion', 'coordinacion1', 'de_credito', 'de_credito1', 'gpo', 'cliente_grupo', 'unnamed:_8', 'del_cliente']...
2025-11-17 16:51:19,884 - INFO - Cargando AHORROS (ACUMULADO) desde: data/AHORROS.xlsx
2025-11-17 16:51:19,924 - INFO - AHORROS cargado: (208, 4)
2025-11-17 16:51:19,925 - INFO - Columnas: ['id', 'grupo', 'ciclo', 'ahorro_acumulado']
2025-11-17 16:51:19,925 - INFO - PARCHE PROMOTORES cargado: 1 correcciones
2025-11-17 16:51:19,926 - INFO - 
--- PASO 2: GENERACIÓN DE CARTERA ---
2025-11-17 16:51:19,926 - INFO - Iniciando generación de cartera (VERSIÓN CORREGIDA)...
2025-11-17 16:51:19,926 - INFO - Registros en antiguedad: 206
2025-11-17 16:51:19,928 - INFO - ID de grupo generados: 0    000089
1    000145
2    000069
3    000079
4    000104
Name: id_de_grupo, dtype: object
2025-11-17 16:51:19,943 - INFO - Después de joins: 208 registros
2025-11-17 16:51:19,944 - INFO - NaN en situacion: 2
2025-11-17 16:51:19,944 - INFO - NaN en cobranza: 1
2025-11-17 16:51:19,944 - INFO - NaN en ahorros: 3
2025-11-17 16:51:19,946 - INFO - Parche aplicado: 1 correcciones
2025-11-17 16:51:19,952 - INFO - Estatus calculados: {'Vigente': 208}
2025-11-17 16:51:19,953 - INFO - Cartera vigente sistema calculada como: saldo_total (de ANTIGÜEDAD)
2025-11-17 16:51:19,968 - INFO - Cartera generada exitosamente: 208 filas x 36 columnas
2025-11-17 16:51:19,968 - INFO - 
--- PASO 3: GUARDADO DE RESULTADO CON FORMATO ---
2025-11-17 16:51:19,968 - INFO - ================================================================================
2025-11-17 16:51:19,968 - INFO - GUARDANDO DATAFRAME CON FORMATO
2025-11-17 16:51:19,968 - INFO - ================================================================================
2025-11-17 16:51:19,968 - INFO - 
1. Cargando plantilla de headers: plantilla/CARTERA_HEADERS.xlsx
2025-11-17 16:51:19,976 - INFO - Plantilla cargada: 6 filas x 36 columnas (6.1 KB)
2025-11-17 16:51:19,977 - INFO - 
2. Creando nuevo workbook...
2025-11-17 16:51:19,978 - INFO - 
3. Copiando headers desde plantilla...
2025-11-17 16:51:19,978 - INFO - Copiando headers (filas 1-6) con formato...
2025-11-17 16:51:20,016 - INFO - Headers copiados: 36 columnas
2025-11-17 16:51:20,016 - INFO - 
4. Pegando datos del DataFrame...
2025-11-17 16:51:20,016 - INFO - Pegando DataFrame (208 filas x 36 columnas) desde fila 7...
2025-11-17 16:51:20,060 - INFO - Datos pegados hasta fila 214
2025-11-17 16:51:20,060 - INFO - 
5. Aplicando formatos de columnas...
2025-11-17 16:51:20,060 - INFO - Aplicando formatos de columnas desde fila 7 hasta 214...
2025-11-17 16:51:20,070 - INFO - Formatos aplicados a 208 filas
2025-11-17 16:51:20,070 - INFO - 
6. Creando tabla de Excel con totales...
2025-11-17 16:51:20,071 - INFO - Creando tabla Excel 'TablaCartera' desde fila 6 hasta 214...
2025-11-17 16:51:20,071 - INFO - Rango de tabla: A6:AJ215
2025-11-17 16:51:20,071 - INFO - Fila de totales: 215
2025-11-17 16:51:20,071 - INFO - Nombres de columnas extraídos: 36
2025-11-17 16:51:20,071 - INFO -   Columna 6 'Monto del crédito': SUM
2025-11-17 16:51:20,071 - INFO -   Columna 13 'Pago Semanal': SUM
2025-11-17 16:51:20,071 - INFO -   Columna 15 'Cartera vigente sistema': SUM
2025-11-17 16:51:20,071 - INFO -   Columna 16 'Carera vigente inicial': SUM
2025-11-17 16:51:20,071 - INFO -   Columna 17 'Cartera vigente calculada': SUM
2025-11-17 16:51:20,071 - INFO -   Columna 18 'Cartera Insoluta': SUM
2025-11-17 16:51:20,071 - INFO -   Columna 19 'Diferencia Validación vigente': SUM
2025-11-17 16:51:20,072 - INFO -   Columna 20 'Ahorro Consumido': SUM
2025-11-17 16:51:20,072 - INFO -   Columna 21 'Cartera Vencida Estadistica': SUM
2025-11-17 16:51:20,072 - INFO -   Columna 22 'Cartera vencida Total': SUM
2025-11-17 16:51:20,072 - INFO -   Columna 24 'Saldo en riesgo': SUM
2025-11-17 16:51:20,072 - INFO -   Columna 25 'Saldo 
ahorro 
acumulado': SUM
2025-11-17 16:51:20,072 - INFO -   Columna 26 'Monto promedio del grupo': SUM
2025-11-17 16:51:20,073 - INFO -   Columna 33 'Ahorro Acumulado': SUM
2025-11-17 16:51:20,073 - INFO - Filtros automáticos habilitados en rango: A6:AJ6
2025-11-17 16:51:20,073 - INFO - Escribiendo fórmulas en fila de totales...
2025-11-17 16:51:20,073 - INFO -   Fórmula en columna 6: =SUBTOTAL(109,F7:F214)
2025-11-17 16:51:20,073 - INFO -   Fórmula en columna 13: =SUBTOTAL(109,M7:M214)
2025-11-17 16:51:20,074 - INFO -   Fórmula en columna 15: =SUBTOTAL(109,O7:O214)
2025-11-17 16:51:20,074 - INFO -   Fórmula en columna 16: =SUBTOTAL(109,P7:P214)
2025-11-17 16:51:20,074 - INFO -   Fórmula en columna 17: =SUBTOTAL(109,Q7:Q214)
2025-11-17 16:51:20,074 - INFO -   Fórmula en columna 18: =SUBTOTAL(109,R7:R214)
2025-11-17 16:51:20,074 - INFO -   Fórmula en columna 19: =SUBTOTAL(109,S7:S214)
2025-11-17 16:51:20,074 - INFO -   Fórmula en columna 20: =SUBTOTAL(109,T7:T214)
2025-11-17 16:51:20,074 - INFO -   Fórmula en columna 21: =SUBTOTAL(109,U7:U214)
2025-11-17 16:51:20,074 - INFO -   Fórmula en columna 22: =SUBTOTAL(109,V7:V214)
2025-11-17 16:51:20,075 - INFO -   Fórmula en columna 24: =SUBTOTAL(109,X7:X214)
2025-11-17 16:51:20,075 - INFO -   Fórmula en columna 25: =SUBTOTAL(109,Y7:Y214)
2025-11-17 16:51:20,075 - INFO -   Fórmula en columna 26: =SUBTOTAL(109,Z7:Z214)
2025-11-17 16:51:20,075 - INFO -   Fórmula en columna 33: =SUBTOTAL(109,AG7:AG214)
2025-11-17 16:51:20,075 - INFO - Tabla creada exitosamente con 208 filas de datos + fila totales
2025-11-17 16:51:20,075 - INFO - Totales configurados en 14 columnas con fórmulas SUBTOTAL
2025-11-17 16:51:20,075 - INFO - Fila de totales: Formato aplicado automáticamente por la tabla
2025-11-17 16:51:20,075 - INFO - 
6.1. Congelando paneles para mantener encabezados visibles...
2025-11-17 16:51:20,075 - INFO - Paneles congelados: Filas 1-6 siempre visibles
2025-11-17 16:51:20,075 - INFO - 
7. Guardando archivo: output_automatizado.xlsx
2025-11-17 16:51:20,224 - INFO - 
================================================================================
2025-11-17 16:51:20,224 - INFO - ARCHIVO GUARDADO EXITOSAMENTE
2025-11-17 16:51:20,224 - INFO - ================================================================================
2025-11-17 16:51:20,224 - INFO - 
Archivo: output_automatizado.xlsx
2025-11-17 16:51:20,224 - INFO - Filas de datos: 208
2025-11-17 16:51:20,225 - INFO - Columnas: 36
2025-11-17 16:51:20,225 - INFO - Formato: Idéntico al machote
2025-11-17 16:51:20,225 - INFO - Tabla Excel: Con totales automáticos y filtros
2025-11-17 16:51:20,225 - INFO - Encabezados: Siempre visibles (paneles congelados)
2025-11-17 16:51:20,225 - INFO - ================================================================================
2025-11-17 16:51:20,225 - INFO - OK - Archivo guardado con formato: output_automatizado.xlsx
2025-11-17 16:51:20,225 - INFO - 
--- PASO 4: GENERACIÓN DE HOJA MORA ---
2025-11-17 16:51:20,225 - INFO - 
Iniciando generación de hoja MORA...
2025-11-17 16:51:20,226 - INFO - Registros con %mora > 5%: 7 de 208
2025-11-17 16:51:20,228 - INFO - Hoja MORA generada con 7 registros y 14 columnas
2025-11-17 16:51:20,229 - INFO - 
================================================================================
2025-11-17 16:51:20,229 - INFO - AGREGANDO HOJA MORA
2025-11-17 16:51:20,229 - INFO - ================================================================================
2025-11-17 16:51:20,229 - INFO - 
1. Abriendo archivo: output_automatizado.xlsx
2025-11-17 16:51:20,430 - INFO - 
2. Creando hoja 'Mora'
2025-11-17 16:51:20,431 - INFO - 
3. Copiando formato de headers desde plantilla
2025-11-17 16:51:20,455 - INFO - 
4. Estableciendo headers de MORA
2025-11-17 16:51:20,455 - INFO - 
5. Pegando 7 filas de datos
2025-11-17 16:51:20,458 - INFO - 
6. Creando tabla Excel con totales
2025-11-17 16:51:20,458 - INFO -    Creando tabla: A6:N14
2025-11-17 16:51:20,459 - INFO -    Tabla 'TablaMora' creada con totales automáticos
2025-11-17 16:51:20,459 - INFO -    Filtros automáticos habilitados en rango: A6:N6
2025-11-17 16:51:20,459 - INFO -    Fórmulas SUBTOTAL escritas en 6 columnas
2025-11-17 16:51:20,459 - INFO - 
6.1. Congelando paneles para mantener encabezados visibles...
2025-11-17 16:51:20,459 - INFO - Paneles congelados: Filas 1-6 siempre visibles
2025-11-17 16:51:20,459 - INFO - 
7. Guardando archivo con hoja MORA
2025-11-17 16:51:20,597 - INFO - 
================================================================================
2025-11-17 16:51:20,597 - INFO - HOJA MORA AGREGADA EXITOSAMENTE
2025-11-17 16:51:20,597 - INFO - ================================================================================
2025-11-17 16:51:20,597 - INFO - 
Registros en MORA: 7
2025-11-17 16:51:20,598 - INFO - Filtro: %mora > 5%
2025-11-17 16:51:20,598 - INFO - Columnas amarillas: %mora, Días de mora
2025-11-17 16:51:20,598 - INFO - Tabla Excel: Con totales automáticos y filtros
2025-11-17 16:51:20,598 - INFO - Encabezados: Siempre visibles (paneles congelados)
2025-11-17 16:51:20,598 - INFO - ================================================================================
2025-11-17 16:51:20,598 - INFO - OK - Hoja MORA agregada con 7 registros
2025-11-17 16:51:20,598 - INFO - 
--- PASO 5: VALIDACIÓN ---
2025-11-17 16:51:20,599 - INFO - Machote no encontrado - validación omitida (no es necesario)
2025-11-17 16:51:20,599 - INFO - 
================================================================================
2025-11-17 16:51:20,599 - INFO - AUTOMATIZACIÓN COMPLETADA EXITOSAMENTE
2025-11-17 16:51:20,599 - INFO - ================================================================================
2025-11-17 16:53:32,198 - INFO - ================================================================================
2025-11-17 16:53:32,198 - INFO - INICIO DE AUTOMATIZACIÓN DE CARTERA
2025-11-17 16:53:32,198 - INFO - ================================================================================
2025-11-17 16:53:32,198 - INFO - 
--- PASO 0: BÚSQUEDA DE ARCHIVOS ---
2025-11-17 16:53:32,199 - INFO - Archivo encontrado: data\ReportedeAntiguedaddeCarteraGrupal_12112025.xlsx
2025-11-17 16:53:32,199 - INFO - Archivo encontrado: data\Situación_de_cartera_12112025.xlsx
2025-11-17 16:53:32,199 - INFO - Archivo encontrado: data\Cobranza_12112025.xlsx
2025-11-17 16:53:32,200 - INFO - Archivo encontrado: data/AHORROS.xlsx
2025-11-17 16:53:32,200 - INFO - 
--- PASO 1: CARGA DE ARCHIVOS ---
2025-11-17 16:53:32,200 - INFO - Cargando ANTIGÜEDAD desde: data\ReportedeAntiguedaddeCarteraGrupal_12112025.xlsx
2025-11-17 16:53:32,224 - INFO - Hoja detectada: '121125'
2025-11-17 16:53:32,364 - INFO - ANTIGÜEDAD cargado: (206, 59)
2025-11-17 16:53:32,364 - INFO - Columnas: ['cod_region', 'coordinacion', 'nombre_de_gerente', 'codigo_promotor', 'nombre_promotor', 'codigo_recuperador', 'nombre_recuperador', 'cod_grupo_solidario', 'ciclo', 'grupo_solidario']...
2025-11-17 16:53:32,365 - INFO - No se encontraron IDs duplicados
2025-11-17 16:53:32,365 - INFO - Cargando SITUACIÓN DE CARTERA desde: data\Situación_de_cartera_12112025.xlsx
2025-11-17 16:53:32,480 - INFO - SITUACIÓN DE CARTERA cargada: (206, 43)
2025-11-17 16:53:32,480 - INFO - Columnas: ['codigo_ofic_cred', 'nombre_oficial_de_credito', 'codigo_promotor_cred', 'nombre_promotor_cred', 'codigo_coord', 'nombre_coordinacion', 'codigo_ger_regi', 'nombre_gerencia_regional', 'nombre_codigo', 'nombre_acreditado_cliente']...
2025-11-17 16:53:32,480 - INFO - Columna de código renombrada: nombre_codigo -> codigo
2025-11-17 16:53:32,481 - INFO - Cargando REPORTE DE COBRANZA desde: data\Cobranza_12112025.xlsx
2025-11-17 16:53:32,668 - INFO - REPORTE DE COBRANZA cargado: (207, 68)
2025-11-17 16:53:32,668 - INFO - Columnas: ['regional', 'regional1', 'coordinacion', 'coordinacion1', 'de_credito', 'de_credito1', 'gpo', 'cliente_grupo', 'unnamed:_8', 'del_cliente']...
2025-11-17 16:53:32,669 - INFO - Cargando AHORROS (ACUMULADO) desde: data/AHORROS.xlsx
2025-11-17 16:53:32,707 - INFO - AHORROS cargado: (208, 4)
2025-11-17 16:53:32,707 - INFO - Columnas: ['id', 'grupo', 'ciclo', 'ahorro_acumulado']
2025-11-17 16:53:32,708 - INFO - PARCHE PROMOTORES cargado: 1 correcciones
2025-11-17 16:53:32,708 - INFO - 
--- PASO 2: GENERACIÓN DE CARTERA ---
2025-11-17 16:53:32,708 - INFO - Iniciando generación de cartera (VERSIÓN CORREGIDA)...
2025-11-17 16:53:32,708 - INFO - Registros en antiguedad: 206
2025-11-17 16:53:32,710 - INFO - ID de grupo generados: 0    000089
1    000145
2    000069
3    000079
4    000104
Name: id_de_grupo, dtype: object
2025-11-17 16:53:32,725 - INFO - Después de joins: 208 registros
2025-11-17 16:53:32,726 - INFO - NaN en situacion: 2
2025-11-17 16:53:32,726 - INFO - NaN en cobranza: 1
2025-11-17 16:53:32,726 - INFO - NaN en ahorros: 3
2025-11-17 16:53:32,728 - INFO - Parche aplicado: 1 correcciones
2025-11-17 16:53:32,734 - INFO - Estatus calculados: {'Vigente': 208}
2025-11-17 16:53:32,735 - INFO - Cartera vigente sistema calculada como: saldo_total (de ANTIGÜEDAD)
2025-11-17 16:53:32,748 - INFO - Cartera generada exitosamente: 208 filas x 36 columnas
2025-11-17 16:53:32,749 - INFO - 
--- PASO 3: GUARDADO DE RESULTADO CON FORMATO ---
2025-11-17 16:53:32,749 - INFO - ================================================================================
2025-11-17 16:53:32,749 - INFO - GUARDANDO DATAFRAME CON FORMATO
2025-11-17 16:53:32,749 - INFO - ================================================================================
2025-11-17 16:53:32,749 - INFO - 
1. Cargando plantilla de headers: plantilla/CARTERA_HEADERS.xlsx
2025-11-17 16:53:32,758 - INFO - Plantilla cargada: 6 filas x 36 columnas (6.1 KB)
2025-11-17 16:53:32,758 - INFO - 
2. Creando nuevo workbook...
2025-11-17 16:53:32,759 - INFO - 
3. Copiando headers desde plantilla...
2025-11-17 16:53:32,760 - INFO - Copiando headers (filas 1-6) con formato...
2025-11-17 16:53:32,806 - INFO - Headers copiados: 36 columnas
2025-11-17 16:53:32,807 - INFO - 
4. Pegando datos del DataFrame...
2025-11-17 16:53:32,807 - INFO - Pegando DataFrame (208 filas x 36 columnas) desde fila 7...
2025-11-17 16:53:32,850 - INFO - Datos pegados hasta fila 214
2025-11-17 16:53:32,850 - INFO - 
5. Aplicando formatos de columnas...
2025-11-17 16:53:32,850 - INFO - Aplicando formatos de columnas desde fila 7 hasta 214...
2025-11-17 16:53:32,862 - INFO - Formatos aplicados a 208 filas
2025-11-17 16:53:32,862 - INFO - 
6. Creando tabla de Excel con totales...
2025-11-17 16:53:32,862 - INFO - Creando tabla Excel 'TablaCartera' desde fila 6 hasta 214...
2025-11-17 16:53:32,862 - INFO - Rango de tabla: A6:AJ215
2025-11-17 16:53:32,862 - INFO - Fila de totales: 215
2025-11-17 16:53:32,862 - INFO - Nombres de columnas extraídos: 36
2025-11-17 16:53:32,862 - INFO -   Columna 6 'Monto del crédito': SUM
2025-11-17 16:53:32,862 - INFO -   Columna 13 'Pago Semanal': SUM
2025-11-17 16:53:32,863 - INFO -   Columna 15 'Cartera vigente sistema': SUM
2025-11-17 16:53:32,863 - INFO -   Columna 16 'Carera vigente inicial': SUM
2025-11-17 16:53:32,863 - INFO -   Columna 17 'Cartera vigente calculada': SUM
2025-11-17 16:53:32,863 - INFO -   Columna 18 'Cartera Insoluta': SUM
2025-11-17 16:53:32,863 - INFO -   Columna 19 'Diferencia Validación vigente': SUM
2025-11-17 16:53:32,863 - INFO -   Columna 20 'Ahorro Consumido': SUM
2025-11-17 16:53:32,863 - INFO -   Columna 21 'Cartera Vencida Estadistica': SUM
2025-11-17 16:53:32,863 - INFO -   Columna 22 'Cartera vencida Total': SUM
2025-11-17 16:53:32,863 - INFO -   Columna 24 'Saldo en riesgo': SUM
2025-11-17 16:53:32,863 - INFO -   Columna 25 'Saldo 
ahorro 
acumulado': SUM
2025-11-17 16:53:32,863 - INFO -   Columna 26 'Monto promedio del grupo': SUM
2025-11-17 16:53:32,864 - INFO -   Columna 33 'Ahorro Acumulado': SUM
2025-11-17 16:53:32,864 - INFO - Filtros automáticos habilitados en rango: A6:AJ6
2025-11-17 16:53:32,864 - INFO - Escribiendo fórmulas en fila de totales...
2025-11-17 16:53:32,864 - INFO -   Fórmula en columna 6: =SUBTOTAL(109,F7:F214)
2025-11-17 16:53:32,864 - INFO -   Fórmula en columna 13: =SUBTOTAL(109,M7:M214)
2025-11-17 16:53:32,864 - INFO -   Fórmula en columna 15: =SUBTOTAL(109,O7:O214)
2025-11-17 16:53:32,864 - INFO -   Fórmula en columna 16: =SUBTOTAL(109,P7:P214)
2025-11-17 16:53:32,864 - INFO -   Fórmula en columna 17: =SUBTOTAL(109,Q7:Q214)
2025-11-17 16:53:32,865 - INFO -   Fórmula en columna 18: =SUBTOTAL(109,R7:R214)
2025-11-17 16:53:32,865 - INFO -   Fórmula en columna 19: =SUBTOTAL(109,S7:S214)
2025-11-17 16:53:32,865 - INFO -   Fórmula en columna 20: =SUBTOTAL(109,T7:T214)
2025-11-17 16:53:32,865 - INFO -   Fórmula en columna 21: =SUBTOTAL(109,U7:U214)
2025-11-17 16:53:32,865 - INFO -   Fórmula en columna 22: =SUBTOTAL(109,V7:V214)
2025-11-17 16:53:32,865 - INFO -   Fórmula en columna 24: =SUBTOTAL(109,X7:X214)
2025-11-17 16:53:32,865 - INFO -   Fórmula en columna 25: =SUBTOTAL(109,Y7:Y214)
2025-11-17 16:53:32,865 - INFO -   Fórmula en columna 26: =SUBTOTAL(109,Z7:Z214)
2025-11-17 16:53:32,865 - INFO -   Fórmula en columna 33: =SUBTOTAL(109,AG7:AG214)
2025-11-17 16:53:32,865 - INFO - Tabla creada exitosamente con 208 filas de datos + fila totales
2025-11-17 16:53:32,865 - INFO - Totales configurados en 14 columnas con fórmulas SUBTOTAL
2025-11-17 16:53:32,865 - INFO - Fila de totales: Formato aplicado automáticamente por la tabla
2025-11-17 16:53:32,865 - INFO - 
6.1. Congelando paneles para mantener encabezados visibles...
2025-11-17 16:53:32,865 - INFO - Paneles congelados: Filas 1-6 siempre visibles
2025-11-17 16:53:32,865 - INFO - 
7. Guardando archivo: output_automatizado.xlsx
2025-11-17 16:53:33,002 - INFO - 
================================================================================
2025-11-17 16:53:33,003 - INFO - ARCHIVO GUARDADO EXITOSAMENTE
2025-11-17 16:53:33,003 - INFO - ================================================================================
2025-11-17 16:53:33,003 - INFO - 
Archivo: output_automatizado.xlsx
2025-11-17 16:53:33,003 - INFO - Filas de datos: 208
2025-11-17 16:53:33,003 - INFO - Columnas: 36
2025-11-17 16:53:33,003 - INFO - Formato: Idéntico al machote
2025-11-17 16:53:33,003 - INFO - Tabla Excel: Con totales automáticos y filtros
2025-11-17 16:53:33,003 - INFO - Encabezados: Siempre visibles (paneles congelados)
2025-11-17 16:53:33,003 - INFO - ================================================================================
2025-11-17 16:53:33,004 - INFO - OK - Archivo guardado con formato: output_automatizado.xlsx
2025-11-17 16:53:33,004 - INFO - 
--- PASO 4: GENERACIÓN DE HOJA MORA ---
2025-11-17 16:53:33,004 - INFO - 
Iniciando generación de hoja MORA...
2025-11-17 16:53:33,005 - INFO - Registros con %mora > 5%: 7 de 208
2025-11-17 16:53:33,007 - INFO - Hoja MORA generada con 7 registros y 14 columnas
2025-11-17 16:53:33,008 - INFO - 
================================================================================
2025-11-17 16:53:33,008 - INFO - AGREGANDO HOJA MORA
2025-11-17 16:53:33,008 - INFO - ================================================================================
2025-11-17 16:53:33,008 - INFO - 
1. Abriendo archivo: output_automatizado.xlsx
2025-11-17 16:53:33,204 - INFO - 
2. Creando hoja 'Mora'
2025-11-17 16:53:33,205 - INFO - 
3. Copiando formato de headers desde plantilla
2025-11-17 16:53:33,226 - INFO - 
4. Estableciendo headers de MORA
2025-11-17 16:53:33,226 - INFO - 
5. Pegando 7 filas de datos
2025-11-17 16:53:33,228 - INFO - 
6. Creando tabla Excel con totales
2025-11-17 16:53:33,228 - INFO -    Creando tabla: A6:N14
2025-11-17 16:53:33,229 - INFO -    Tabla 'TablaMora' creada con totales automáticos
2025-11-17 16:53:33,229 - INFO -    Filtros automáticos habilitados en rango: A6:N6
2025-11-17 16:53:33,229 - INFO -    Fórmulas SUBTOTAL escritas en 6 columnas
2025-11-17 16:53:33,229 - INFO - 
6.1. Congelando paneles para mantener encabezados visibles...
2025-11-17 16:53:33,229 - INFO - Paneles congelados: Filas 1-6 siempre visibles
2025-11-17 16:53:33,229 - INFO - 
7. Guardando archivo con hoja MORA
2025-11-17 16:53:33,366 - INFO - 
================================================================================
2025-11-17 16:53:33,366 - INFO - HOJA MORA AGREGADA EXITOSAMENTE
2025-11-17 16:53:33,367 - INFO - ================================================================================
2025-11-17 16:53:33,367 - INFO - 
Registros en MORA: 7
2025-11-17 16:53:33,367 - INFO - Filtro: %mora > 5%
2025-11-17 16:53:33,367 - INFO - Columnas amarillas: %mora, Días de mora
2025-11-17 16:53:33,367 - INFO - Tabla Excel: Con totales automáticos y filtros
2025-11-17 16:53:33,367 - INFO - Encabezados: Siempre visibles (paneles congelados)
2025-11-17 16:53:33,367 - INFO - ================================================================================
2025-11-17 16:53:33,367 - INFO - OK - Hoja MORA agregada con 7 registros
2025-11-17 16:53:33,367 - INFO - 
--- PASO 5: VALIDACIÓN ---
2025-11-17 16:53:33,368 - INFO - Machote no encontrado - validación omitida (no es necesario)
2025-11-17 16:53:33,368 - INFO - 
================================================================================
2025-11-17 16:53:33,368 - INFO - AUTOMATIZACIÓN COMPLETADA EXITOSAMENTE
2025-11-17 16:53:33,369 - INFO - ================================================================================
2025-11-17 17:22:24,693 - INFO - ================================================================================
2025-11-17 17:22:24,693 - INFO - INICIO DE AUTOMATIZACIÓN DE CARTERA
2025-11-17 17:22:24,693 - INFO - ================================================================================
2025-11-17 17:22:24,693 - INFO - 
--- PASO 0: BÚSQUEDA DE ARCHIVOS ---
2025-11-17 17:22:24,694 - INFO - Archivo encontrado: data\ReportedeAntiguedaddeCarteraGrupal_12112025.xlsx
2025-11-17 17:22:24,694 - INFO - Archivo encontrado: data\Situación_de_cartera_12112025.xlsx
2025-11-17 17:22:24,695 - INFO - Archivo encontrado: data\Cobranza_12112025.xlsx
2025-11-17 17:22:24,695 - INFO - Archivo encontrado: data/AHORROS.xlsx
2025-11-17 17:22:24,695 - INFO - 
--- PASO 1: CARGA DE ARCHIVOS ---
2025-11-17 17:22:24,696 - INFO - Cargando ANTIGÜEDAD desde: data\ReportedeAntiguedaddeCarteraGrupal_12112025.xlsx
2025-11-17 17:22:24,722 - INFO - Hoja detectada: '121125'
2025-11-17 17:22:24,883 - INFO - ANTIGÜEDAD cargado: (206, 59)
2025-11-17 17:22:24,883 - INFO - Columnas: ['cod_region', 'coordinacion', 'nombre_de_gerente', 'codigo_promotor', 'nombre_promotor', 'codigo_recuperador', 'nombre_recuperador', 'cod_grupo_solidario', 'ciclo', 'grupo_solidario']...
2025-11-17 17:22:24,889 - INFO - No se encontraron IDs duplicados
2025-11-17 17:22:24,889 - INFO - Cargando SITUACIÓN DE CARTERA desde: data\Situación_de_cartera_12112025.xlsx
2025-11-17 17:22:25,014 - INFO - SITUACIÓN DE CARTERA cargada: (206, 43)
2025-11-17 17:22:25,015 - INFO - Columnas: ['codigo_ofic_cred', 'nombre_oficial_de_credito', 'codigo_promotor_cred', 'nombre_promotor_cred', 'codigo_coord', 'nombre_coordinacion', 'codigo_ger_regi', 'nombre_gerencia_regional', 'nombre_codigo', 'nombre_acreditado_cliente']...
2025-11-17 17:22:25,017 - INFO - Columna de código renombrada: nombre_codigo -> codigo
2025-11-17 17:22:25,019 - INFO - Cargando REPORTE DE COBRANZA desde: data\Cobranza_12112025.xlsx
2025-11-17 17:22:25,207 - INFO - REPORTE DE COBRANZA cargado: (207, 68)
2025-11-17 17:22:25,207 - INFO - Columnas: ['regional', 'regional1', 'coordinacion', 'coordinacion1', 'de_credito', 'de_credito1', 'gpo', 'cliente_grupo', 'unnamed:_8', 'del_cliente']...
2025-11-17 17:22:25,208 - INFO - Cargando AHORROS (ACUMULADO) desde: data/AHORROS.xlsx
2025-11-17 17:22:25,245 - INFO - AHORROS cargado: (208, 4)
2025-11-17 17:22:25,245 - INFO - Columnas: ['id', 'grupo', 'ciclo', 'ahorro_acumulado']
2025-11-17 17:22:25,246 - INFO - PARCHE PROMOTORES cargado: 1 correcciones
2025-11-17 17:22:25,246 - INFO - 
--- PASO 2: GENERACIÓN DE CARTERA ---
2025-11-17 17:22:25,246 - INFO - Iniciando generación de cartera (VERSIÓN CORREGIDA)...
2025-11-17 17:22:25,246 - INFO - Registros en antiguedad: 206
2025-11-17 17:22:25,250 - INFO - ID de grupo generados: 0    000089
1    000145
2    000069
3    000079
4    000104
Name: id_de_grupo, dtype: object
2025-11-17 17:22:25,272 - INFO - Después de joins: 208 registros
2025-11-17 17:22:25,273 - INFO - NaN en situacion: 2
2025-11-17 17:22:25,273 - INFO - NaN en cobranza: 1
2025-11-17 17:22:25,273 - INFO - NaN en ahorros: 3
2025-11-17 17:22:25,275 - INFO - Parche aplicado: 1 correcciones
2025-11-17 17:22:25,287 - INFO - Estatus calculados: {'Vigente': 208}
2025-11-17 17:22:25,287 - INFO - Cartera vigente sistema calculada como: saldo_total (de ANTIGÜEDAD)
2025-11-17 17:22:25,306 - INFO - Cartera generada exitosamente: 208 filas x 36 columnas
2025-11-17 17:22:25,306 - INFO - 
--- PASO 3: GUARDADO DE RESULTADO CON FORMATO ---
2025-11-17 17:22:25,306 - INFO - ================================================================================
2025-11-17 17:22:25,306 - INFO - GUARDANDO DATAFRAME CON FORMATO
2025-11-17 17:22:25,306 - INFO - ================================================================================
2025-11-17 17:22:25,306 - INFO - 
1. Cargando plantilla de headers: plantilla/CARTERA_HEADERS.xlsx
2025-11-17 17:22:25,316 - INFO - Plantilla cargada: 6 filas x 36 columnas (6.1 KB)
2025-11-17 17:22:25,316 - INFO - 
2. Creando nuevo workbook...
2025-11-17 17:22:25,318 - INFO - 
3. Copiando headers desde plantilla...
2025-11-17 17:22:25,318 - INFO - Copiando headers (filas 1-6) con formato...
2025-11-17 17:22:25,359 - INFO - Headers copiados: 36 columnas
2025-11-17 17:22:25,359 - INFO - 
4. Pegando datos del DataFrame...
2025-11-17 17:22:25,359 - INFO - Pegando DataFrame (208 filas x 36 columnas) desde fila 7...
2025-11-17 17:22:25,411 - INFO - Datos pegados hasta fila 214
2025-11-17 17:22:25,411 - INFO - 
5. Aplicando formatos de columnas...
2025-11-17 17:22:25,411 - INFO - Aplicando formatos de columnas desde fila 7 hasta 214...
2025-11-17 17:22:25,421 - INFO - Formatos aplicados a 208 filas
2025-11-17 17:22:25,421 - INFO - 
6. Creando tabla de Excel con totales...
2025-11-17 17:22:25,422 - INFO - Creando tabla Excel 'TablaCartera' desde fila 6 hasta 214...
2025-11-17 17:22:25,422 - INFO - Rango de tabla: A6:AJ215
2025-11-17 17:22:25,422 - INFO - Fila de totales: 215
2025-11-17 17:22:25,422 - INFO - Nombres de columnas extraídos: 36
2025-11-17 17:22:25,422 - INFO -   Columna 6 'Monto del crédito': SUM
2025-11-17 17:22:25,422 - INFO -   Columna 13 'Pago Semanal': SUM
2025-11-17 17:22:25,422 - INFO -   Columna 15 'Cartera vigente sistema': SUM
2025-11-17 17:22:25,422 - INFO -   Columna 16 'Carera vigente inicial': SUM
2025-11-17 17:22:25,422 - INFO -   Columna 17 'Cartera vigente calculada': SUM
2025-11-17 17:22:25,422 - INFO -   Columna 18 'Cartera Insoluta': SUM
2025-11-17 17:22:25,423 - INFO -   Columna 19 'Diferencia Validación vigente': SUM
2025-11-17 17:22:25,423 - INFO -   Columna 20 'Ahorro Consumido': SUM
2025-11-17 17:22:25,423 - INFO -   Columna 21 'Cartera Vencida Estadistica': SUM
2025-11-17 17:22:25,423 - INFO -   Columna 22 'Cartera vencida Total': SUM
2025-11-17 17:22:25,423 - INFO -   Columna 24 'Saldo en riesgo': SUM
2025-11-17 17:22:25,423 - INFO -   Columna 25 'Saldo 
ahorro 
acumulado': SUM
2025-11-17 17:22:25,423 - INFO -   Columna 26 'Monto promedio del grupo': SUM
2025-11-17 17:22:25,423 - INFO -   Columna 33 'Ahorro Acumulado': SUM
2025-11-17 17:22:25,423 - INFO - Filtros automáticos habilitados en rango: A6:AJ6
2025-11-17 17:22:25,423 - INFO - Escribiendo fórmulas en fila de totales...
2025-11-17 17:22:25,423 - INFO -   Fórmula en columna 6: =SUBTOTAL(109,F7:F214)
2025-11-17 17:22:25,424 - INFO -   Fórmula en columna 13: =SUBTOTAL(109,M7:M214)
2025-11-17 17:22:25,424 - INFO -   Fórmula en columna 15: =SUBTOTAL(109,O7:O214)
2025-11-17 17:22:25,424 - INFO -   Fórmula en columna 16: =SUBTOTAL(109,P7:P214)
2025-11-17 17:22:25,424 - INFO -   Fórmula en columna 17: =SUBTOTAL(109,Q7:Q214)
2025-11-17 17:22:25,424 - INFO -   Fórmula en columna 18: =SUBTOTAL(109,R7:R214)
2025-11-17 17:22:25,424 - INFO -   Fórmula en columna 19: =SUBTOTAL(109,S7:S214)
2025-11-17 17:22:25,424 - INFO -   Fórmula en columna 20: =SUBTOTAL(109,T7:T214)
2025-11-17 17:22:25,424 - INFO -   Fórmula en columna 21: =SUBTOTAL(109,U7:U214)
2025-11-17 17:22:25,424 - INFO -   Fórmula en columna 22: =SUBTOTAL(109,V7:V214)
2025-11-17 17:22:25,424 - INFO -   Fórmula en columna 24: =SUBTOTAL(109,X7:X214)
2025-11-17 17:22:25,424 - INFO -   Fórmula en columna 25: =SUBTOTAL(109,Y7:Y214)
2025-11-17 17:22:25,424 - INFO -   Fórmula en columna 26: =SUBTOTAL(109,Z7:Z214)
2025-11-17 17:22:25,424 - INFO -   Fórmula en columna 33: =SUBTOTAL(109,AG7:AG214)
2025-11-17 17:22:25,425 - INFO - Tabla creada exitosamente con 208 filas de datos + fila totales
2025-11-17 17:22:25,425 - INFO - Totales configurados en 14 columnas con fórmulas SUBTOTAL
2025-11-17 17:22:25,425 - INFO - Fila de totales: Formato aplicado automáticamente por la tabla
2025-11-17 17:22:25,425 - INFO - 
6.0. Re-aplicando formato sin paréntesis a columna 18...
2025-11-17 17:22:25,425 - INFO - Formato re-aplicado a columna 18 (Diferencia validación vigente)
2025-11-17 17:22:25,425 - INFO - 
6.1. Congelando paneles para mantener encabezados visibles...
2025-11-17 17:22:25,425 - INFO - Paneles congelados: Filas 1-6 siempre visibles
2025-11-17 17:22:25,425 - INFO - 
7. Guardando archivo: output_automatizado.xlsx
2025-11-17 17:22:25,567 - INFO - 
================================================================================
2025-11-17 17:22:25,567 - INFO - ARCHIVO GUARDADO EXITOSAMENTE
2025-11-17 17:22:25,567 - INFO - ================================================================================
2025-11-17 17:22:25,568 - INFO - 
Archivo: output_automatizado.xlsx
2025-11-17 17:22:25,568 - INFO - Filas de datos: 208
2025-11-17 17:22:25,568 - INFO - Columnas: 36
2025-11-17 17:22:25,568 - INFO - Formato: Idéntico al machote
2025-11-17 17:22:25,568 - INFO - Tabla Excel: Con totales automáticos y filtros
2025-11-17 17:22:25,568 - INFO - Encabezados: Siempre visibles (paneles congelados)
2025-11-17 17:22:25,568 - INFO - ================================================================================
2025-11-17 17:22:25,568 - INFO - OK - Archivo guardado con formato: output_automatizado.xlsx
2025-11-17 17:22:25,568 - INFO - 
--- PASO 4: GENERACIÓN DE HOJA MORA ---
2025-11-17 17:22:25,568 - INFO - 
Iniciando generación de hoja MORA...
2025-11-17 17:22:25,569 - INFO - Registros con %mora > 5%: 7 de 208
2025-11-17 17:22:25,572 - INFO - Hoja MORA generada con 7 registros y 14 columnas
2025-11-17 17:22:25,572 - INFO - 
================================================================================
2025-11-17 17:22:25,572 - INFO - AGREGANDO HOJA MORA
2025-11-17 17:22:25,572 - INFO - ================================================================================
2025-11-17 17:22:25,572 - INFO - 
1. Abriendo archivo: output_automatizado.xlsx
2025-11-17 17:22:25,755 - INFO - 
2. Creando hoja 'Mora'
2025-11-17 17:22:25,755 - INFO - 
3. Copiando formato de headers desde plantilla
2025-11-17 17:22:25,778 - INFO - 
4. Estableciendo headers de MORA
2025-11-17 17:22:25,779 - INFO - 
5. Pegando 7 filas de datos
2025-11-17 17:22:25,781 - INFO - 
6. Creando tabla Excel con totales
2025-11-17 17:22:25,781 - INFO -    Creando tabla: A6:N14
2025-11-17 17:22:25,782 - INFO -    Tabla 'TablaMora' creada con totales automáticos
2025-11-17 17:22:25,782 - INFO -    Filtros automáticos habilitados en rango: A6:N6
2025-11-17 17:22:25,782 - INFO -    Fórmulas SUBTOTAL escritas en 6 columnas
2025-11-17 17:22:25,782 - INFO - 
6.1. Congelando paneles para mantener encabezados visibles...
2025-11-17 17:22:25,783 - INFO - Paneles congelados: Filas 1-6 siempre visibles
2025-11-17 17:22:25,783 - INFO - 
7. Guardando archivo con hoja MORA
2025-11-17 17:22:25,933 - INFO - 
================================================================================
2025-11-17 17:22:25,933 - INFO - HOJA MORA AGREGADA EXITOSAMENTE
2025-11-17 17:22:25,934 - INFO - ================================================================================
2025-11-17 17:22:25,934 - INFO - 
Registros en MORA: 7
2025-11-17 17:22:25,934 - INFO - Filtro: %mora > 5%
2025-11-17 17:22:25,934 - INFO - Columnas amarillas: %mora, Días de mora
2025-11-17 17:22:25,934 - INFO - Tabla Excel: Con totales automáticos y filtros
2025-11-17 17:22:25,934 - INFO - Encabezados: Siempre visibles (paneles congelados)
2025-11-17 17:22:25,935 - INFO - ================================================================================
2025-11-17 17:22:25,935 - INFO - OK - Hoja MORA agregada con 7 registros
2025-11-17 17:22:25,935 - INFO - 
--- PASO 5: VALIDACIÓN ---
2025-11-17 17:22:25,935 - INFO - Machote no encontrado - validación omitida (no es necesario)
2025-11-17 17:22:25,935 - INFO - 
================================================================================
2025-11-17 17:22:25,935 - INFO - AUTOMATIZACIÓN COMPLETADA EXITOSAMENTE
2025-11-17 17:22:25,936 - INFO - ================================================================================
2025-11-17 17:23:03,673 - INFO - ================================================================================
2025-11-17 17:23:03,673 - INFO - INICIO DE AUTOMATIZACIÓN DE CARTERA
2025-11-17 17:23:03,673 - INFO - ================================================================================
2025-11-17 17:23:03,673 - INFO - 
--- PASO 0: BÚSQUEDA DE ARCHIVOS ---
2025-11-17 17:23:03,674 - INFO - Archivo encontrado: data\ReportedeAntiguedaddeCarteraGrupal_12112025.xlsx
2025-11-17 17:23:03,674 - INFO - Archivo encontrado: data\Situación_de_cartera_12112025.xlsx
2025-11-17 17:23:03,675 - INFO - Archivo encontrado: data\Cobranza_12112025.xlsx
2025-11-17 17:23:03,675 - INFO - Archivo encontrado: data/AHORROS.xlsx
2025-11-17 17:23:03,675 - INFO - 
--- PASO 1: CARGA DE ARCHIVOS ---
2025-11-17 17:23:03,675 - INFO - Cargando ANTIGÜEDAD desde: data\ReportedeAntiguedaddeCarteraGrupal_12112025.xlsx
2025-11-17 17:23:03,695 - INFO - Hoja detectada: '121125'
2025-11-17 17:23:03,852 - INFO - ANTIGÜEDAD cargado: (206, 59)
2025-11-17 17:23:03,852 - INFO - Columnas: ['cod_region', 'coordinacion', 'nombre_de_gerente', 'codigo_promotor', 'nombre_promotor', 'codigo_recuperador', 'nombre_recuperador', 'cod_grupo_solidario', 'ciclo', 'grupo_solidario']...
2025-11-17 17:23:03,852 - INFO - No se encontraron IDs duplicados
2025-11-17 17:23:03,853 - INFO - Cargando SITUACIÓN DE CARTERA desde: data\Situación_de_cartera_12112025.xlsx
2025-11-17 17:23:03,981 - INFO - SITUACIÓN DE CARTERA cargada: (206, 43)
2025-11-17 17:23:03,981 - INFO - Columnas: ['codigo_ofic_cred', 'nombre_oficial_de_credito', 'codigo_promotor_cred', 'nombre_promotor_cred', 'codigo_coord', 'nombre_coordinacion', 'codigo_ger_regi', 'nombre_gerencia_regional', 'nombre_codigo', 'nombre_acreditado_cliente']...
2025-11-17 17:23:03,982 - INFO - Columna de código renombrada: nombre_codigo -> codigo
2025-11-17 17:23:03,983 - INFO - Cargando REPORTE DE COBRANZA desde: data\Cobranza_12112025.xlsx
2025-11-17 17:23:04,176 - INFO - REPORTE DE COBRANZA cargado: (207, 68)
2025-11-17 17:23:04,177 - INFO - Columnas: ['regional', 'regional1', 'coordinacion', 'coordinacion1', 'de_credito', 'de_credito1', 'gpo', 'cliente_grupo', 'unnamed:_8', 'del_cliente']...
2025-11-17 17:23:04,177 - INFO - Cargando AHORROS (ACUMULADO) desde: data/AHORROS.xlsx
2025-11-17 17:23:04,213 - INFO - AHORROS cargado: (208, 4)
2025-11-17 17:23:04,214 - INFO - Columnas: ['id', 'grupo', 'ciclo', 'ahorro_acumulado']
2025-11-17 17:23:04,214 - INFO - PARCHE PROMOTORES cargado: 1 correcciones
2025-11-17 17:23:04,214 - INFO - 
--- PASO 2: GENERACIÓN DE CARTERA ---
2025-11-17 17:23:04,214 - INFO - Iniciando generación de cartera (VERSIÓN CORREGIDA)...
2025-11-17 17:23:04,214 - INFO - Registros en antiguedad: 206
2025-11-17 17:23:04,216 - INFO - ID de grupo generados: 0    000089
1    000145
2    000069
3    000079
4    000104
Name: id_de_grupo, dtype: object
2025-11-17 17:23:04,232 - INFO - Después de joins: 208 registros
2025-11-17 17:23:04,233 - INFO - NaN en situacion: 2
2025-11-17 17:23:04,233 - INFO - NaN en cobranza: 1
2025-11-17 17:23:04,233 - INFO - NaN en ahorros: 3
2025-11-17 17:23:04,235 - INFO - Parche aplicado: 1 correcciones
2025-11-17 17:23:04,241 - INFO - Estatus calculados: {'Vigente': 208}
2025-11-17 17:23:04,242 - INFO - Cartera vigente sistema calculada como: saldo_total (de ANTIGÜEDAD)
2025-11-17 17:23:04,258 - INFO - Cartera generada exitosamente: 208 filas x 36 columnas
2025-11-17 17:23:04,258 - INFO - 
--- PASO 3: GUARDADO DE RESULTADO CON FORMATO ---
2025-11-17 17:23:04,259 - INFO - ================================================================================
2025-11-17 17:23:04,259 - INFO - GUARDANDO DATAFRAME CON FORMATO
2025-11-17 17:23:04,259 - INFO - ================================================================================
2025-11-17 17:23:04,259 - INFO - 
1. Cargando plantilla de headers: plantilla/CARTERA_HEADERS.xlsx
2025-11-17 17:23:04,271 - INFO - Plantilla cargada: 6 filas x 36 columnas (6.1 KB)
2025-11-17 17:23:04,271 - INFO - 
2. Creando nuevo workbook...
2025-11-17 17:23:04,272 - INFO - 
3. Copiando headers desde plantilla...
2025-11-17 17:23:04,272 - INFO - Copiando headers (filas 1-6) con formato...
2025-11-17 17:23:04,319 - INFO - Headers copiados: 36 columnas
2025-11-17 17:23:04,319 - INFO - 
4. Pegando datos del DataFrame...
2025-11-17 17:23:04,319 - INFO - Pegando DataFrame (208 filas x 36 columnas) desde fila 7...
2025-11-17 17:23:04,363 - INFO - Datos pegados hasta fila 214
2025-11-17 17:23:04,363 - INFO - 
5. Aplicando formatos de columnas...
2025-11-17 17:23:04,363 - INFO - Aplicando formatos de columnas desde fila 7 hasta 214...
2025-11-17 17:23:04,373 - INFO - Formatos aplicados a 208 filas
2025-11-17 17:23:04,373 - INFO - 
6. Creando tabla de Excel con totales...
2025-11-17 17:23:04,373 - INFO - Creando tabla Excel 'TablaCartera' desde fila 6 hasta 214...
2025-11-17 17:23:04,374 - INFO - Rango de tabla: A6:AJ215
2025-11-17 17:23:04,374 - INFO - Fila de totales: 215
2025-11-17 17:23:04,374 - INFO - Nombres de columnas extraídos: 36
2025-11-17 17:23:04,374 - INFO -   Columna 6 'Monto del crédito': SUM
2025-11-17 17:23:04,374 - INFO -   Columna 13 'Pago Semanal': SUM
2025-11-17 17:23:04,374 - INFO -   Columna 15 'Cartera vigente sistema': SUM
2025-11-17 17:23:04,374 - INFO -   Columna 16 'Carera vigente inicial': SUM
2025-11-17 17:23:04,374 - INFO -   Columna 17 'Cartera vigente calculada': SUM
2025-11-17 17:23:04,374 - INFO -   Columna 18 'Cartera Insoluta': SUM
2025-11-17 17:23:04,374 - INFO -   Columna 19 'Diferencia Validación vigente': SUM
2025-11-17 17:23:04,375 - INFO -   Columna 20 'Ahorro Consumido': SUM
2025-11-17 17:23:04,375 - INFO -   Columna 21 'Cartera Vencida Estadistica': SUM
2025-11-17 17:23:04,375 - INFO -   Columna 22 'Cartera vencida Total': SUM
2025-11-17 17:23:04,375 - INFO -   Columna 24 'Saldo en riesgo': SUM
2025-11-17 17:23:04,375 - INFO -   Columna 25 'Saldo 
ahorro 
acumulado': SUM
2025-11-17 17:23:04,375 - INFO -   Columna 26 'Monto promedio del grupo': SUM
2025-11-17 17:23:04,375 - INFO -   Columna 33 'Ahorro Acumulado': SUM
2025-11-17 17:23:04,376 - INFO - Filtros automáticos habilitados en rango: A6:AJ6
2025-11-17 17:23:04,376 - INFO - Escribiendo fórmulas en fila de totales...
2025-11-17 17:23:04,376 - INFO -   Fórmula en columna 6: =SUBTOTAL(109,F7:F214)
2025-11-17 17:23:04,376 - INFO -   Fórmula en columna 13: =SUBTOTAL(109,M7:M214)
2025-11-17 17:23:04,376 - INFO -   Fórmula en columna 15: =SUBTOTAL(109,O7:O214)
2025-11-17 17:23:04,376 - INFO -   Fórmula en columna 16: =SUBTOTAL(109,P7:P214)
2025-11-17 17:23:04,376 - INFO -   Fórmula en columna 17: =SUBTOTAL(109,Q7:Q214)
2025-11-17 17:23:04,377 - INFO -   Fórmula en columna 18: =SUBTOTAL(109,R7:R214)
2025-11-17 17:23:04,377 - INFO -   Fórmula en columna 19: =SUBTOTAL(109,S7:S214)
2025-11-17 17:23:04,377 - INFO -   Fórmula en columna 20: =SUBTOTAL(109,T7:T214)
2025-11-17 17:23:04,377 - INFO -   Fórmula en columna 21: =SUBTOTAL(109,U7:U214)
2025-11-17 17:23:04,377 - INFO -   Fórmula en columna 22: =SUBTOTAL(109,V7:V214)
2025-11-17 17:23:04,377 - INFO -   Fórmula en columna 24: =SUBTOTAL(109,X7:X214)
2025-11-17 17:23:04,377 - INFO -   Fórmula en columna 25: =SUBTOTAL(109,Y7:Y214)
2025-11-17 17:23:04,377 - INFO -   Fórmula en columna 26: =SUBTOTAL(109,Z7:Z214)
2025-11-17 17:23:04,377 - INFO -   Fórmula en columna 33: =SUBTOTAL(109,AG7:AG214)
2025-11-17 17:23:04,377 - INFO - Tabla creada exitosamente con 208 filas de datos + fila totales
2025-11-17 17:23:04,377 - INFO - Totales configurados en 14 columnas con fórmulas SUBTOTAL
2025-11-17 17:23:04,378 - INFO - Fila de totales: Formato aplicado automáticamente por la tabla
2025-11-17 17:23:04,378 - INFO - 
6.0. Re-aplicando formato sin paréntesis a columna 18...
2025-11-17 17:23:04,378 - INFO - Formato re-aplicado a columna 18 (Diferencia validación vigente) desde fila 7 hasta 215
2025-11-17 17:23:04,378 - INFO - 
6.1. Congelando paneles para mantener encabezados visibles...
2025-11-17 17:23:04,378 - INFO - Paneles congelados: Filas 1-6 siempre visibles
2025-11-17 17:23:04,378 - INFO - 
7. Guardando archivo: output_automatizado.xlsx
2025-11-17 17:23:04,518 - INFO - 
================================================================================
2025-11-17 17:23:04,519 - INFO - ARCHIVO GUARDADO EXITOSAMENTE
2025-11-17 17:23:04,519 - INFO - ================================================================================
2025-11-17 17:23:04,519 - INFO - 
Archivo: output_automatizado.xlsx
2025-11-17 17:23:04,519 - INFO - Filas de datos: 208
2025-11-17 17:23:04,519 - INFO - Columnas: 36
2025-11-17 17:23:04,519 - INFO - Formato: Idéntico al machote
2025-11-17 17:23:04,520 - INFO - Tabla Excel: Con totales automáticos y filtros
2025-11-17 17:23:04,520 - INFO - Encabezados: Siempre visibles (paneles congelados)
2025-11-17 17:23:04,520 - INFO - ================================================================================
2025-11-17 17:23:04,520 - INFO - OK - Archivo guardado con formato: output_automatizado.xlsx
2025-11-17 17:23:04,520 - INFO - 
--- PASO 4: GENERACIÓN DE HOJA MORA ---
2025-11-17 17:23:04,520 - INFO - 
Iniciando generación de hoja MORA...
2025-11-17 17:23:04,521 - INFO - Registros con %mora > 5%: 7 de 208
2025-11-17 17:23:04,523 - INFO - Hoja MORA generada con 7 registros y 14 columnas
2025-11-17 17:23:04,523 - INFO - 
================================================================================
2025-11-17 17:23:04,523 - INFO - AGREGANDO HOJA MORA
2025-11-17 17:23:04,523 - INFO - ================================================================================
2025-11-17 17:23:04,523 - INFO - 
1. Abriendo archivo: output_automatizado.xlsx
2025-11-17 17:23:04,719 - INFO - 
2. Creando hoja 'Mora'
2025-11-17 17:23:04,719 - INFO - 
3. Copiando formato de headers desde plantilla
2025-11-17 17:23:04,741 - INFO - 
4. Estableciendo headers de MORA
2025-11-17 17:23:04,741 - INFO - 
5. Pegando 7 filas de datos
2025-11-17 17:23:04,744 - INFO - 
6. Creando tabla Excel con totales
2025-11-17 17:23:04,744 - INFO -    Creando tabla: A6:N14
2025-11-17 17:23:04,744 - INFO -    Tabla 'TablaMora' creada con totales automáticos
2025-11-17 17:23:04,745 - INFO -    Filtros automáticos habilitados en rango: A6:N6
2025-11-17 17:23:04,745 - INFO -    Fórmulas SUBTOTAL escritas en 6 columnas
2025-11-17 17:23:04,745 - INFO - 
6.1. Congelando paneles para mantener encabezados visibles...
2025-11-17 17:23:04,745 - INFO - Paneles congelados: Filas 1-6 siempre visibles
2025-11-17 17:23:04,745 - INFO - 
7. Guardando archivo con hoja MORA
2025-11-17 17:23:04,912 - INFO - 
================================================================================
2025-11-17 17:23:04,913 - INFO - HOJA MORA AGREGADA EXITOSAMENTE
2025-11-17 17:23:04,913 - INFO - ================================================================================
2025-11-17 17:23:04,913 - INFO - 
Registros en MORA: 7
2025-11-17 17:23:04,913 - INFO - Filtro: %mora > 5%
2025-11-17 17:23:04,913 - INFO - Columnas amarillas: %mora, Días de mora
2025-11-17 17:23:04,913 - INFO - Tabla Excel: Con totales automáticos y filtros
2025-11-17 17:23:04,913 - INFO - Encabezados: Siempre visibles (paneles congelados)
2025-11-17 17:23:04,914 - INFO - ================================================================================
2025-11-17 17:23:04,914 - INFO - OK - Hoja MORA agregada con 7 registros
2025-11-17 17:23:04,914 - INFO - 
--- PASO 5: VALIDACIÓN ---
2025-11-17 17:23:04,915 - INFO - Machote no encontrado - validación omitida (no es necesario)
2025-11-17 17:23:04,915 - INFO - 
================================================================================
2025-11-17 17:23:04,915 - INFO - AUTOMATIZACIÓN COMPLETADA EXITOSAMENTE
2025-11-17 17:23:04,915 - INFO - ================================================================================
2025-11-17 17:23:25,363 - INFO - ================================================================================
2025-11-17 17:23:25,363 - INFO - INICIO DE AUTOMATIZACIÓN DE CARTERA
2025-11-17 17:23:25,363 - INFO - ================================================================================
2025-11-17 17:23:25,363 - INFO - 
--- PASO 0: BÚSQUEDA DE ARCHIVOS ---
2025-11-17 17:23:25,364 - INFO - Archivo encontrado: data\ReportedeAntiguedaddeCarteraGrupal_12112025.xlsx
2025-11-17 17:23:25,364 - INFO - Archivo encontrado: data\Situación_de_cartera_12112025.xlsx
2025-11-17 17:23:25,364 - INFO - Archivo encontrado: data\Cobranza_12112025.xlsx
2025-11-17 17:23:25,365 - INFO - Archivo encontrado: data/AHORROS.xlsx
2025-11-17 17:23:25,365 - INFO - 
--- PASO 1: CARGA DE ARCHIVOS ---
2025-11-17 17:23:25,365 - INFO - Cargando ANTIGÜEDAD desde: data\ReportedeAntiguedaddeCarteraGrupal_12112025.xlsx
2025-11-17 17:23:25,385 - INFO - Hoja detectada: '121125'
2025-11-17 17:23:25,526 - INFO - ANTIGÜEDAD cargado: (206, 59)
2025-11-17 17:23:25,526 - INFO - Columnas: ['cod_region', 'coordinacion', 'nombre_de_gerente', 'codigo_promotor', 'nombre_promotor', 'codigo_recuperador', 'nombre_recuperador', 'cod_grupo_solidario', 'ciclo', 'grupo_solidario']...
2025-11-17 17:23:25,527 - INFO - No se encontraron IDs duplicados
2025-11-17 17:23:25,527 - INFO - Cargando SITUACIÓN DE CARTERA desde: data\Situación_de_cartera_12112025.xlsx
2025-11-17 17:23:25,650 - INFO - SITUACIÓN DE CARTERA cargada: (206, 43)
2025-11-17 17:23:25,650 - INFO - Columnas: ['codigo_ofic_cred', 'nombre_oficial_de_credito', 'codigo_promotor_cred', 'nombre_promotor_cred', 'codigo_coord', 'nombre_coordinacion', 'codigo_ger_regi', 'nombre_gerencia_regional', 'nombre_codigo', 'nombre_acreditado_cliente']...
2025-11-17 17:23:25,651 - INFO - Columna de código renombrada: nombre_codigo -> codigo
2025-11-17 17:23:25,652 - INFO - Cargando REPORTE DE COBRANZA desde: data\Cobranza_12112025.xlsx
2025-11-17 17:23:25,843 - INFO - REPORTE DE COBRANZA cargado: (207, 68)
2025-11-17 17:23:25,843 - INFO - Columnas: ['regional', 'regional1', 'coordinacion', 'coordinacion1', 'de_credito', 'de_credito1', 'gpo', 'cliente_grupo', 'unnamed:_8', 'del_cliente']...
2025-11-17 17:23:25,844 - INFO - Cargando AHORROS (ACUMULADO) desde: data/AHORROS.xlsx
2025-11-17 17:23:25,883 - INFO - AHORROS cargado: (208, 4)
2025-11-17 17:23:25,883 - INFO - Columnas: ['id', 'grupo', 'ciclo', 'ahorro_acumulado']
2025-11-17 17:23:25,884 - INFO - PARCHE PROMOTORES cargado: 1 correcciones
2025-11-17 17:23:25,884 - INFO - 
--- PASO 2: GENERACIÓN DE CARTERA ---
2025-11-17 17:23:25,884 - INFO - Iniciando generación de cartera (VERSIÓN CORREGIDA)...
2025-11-17 17:23:25,884 - INFO - Registros en antiguedad: 206
2025-11-17 17:23:25,886 - INFO - ID de grupo generados: 0    000089
1    000145
2    000069
3    000079
4    000104
Name: id_de_grupo, dtype: object
2025-11-17 17:23:25,906 - INFO - Después de joins: 208 registros
2025-11-17 17:23:25,906 - INFO - NaN en situacion: 2
2025-11-17 17:23:25,907 - INFO - NaN en cobranza: 1
2025-11-17 17:23:25,907 - INFO - NaN en ahorros: 3
2025-11-17 17:23:25,908 - INFO - Parche aplicado: 1 correcciones
2025-11-17 17:23:25,915 - INFO - Estatus calculados: {'Vigente': 208}
2025-11-17 17:23:25,916 - INFO - Cartera vigente sistema calculada como: saldo_total (de ANTIGÜEDAD)
2025-11-17 17:23:25,931 - INFO - Cartera generada exitosamente: 208 filas x 36 columnas
2025-11-17 17:23:25,931 - INFO - 
--- PASO 3: GUARDADO DE RESULTADO CON FORMATO ---
2025-11-17 17:23:25,931 - INFO - ================================================================================
2025-11-17 17:23:25,931 - INFO - GUARDANDO DATAFRAME CON FORMATO
2025-11-17 17:23:25,931 - INFO - ================================================================================
2025-11-17 17:23:25,931 - INFO - 
1. Cargando plantilla de headers: plantilla/CARTERA_HEADERS.xlsx
2025-11-17 17:23:25,940 - INFO - Plantilla cargada: 6 filas x 36 columnas (6.1 KB)
2025-11-17 17:23:25,940 - INFO - 
2. Creando nuevo workbook...
2025-11-17 17:23:25,941 - INFO - 
3. Copiando headers desde plantilla...
2025-11-17 17:23:25,942 - INFO - Copiando headers (filas 1-6) con formato...
2025-11-17 17:23:25,982 - INFO - Headers copiados: 36 columnas
2025-11-17 17:23:25,982 - INFO - 
4. Pegando datos del DataFrame...
2025-11-17 17:23:25,982 - INFO - Pegando DataFrame (208 filas x 36 columnas) desde fila 7...
2025-11-17 17:23:26,027 - INFO - Datos pegados hasta fila 214
2025-11-17 17:23:26,027 - INFO - 
5. Aplicando formatos de columnas...
2025-11-17 17:23:26,027 - INFO - Aplicando formatos de columnas desde fila 7 hasta 214...
2025-11-17 17:23:26,037 - INFO - Formatos aplicados a 208 filas
2025-11-17 17:23:26,037 - INFO - 
6. Creando tabla de Excel con totales...
2025-11-17 17:23:26,038 - INFO - Creando tabla Excel 'TablaCartera' desde fila 6 hasta 214...
2025-11-17 17:23:26,038 - INFO - Rango de tabla: A6:AJ215
2025-11-17 17:23:26,038 - INFO - Fila de totales: 215
2025-11-17 17:23:26,038 - INFO - Nombres de columnas extraídos: 36
2025-11-17 17:23:26,038 - INFO -   Columna 6 'Monto del crédito': SUM
2025-11-17 17:23:26,038 - INFO -   Columna 13 'Pago Semanal': SUM
2025-11-17 17:23:26,038 - INFO -   Columna 15 'Cartera vigente sistema': SUM
2025-11-17 17:23:26,038 - INFO -   Columna 16 'Carera vigente inicial': SUM
2025-11-17 17:23:26,038 - INFO -   Columna 17 'Cartera vigente calculada': SUM
2025-11-17 17:23:26,039 - INFO -   Columna 18 'Cartera Insoluta': SUM
2025-11-17 17:23:26,039 - INFO -   Columna 19 'Diferencia Validación vigente': SUM
2025-11-17 17:23:26,039 - INFO -   Columna 20 'Ahorro Consumido': SUM
2025-11-17 17:23:26,039 - INFO -   Columna 21 'Cartera Vencida Estadistica': SUM
2025-11-17 17:23:26,039 - INFO -   Columna 22 'Cartera vencida Total': SUM
2025-11-17 17:23:26,039 - INFO -   Columna 24 'Saldo en riesgo': SUM
2025-11-17 17:23:26,039 - INFO -   Columna 25 'Saldo 
ahorro 
acumulado': SUM
2025-11-17 17:23:26,039 - INFO -   Columna 26 'Monto promedio del grupo': SUM
2025-11-17 17:23:26,040 - INFO -   Columna 33 'Ahorro Acumulado': SUM
2025-11-17 17:23:26,040 - INFO - Filtros automáticos habilitados en rango: A6:AJ6
2025-11-17 17:23:26,040 - INFO - Escribiendo fórmulas en fila de totales...
2025-11-17 17:23:26,040 - INFO -   Fórmula en columna 6: =SUBTOTAL(109,F7:F214)
2025-11-17 17:23:26,040 - INFO -   Fórmula en columna 13: =SUBTOTAL(109,M7:M214)
2025-11-17 17:23:26,040 - INFO -   Fórmula en columna 15: =SUBTOTAL(109,O7:O214)
2025-11-17 17:23:26,040 - INFO -   Fórmula en columna 16: =SUBTOTAL(109,P7:P214)
2025-11-17 17:23:26,040 - INFO -   Fórmula en columna 17: =SUBTOTAL(109,Q7:Q214)
2025-11-17 17:23:26,040 - INFO -   Fórmula en columna 18: =SUBTOTAL(109,R7:R214)
2025-11-17 17:23:26,040 - INFO -   Fórmula en columna 19: =SUBTOTAL(109,S7:S214)
2025-11-17 17:23:26,040 - INFO -   Fórmula en columna 20: =SUBTOTAL(109,T7:T214)
2025-11-17 17:23:26,041 - INFO -   Fórmula en columna 21: =SUBTOTAL(109,U7:U214)
2025-11-17 17:23:26,041 - INFO -   Fórmula en columna 22: =SUBTOTAL(109,V7:V214)
2025-11-17 17:23:26,041 - INFO -   Fórmula en columna 24: =SUBTOTAL(109,X7:X214)
2025-11-17 17:23:26,041 - INFO -   Fórmula en columna 25: =SUBTOTAL(109,Y7:Y214)
2025-11-17 17:23:26,041 - INFO -   Fórmula en columna 26: =SUBTOTAL(109,Z7:Z214)
2025-11-17 17:23:26,041 - INFO -   Fórmula en columna 33: =SUBTOTAL(109,AG7:AG214)
2025-11-17 17:23:26,041 - INFO - Tabla creada exitosamente con 208 filas de datos + fila totales
2025-11-17 17:23:26,041 - INFO - Totales configurados en 14 columnas con fórmulas SUBTOTAL
2025-11-17 17:23:26,041 - INFO - Fila de totales: Formato aplicado automáticamente por la tabla
2025-11-17 17:23:26,041 - INFO - 
6.0. Re-aplicando formato sin paréntesis a columna 18...
2025-11-17 17:23:26,042 - INFO - Formato re-aplicado a columna 18 (Diferencia validación vigente) desde fila 7 hasta 215
2025-11-17 17:23:26,042 - INFO - 
6.1. Congelando paneles para mantener encabezados visibles...
2025-11-17 17:23:26,042 - INFO - Paneles congelados: Filas 1-6 siempre visibles
2025-11-17 17:23:26,042 - INFO - 
7. Guardando archivo: output_automatizado.xlsx
2025-11-17 17:23:26,184 - INFO - 
================================================================================
2025-11-17 17:23:26,184 - INFO - ARCHIVO GUARDADO EXITOSAMENTE
2025-11-17 17:23:26,184 - INFO - ================================================================================
2025-11-17 17:23:26,184 - INFO - 
Archivo: output_automatizado.xlsx
2025-11-17 17:23:26,184 - INFO - Filas de datos: 208
2025-11-17 17:23:26,184 - INFO - Columnas: 36
2025-11-17 17:23:26,184 - INFO - Formato: Idéntico al machote
2025-11-17 17:23:26,184 - INFO - Tabla Excel: Con totales automáticos y filtros
2025-11-17 17:23:26,185 - INFO - Encabezados: Siempre visibles (paneles congelados)
2025-11-17 17:23:26,185 - INFO - ================================================================================
2025-11-17 17:23:26,185 - INFO - OK - Archivo guardado con formato: output_automatizado.xlsx
2025-11-17 17:23:26,185 - INFO - 
--- PASO 4: GENERACIÓN DE HOJA MORA ---
2025-11-17 17:23:26,185 - INFO - 
Iniciando generación de hoja MORA...
2025-11-17 17:23:26,186 - INFO - Registros con %mora > 5%: 7 de 208
2025-11-17 17:23:26,188 - INFO - Hoja MORA generada con 7 registros y 14 columnas
2025-11-17 17:23:26,188 - INFO - 
================================================================================
2025-11-17 17:23:26,188 - INFO - AGREGANDO HOJA MORA
2025-11-17 17:23:26,188 - INFO - ================================================================================
2025-11-17 17:23:26,188 - INFO - 
1. Abriendo archivo: output_automatizado.xlsx
2025-11-17 17:23:26,370 - INFO - 
2. Creando hoja 'Mora'
2025-11-17 17:23:26,370 - INFO - 
3. Copiando formato de headers desde plantilla
2025-11-17 17:23:26,392 - INFO - 
4. Estableciendo headers de MORA
2025-11-17 17:23:26,392 - INFO - 
5. Pegando 7 filas de datos
2025-11-17 17:23:26,394 - INFO - 
6. Creando tabla Excel con totales
2025-11-17 17:23:26,394 - INFO -    Creando tabla: A6:N14
2025-11-17 17:23:26,394 - INFO -    Tabla 'TablaMora' creada con totales automáticos
2025-11-17 17:23:26,395 - INFO -    Filtros automáticos habilitados en rango: A6:N6
2025-11-17 17:23:26,395 - INFO -    Fórmulas SUBTOTAL escritas en 6 columnas
2025-11-17 17:23:26,395 - INFO - 
6.1. Congelando paneles para mantener encabezados visibles...
2025-11-17 17:23:26,395 - INFO - Paneles congelados: Filas 1-6 siempre visibles
2025-11-17 17:23:26,395 - INFO - 
7. Guardando archivo con hoja MORA
2025-11-17 17:23:26,534 - INFO - 
================================================================================
2025-11-17 17:23:26,534 - INFO - HOJA MORA AGREGADA EXITOSAMENTE
2025-11-17 17:23:26,534 - INFO - ================================================================================
2025-11-17 17:23:26,534 - INFO - 
Registros en MORA: 7
2025-11-17 17:23:26,534 - INFO - Filtro: %mora > 5%
2025-11-17 17:23:26,534 - INFO - Columnas amarillas: %mora, Días de mora
2025-11-17 17:23:26,534 - INFO - Tabla Excel: Con totales automáticos y filtros
2025-11-17 17:23:26,535 - INFO - Encabezados: Siempre visibles (paneles congelados)
2025-11-17 17:23:26,535 - INFO - ================================================================================
2025-11-17 17:23:26,535 - INFO - OK - Hoja MORA agregada con 7 registros
2025-11-17 17:23:26,535 - INFO - 
--- PASO 5: VALIDACIÓN ---
2025-11-17 17:23:26,535 - INFO - Machote no encontrado - validación omitida (no es necesario)
2025-11-17 17:23:26,536 - INFO - 
================================================================================
2025-11-17 17:23:26,536 - INFO - AUTOMATIZACIÓN COMPLETADA EXITOSAMENTE
2025-11-17 17:23:26,536 - INFO - ================================================================================
2025-11-17 17:24:10,760 - INFO - ================================================================================
2025-11-17 17:24:10,761 - INFO - INICIO DE AUTOMATIZACIÓN DE CARTERA
2025-11-17 17:24:10,761 - INFO - ================================================================================
2025-11-17 17:24:10,761 - INFO - 
--- PASO 0: BÚSQUEDA DE ARCHIVOS ---
2025-11-17 17:24:10,762 - INFO - Archivo encontrado: data\ReportedeAntiguedaddeCarteraGrupal_12112025.xlsx
2025-11-17 17:24:10,762 - INFO - Archivo encontrado: data\Situación_de_cartera_12112025.xlsx
2025-11-17 17:24:10,763 - INFO - Archivo encontrado: data\Cobranza_12112025.xlsx
2025-11-17 17:24:10,763 - INFO - Archivo encontrado: data/AHORROS.xlsx
2025-11-17 17:24:10,763 - INFO - 
--- PASO 1: CARGA DE ARCHIVOS ---
2025-11-17 17:24:10,763 - INFO - Cargando ANTIGÜEDAD desde: data\ReportedeAntiguedaddeCarteraGrupal_12112025.xlsx
2025-11-17 17:24:10,783 - INFO - Hoja detectada: '121125'
2025-11-17 17:24:10,949 - INFO - ANTIGÜEDAD cargado: (206, 59)
2025-11-17 17:24:10,949 - INFO - Columnas: ['cod_region', 'coordinacion', 'nombre_de_gerente', 'codigo_promotor', 'nombre_promotor', 'codigo_recuperador', 'nombre_recuperador', 'cod_grupo_solidario', 'ciclo', 'grupo_solidario']...
2025-11-17 17:24:10,950 - INFO - No se encontraron IDs duplicados
2025-11-17 17:24:10,950 - INFO - Cargando SITUACIÓN DE CARTERA desde: data\Situación_de_cartera_12112025.xlsx
2025-11-17 17:24:11,066 - INFO - SITUACIÓN DE CARTERA cargada: (206, 43)
2025-11-17 17:24:11,067 - INFO - Columnas: ['codigo_ofic_cred', 'nombre_oficial_de_credito', 'codigo_promotor_cred', 'nombre_promotor_cred', 'codigo_coord', 'nombre_coordinacion', 'codigo_ger_regi', 'nombre_gerencia_regional', 'nombre_codigo', 'nombre_acreditado_cliente']...
2025-11-17 17:24:11,067 - INFO - Columna de código renombrada: nombre_codigo -> codigo
2025-11-17 17:24:11,069 - INFO - Cargando REPORTE DE COBRANZA desde: data\Cobranza_12112025.xlsx
2025-11-17 17:24:11,242 - INFO - REPORTE DE COBRANZA cargado: (207, 68)
2025-11-17 17:24:11,242 - INFO - Columnas: ['regional', 'regional1', 'coordinacion', 'coordinacion1', 'de_credito', 'de_credito1', 'gpo', 'cliente_grupo', 'unnamed:_8', 'del_cliente']...
2025-11-17 17:24:11,243 - INFO - Cargando AHORROS (ACUMULADO) desde: data/AHORROS.xlsx
2025-11-17 17:24:11,281 - INFO - AHORROS cargado: (208, 4)
2025-11-17 17:24:11,281 - INFO - Columnas: ['id', 'grupo', 'ciclo', 'ahorro_acumulado']
2025-11-17 17:24:11,282 - INFO - PARCHE PROMOTORES cargado: 1 correcciones
2025-11-17 17:24:11,282 - INFO - 
--- PASO 2: GENERACIÓN DE CARTERA ---
2025-11-17 17:24:11,282 - INFO - Iniciando generación de cartera (VERSIÓN CORREGIDA)...
2025-11-17 17:24:11,282 - INFO - Registros en antiguedad: 206
2025-11-17 17:24:11,285 - INFO - ID de grupo generados: 0    000089
1    000145
2    000069
3    000079
4    000104
Name: id_de_grupo, dtype: object
2025-11-17 17:24:11,301 - INFO - Después de joins: 208 registros
2025-11-17 17:24:11,301 - INFO - NaN en situacion: 2
2025-11-17 17:24:11,302 - INFO - NaN en cobranza: 1
2025-11-17 17:24:11,302 - INFO - NaN en ahorros: 3
2025-11-17 17:24:11,303 - INFO - Parche aplicado: 1 correcciones
2025-11-17 17:24:11,309 - INFO - Estatus calculados: {'Vigente': 208}
2025-11-17 17:24:11,310 - INFO - Cartera vigente sistema calculada como: saldo_total (de ANTIGÜEDAD)
2025-11-17 17:24:11,324 - INFO - Cartera generada exitosamente: 208 filas x 36 columnas
2025-11-17 17:24:11,324 - INFO - 
--- PASO 3: GUARDADO DE RESULTADO CON FORMATO ---
2025-11-17 17:24:11,324 - INFO - ================================================================================
2025-11-17 17:24:11,324 - INFO - GUARDANDO DATAFRAME CON FORMATO
2025-11-17 17:24:11,324 - INFO - ================================================================================
2025-11-17 17:24:11,324 - INFO - 
1. Cargando plantilla de headers: plantilla/CARTERA_HEADERS.xlsx
2025-11-17 17:24:11,333 - INFO - Plantilla cargada: 6 filas x 36 columnas (6.1 KB)
2025-11-17 17:24:11,333 - INFO - 
2. Creando nuevo workbook...
2025-11-17 17:24:11,334 - INFO - 
3. Copiando headers desde plantilla...
2025-11-17 17:24:11,335 - INFO - Copiando headers (filas 1-6) con formato...
2025-11-17 17:24:11,377 - INFO - Headers copiados: 36 columnas
2025-11-17 17:24:11,377 - INFO - 
4. Pegando datos del DataFrame...
2025-11-17 17:24:11,377 - INFO - Pegando DataFrame (208 filas x 36 columnas) desde fila 7...
2025-11-17 17:24:11,420 - INFO - Datos pegados hasta fila 214
2025-11-17 17:24:11,421 - INFO - 
5. Aplicando formatos de columnas...
2025-11-17 17:24:11,421 - INFO - Aplicando formatos de columnas desde fila 7 hasta 214...
2025-11-17 17:24:11,431 - INFO - Formatos aplicados a 208 filas
2025-11-17 17:24:11,431 - INFO - 
6. Creando tabla de Excel con totales...
2025-11-17 17:24:11,431 - INFO - Creando tabla Excel 'TablaCartera' desde fila 6 hasta 214...
2025-11-17 17:24:11,431 - INFO - Rango de tabla: A6:AJ215
2025-11-17 17:24:11,431 - INFO - Fila de totales: 215
2025-11-17 17:24:11,431 - INFO - Nombres de columnas extraídos: 36
2025-11-17 17:24:11,431 - INFO -   Columna 6 'Monto del crédito': SUM
2025-11-17 17:24:11,431 - INFO -   Columna 13 'Pago Semanal': SUM
2025-11-17 17:24:11,432 - INFO -   Columna 15 'Cartera vigente sistema': SUM
2025-11-17 17:24:11,432 - INFO -   Columna 16 'Carera vigente inicial': SUM
2025-11-17 17:24:11,432 - INFO -   Columna 17 'Cartera vigente calculada': SUM
2025-11-17 17:24:11,432 - INFO -   Columna 18 'Cartera Insoluta': SUM
2025-11-17 17:24:11,432 - INFO -   Columna 19 'Diferencia Validación vigente': SUM
2025-11-17 17:24:11,432 - INFO -   Columna 20 'Ahorro Consumido': SUM
2025-11-17 17:24:11,433 - INFO -   Columna 21 'Cartera Vencida Estadistica': SUM
2025-11-17 17:24:11,433 - INFO -   Columna 22 'Cartera vencida Total': SUM
2025-11-17 17:24:11,433 - INFO -   Columna 24 'Saldo en riesgo': SUM
2025-11-17 17:24:11,433 - INFO -   Columna 25 'Saldo 
ahorro 
acumulado': SUM
2025-11-17 17:24:11,433 - INFO -   Columna 26 'Monto promedio del grupo': SUM
2025-11-17 17:24:11,433 - INFO -   Columna 33 'Ahorro Acumulado': SUM
2025-11-17 17:24:11,433 - INFO - Filtros automáticos habilitados en rango: A6:AJ6
2025-11-17 17:24:11,433 - INFO - Escribiendo fórmulas en fila de totales...
2025-11-17 17:24:11,434 - INFO -   Fórmula en columna 6: =SUBTOTAL(109,F7:F214)
2025-11-17 17:24:11,434 - INFO -   Fórmula en columna 13: =SUBTOTAL(109,M7:M214)
2025-11-17 17:24:11,434 - INFO -   Fórmula en columna 15: =SUBTOTAL(109,O7:O214)
2025-11-17 17:24:11,434 - INFO -   Fórmula en columna 16: =SUBTOTAL(109,P7:P214)
2025-11-17 17:24:11,434 - INFO -   Fórmula en columna 17: =SUBTOTAL(109,Q7:Q214)
2025-11-17 17:24:11,434 - INFO -   Fórmula en columna 18: =SUBTOTAL(109,R7:R214)
2025-11-17 17:24:11,434 - INFO -   Fórmula en columna 19: =SUBTOTAL(109,S7:S214)
2025-11-17 17:24:11,434 - INFO -   Fórmula en columna 20: =SUBTOTAL(109,T7:T214)
2025-11-17 17:24:11,434 - INFO -   Fórmula en columna 21: =SUBTOTAL(109,U7:U214)
2025-11-17 17:24:11,434 - INFO -   Fórmula en columna 22: =SUBTOTAL(109,V7:V214)
2025-11-17 17:24:11,434 - INFO -   Fórmula en columna 24: =SUBTOTAL(109,X7:X214)
2025-11-17 17:24:11,434 - INFO -   Fórmula en columna 25: =SUBTOTAL(109,Y7:Y214)
2025-11-17 17:24:11,434 - INFO -   Fórmula en columna 26: =SUBTOTAL(109,Z7:Z214)
2025-11-17 17:24:11,434 - INFO -   Fórmula en columna 33: =SUBTOTAL(109,AG7:AG214)
2025-11-17 17:24:11,434 - INFO - Tabla creada exitosamente con 208 filas de datos + fila totales
2025-11-17 17:24:11,435 - INFO - Totales configurados en 14 columnas con fórmulas SUBTOTAL
2025-11-17 17:24:11,435 - INFO - Fila de totales: Formato aplicado automáticamente por la tabla
2025-11-17 17:24:11,435 - INFO - 
6.0. Re-aplicando formato sin paréntesis a columna 18...
2025-11-17 17:24:11,435 - INFO - Formato re-aplicado a columna 18 (Diferencia validación vigente) desde fila 7 hasta 215
2025-11-17 17:24:11,435 - INFO - 
6.1. Congelando paneles para mantener encabezados visibles...
2025-11-17 17:24:11,435 - INFO - Paneles congelados: Filas 1-6 siempre visibles
2025-11-17 17:24:11,436 - INFO - 
7. Guardando archivo: output_automatizado.xlsx
2025-11-17 17:24:11,559 - INFO - 
================================================================================
2025-11-17 17:24:11,559 - INFO - ARCHIVO GUARDADO EXITOSAMENTE
2025-11-17 17:24:11,559 - INFO - ================================================================================
2025-11-17 17:24:11,559 - INFO - 
Archivo: output_automatizado.xlsx
2025-11-17 17:24:11,559 - INFO - Filas de datos: 208
2025-11-17 17:24:11,559 - INFO - Columnas: 36
2025-11-17 17:24:11,559 - INFO - Formato: Idéntico al machote
2025-11-17 17:24:11,559 - INFO - Tabla Excel: Con totales automáticos y filtros
2025-11-17 17:24:11,560 - INFO - Encabezados: Siempre visibles (paneles congelados)
2025-11-17 17:24:11,560 - INFO - ================================================================================
2025-11-17 17:24:11,560 - INFO - OK - Archivo guardado con formato: output_automatizado.xlsx
2025-11-17 17:24:11,560 - INFO - 
--- PASO 4: GENERACIÓN DE HOJA MORA ---
2025-11-17 17:24:11,560 - INFO - 
Iniciando generación de hoja MORA...
2025-11-17 17:24:11,561 - INFO - Registros con %mora > 5%: 7 de 208
2025-11-17 17:24:11,563 - INFO - Hoja MORA generada con 7 registros y 14 columnas
2025-11-17 17:24:11,564 - INFO - 
================================================================================
2025-11-17 17:24:11,564 - INFO - AGREGANDO HOJA MORA
2025-11-17 17:24:11,564 - INFO - ================================================================================
2025-11-17 17:24:11,564 - INFO - 
1. Abriendo archivo: output_automatizado.xlsx
2025-11-17 17:24:11,739 - INFO - 
2. Creando hoja 'Mora'
2025-11-17 17:24:11,740 - INFO - 
3. Copiando formato de headers desde plantilla
2025-11-17 17:24:11,761 - INFO - 
4. Estableciendo headers de MORA
2025-11-17 17:24:11,761 - INFO - 
5. Pegando 7 filas de datos
2025-11-17 17:24:11,763 - INFO - 
6. Creando tabla Excel con totales
2025-11-17 17:24:11,763 - INFO -    Creando tabla: A6:N14
2025-11-17 17:24:11,764 - INFO -    Tabla 'TablaMora' creada con totales automáticos
2025-11-17 17:24:11,764 - INFO -    Filtros automáticos habilitados en rango: A6:N6
2025-11-17 17:24:11,764 - INFO -    Fórmulas SUBTOTAL escritas en 6 columnas
2025-11-17 17:24:11,764 - INFO - 
6.1. Congelando paneles para mantener encabezados visibles...
2025-11-17 17:24:11,764 - INFO - Paneles congelados: Filas 1-6 siempre visibles
2025-11-17 17:24:11,764 - INFO - 
7. Guardando archivo con hoja MORA
2025-11-17 17:24:11,900 - INFO - 
================================================================================
2025-11-17 17:24:11,900 - INFO - HOJA MORA AGREGADA EXITOSAMENTE
2025-11-17 17:24:11,900 - INFO - ================================================================================
2025-11-17 17:24:11,900 - INFO - 
Registros en MORA: 7
2025-11-17 17:24:11,900 - INFO - Filtro: %mora > 5%
2025-11-17 17:24:11,900 - INFO - Columnas amarillas: %mora, Días de mora
2025-11-17 17:24:11,900 - INFO - Tabla Excel: Con totales automáticos y filtros
2025-11-17 17:24:11,900 - INFO - Encabezados: Siempre visibles (paneles congelados)
2025-11-17 17:24:11,900 - INFO - ================================================================================
2025-11-17 17:24:11,900 - INFO - OK - Hoja MORA agregada con 7 registros
2025-11-17 17:24:11,900 - INFO - 
--- PASO 5: VALIDACIÓN ---
2025-11-17 17:24:11,901 - INFO - Machote no encontrado - validación omitida (no es necesario)
2025-11-17 17:24:11,901 - INFO - 
================================================================================
2025-11-17 17:24:11,901 - INFO - AUTOMATIZACIÓN COMPLETADA EXITOSAMENTE
2025-11-17 17:24:11,901 - INFO - ================================================================================
2025-11-17 17:24:35,265 - INFO - ================================================================================
2025-11-17 17:24:35,265 - INFO - INICIO DE AUTOMATIZACIÓN DE CARTERA
2025-11-17 17:24:35,265 - INFO - ================================================================================
2025-11-17 17:24:35,265 - INFO - 
--- PASO 0: BÚSQUEDA DE ARCHIVOS ---
2025-11-17 17:24:35,266 - INFO - Archivo encontrado: data\ReportedeAntiguedaddeCarteraGrupal_12112025.xlsx
2025-11-17 17:24:35,267 - INFO - Archivo encontrado: data\Situación_de_cartera_12112025.xlsx
2025-11-17 17:24:35,267 - INFO - Archivo encontrado: data\Cobranza_12112025.xlsx
2025-11-17 17:24:35,267 - INFO - Archivo encontrado: data/AHORROS.xlsx
2025-11-17 17:24:35,267 - INFO - 
--- PASO 1: CARGA DE ARCHIVOS ---
2025-11-17 17:24:35,268 - INFO - Cargando ANTIGÜEDAD desde: data\ReportedeAntiguedaddeCarteraGrupal_12112025.xlsx
2025-11-17 17:24:35,288 - INFO - Hoja detectada: '121125'
2025-11-17 17:24:35,432 - INFO - ANTIGÜEDAD cargado: (206, 59)
2025-11-17 17:24:35,432 - INFO - Columnas: ['cod_region', 'coordinacion', 'nombre_de_gerente', 'codigo_promotor', 'nombre_promotor', 'codigo_recuperador', 'nombre_recuperador', 'cod_grupo_solidario', 'ciclo', 'grupo_solidario']...
2025-11-17 17:24:35,432 - INFO - No se encontraron IDs duplicados
2025-11-17 17:24:35,432 - INFO - Cargando SITUACIÓN DE CARTERA desde: data\Situación_de_cartera_12112025.xlsx
2025-11-17 17:24:35,554 - INFO - SITUACIÓN DE CARTERA cargada: (206, 43)
2025-11-17 17:24:35,555 - INFO - Columnas: ['codigo_ofic_cred', 'nombre_oficial_de_credito', 'codigo_promotor_cred', 'nombre_promotor_cred', 'codigo_coord', 'nombre_coordinacion', 'codigo_ger_regi', 'nombre_gerencia_regional', 'nombre_codigo', 'nombre_acreditado_cliente']...
2025-11-17 17:24:35,555 - INFO - Columna de código renombrada: nombre_codigo -> codigo
2025-11-17 17:24:35,556 - INFO - Cargando REPORTE DE COBRANZA desde: data\Cobranza_12112025.xlsx
2025-11-17 17:24:35,733 - INFO - REPORTE DE COBRANZA cargado: (207, 68)
2025-11-17 17:24:35,733 - INFO - Columnas: ['regional', 'regional1', 'coordinacion', 'coordinacion1', 'de_credito', 'de_credito1', 'gpo', 'cliente_grupo', 'unnamed:_8', 'del_cliente']...
2025-11-17 17:24:35,733 - INFO - Cargando AHORROS (ACUMULADO) desde: data/AHORROS.xlsx
2025-11-17 17:24:35,771 - INFO - AHORROS cargado: (208, 4)
2025-11-17 17:24:35,771 - INFO - Columnas: ['id', 'grupo', 'ciclo', 'ahorro_acumulado']
2025-11-17 17:24:35,771 - INFO - PARCHE PROMOTORES cargado: 1 correcciones
2025-11-17 17:24:35,771 - INFO - 
--- PASO 2: GENERACIÓN DE CARTERA ---
2025-11-17 17:24:35,771 - INFO - Iniciando generación de cartera (VERSIÓN CORREGIDA)...
2025-11-17 17:24:35,771 - INFO - Registros en antiguedad: 206
2025-11-17 17:24:35,773 - INFO - ID de grupo generados: 0    000089
1    000145
2    000069
3    000079
4    000104
Name: id_de_grupo, dtype: object
2025-11-17 17:24:35,789 - INFO - Después de joins: 208 registros
2025-11-17 17:24:35,789 - INFO - NaN en situacion: 2
2025-11-17 17:24:35,790 - INFO - NaN en cobranza: 1
2025-11-17 17:24:35,790 - INFO - NaN en ahorros: 3
2025-11-17 17:24:35,792 - INFO - Parche aplicado: 1 correcciones
2025-11-17 17:24:35,798 - INFO - Estatus calculados: {'Vigente': 208}
2025-11-17 17:24:35,799 - INFO - Cartera vigente sistema calculada como: saldo_total (de ANTIGÜEDAD)
2025-11-17 17:24:35,814 - INFO - Cartera generada exitosamente: 208 filas x 36 columnas
2025-11-17 17:24:35,815 - INFO - 
--- PASO 3: GUARDADO DE RESULTADO CON FORMATO ---
2025-11-17 17:24:35,815 - INFO - ================================================================================
2025-11-17 17:24:35,815 - INFO - GUARDANDO DATAFRAME CON FORMATO
2025-11-17 17:24:35,815 - INFO - ================================================================================
2025-11-17 17:24:35,815 - INFO - 
1. Cargando plantilla de headers: plantilla/CARTERA_HEADERS.xlsx
2025-11-17 17:24:35,824 - INFO - Plantilla cargada: 6 filas x 36 columnas (6.1 KB)
2025-11-17 17:24:35,824 - INFO - 
2. Creando nuevo workbook...
2025-11-17 17:24:35,825 - INFO - 
3. Copiando headers desde plantilla...
2025-11-17 17:24:35,825 - INFO - Copiando headers (filas 1-6) con formato...
2025-11-17 17:24:35,872 - INFO - Headers copiados: 36 columnas
2025-11-17 17:24:35,872 - INFO - 
4. Pegando datos del DataFrame...
2025-11-17 17:24:35,872 - INFO - Pegando DataFrame (208 filas x 36 columnas) desde fila 7...
2025-11-17 17:24:35,914 - INFO - Datos pegados hasta fila 214
2025-11-17 17:24:35,915 - INFO - 
5. Aplicando formatos de columnas...
2025-11-17 17:24:35,915 - INFO - Aplicando formatos de columnas desde fila 7 hasta 214...
2025-11-17 17:24:35,925 - INFO - Formatos aplicados a 208 filas
2025-11-17 17:24:35,925 - INFO - 
6. Creando tabla de Excel con totales...
2025-11-17 17:24:35,925 - INFO - Creando tabla Excel 'TablaCartera' desde fila 6 hasta 214...
2025-11-17 17:24:35,925 - INFO - Rango de tabla: A6:AJ215
2025-11-17 17:24:35,925 - INFO - Fila de totales: 215
2025-11-17 17:24:35,925 - INFO - Nombres de columnas extraídos: 36
2025-11-17 17:24:35,925 - INFO -   Columna 6 'Monto del crédito': SUM
2025-11-17 17:24:35,925 - INFO -   Columna 13 'Pago Semanal': SUM
2025-11-17 17:24:35,926 - INFO -   Columna 15 'Cartera vigente sistema': SUM
2025-11-17 17:24:35,926 - INFO -   Columna 16 'Carera vigente inicial': SUM
2025-11-17 17:24:35,926 - INFO -   Columna 17 'Cartera vigente calculada': SUM
2025-11-17 17:24:35,926 - INFO -   Columna 18 'Cartera Insoluta': SUM
2025-11-17 17:24:35,926 - INFO -   Columna 19 'Diferencia Validación vigente': SUM
2025-11-17 17:24:35,926 - INFO -   Columna 20 'Ahorro Consumido': SUM
2025-11-17 17:24:35,926 - INFO -   Columna 21 'Cartera Vencida Estadistica': SUM
2025-11-17 17:24:35,926 - INFO -   Columna 22 'Cartera vencida Total': SUM
2025-11-17 17:24:35,926 - INFO -   Columna 24 'Saldo en riesgo': SUM
2025-11-17 17:24:35,926 - INFO -   Columna 25 'Saldo 
ahorro 
acumulado': SUM
2025-11-17 17:24:35,926 - INFO -   Columna 26 'Monto promedio del grupo': SUM
2025-11-17 17:24:35,927 - INFO -   Columna 33 'Ahorro Acumulado': SUM
2025-11-17 17:24:35,927 - INFO - Filtros automáticos habilitados en rango: A6:AJ6
2025-11-17 17:24:35,927 - INFO - Escribiendo fórmulas en fila de totales...
2025-11-17 17:24:35,927 - INFO -   Fórmula en columna 6: =SUBTOTAL(109,F7:F214)
2025-11-17 17:24:35,927 - INFO -   Fórmula en columna 13: =SUBTOTAL(109,M7:M214)
2025-11-17 17:24:35,927 - INFO -   Fórmula en columna 15: =SUBTOTAL(109,O7:O214)
2025-11-17 17:24:35,927 - INFO -   Fórmula en columna 16: =SUBTOTAL(109,P7:P214)
2025-11-17 17:24:35,927 - INFO -   Fórmula en columna 17: =SUBTOTAL(109,Q7:Q214)
2025-11-17 17:24:35,927 - INFO -   Fórmula en columna 18: =SUBTOTAL(109,R7:R214)
2025-11-17 17:24:35,927 - INFO -   Fórmula en columna 19: =SUBTOTAL(109,S7:S214)
2025-11-17 17:24:35,927 - INFO -   Fórmula en columna 20: =SUBTOTAL(109,T7:T214)
2025-11-17 17:24:35,928 - INFO -   Fórmula en columna 21: =SUBTOTAL(109,U7:U214)
2025-11-17 17:24:35,928 - INFO -   Fórmula en columna 22: =SUBTOTAL(109,V7:V214)
2025-11-17 17:24:35,928 - INFO -   Fórmula en columna 24: =SUBTOTAL(109,X7:X214)
2025-11-17 17:24:35,928 - INFO -   Fórmula en columna 25: =SUBTOTAL(109,Y7:Y214)
2025-11-17 17:24:35,928 - INFO -   Fórmula en columna 26: =SUBTOTAL(109,Z7:Z214)
2025-11-17 17:24:35,929 - INFO -   Fórmula en columna 33: =SUBTOTAL(109,AG7:AG214)
2025-11-17 17:24:35,929 - INFO - Tabla creada exitosamente con 208 filas de datos + fila totales
2025-11-17 17:24:35,929 - INFO - Totales configurados en 14 columnas con fórmulas SUBTOTAL
2025-11-17 17:24:35,929 - INFO - Fila de totales: Formato aplicado automáticamente por la tabla
2025-11-17 17:24:35,929 - INFO - 
6.0. Re-aplicando formato sin paréntesis a columna 18...
2025-11-17 17:24:35,930 - INFO - Formato re-aplicado a columna 18 (Diferencia validación vigente) desde fila 7 hasta 215
2025-11-17 17:24:35,931 - INFO - 
6.1. Congelando paneles para mantener encabezados visibles...
2025-11-17 17:24:35,931 - INFO - Paneles congelados: Filas 1-6 siempre visibles
2025-11-17 17:24:35,931 - INFO - 
7. Guardando archivo: output_automatizado.xlsx
2025-11-17 17:24:36,061 - INFO - 
================================================================================
2025-11-17 17:24:36,061 - INFO - ARCHIVO GUARDADO EXITOSAMENTE
2025-11-17 17:24:36,061 - INFO - ================================================================================
2025-11-17 17:24:36,061 - INFO - 
Archivo: output_automatizado.xlsx
2025-11-17 17:24:36,061 - INFO - Filas de datos: 208
2025-11-17 17:24:36,061 - INFO - Columnas: 36
2025-11-17 17:24:36,062 - INFO - Formato: Idéntico al machote
2025-11-17 17:24:36,062 - INFO - Tabla Excel: Con totales automáticos y filtros
2025-11-17 17:24:36,062 - INFO - Encabezados: Siempre visibles (paneles congelados)
2025-11-17 17:24:36,062 - INFO - ================================================================================
2025-11-17 17:24:36,062 - INFO - OK - Archivo guardado con formato: output_automatizado.xlsx
2025-11-17 17:24:36,062 - INFO - 
--- PASO 4: GENERACIÓN DE HOJA MORA ---
2025-11-17 17:24:36,062 - INFO - 
Iniciando generación de hoja MORA...
2025-11-17 17:24:36,064 - INFO - Registros con %mora > 5%: 7 de 208
2025-11-17 17:24:36,066 - INFO - Hoja MORA generada con 7 registros y 14 columnas
2025-11-17 17:24:36,067 - INFO - 
================================================================================
2025-11-17 17:24:36,067 - INFO - AGREGANDO HOJA MORA
2025-11-17 17:24:36,067 - INFO - ================================================================================
2025-11-17 17:24:36,067 - INFO - 
1. Abriendo archivo: output_automatizado.xlsx
2025-11-17 17:24:36,245 - INFO - 
2. Creando hoja 'Mora'
2025-11-17 17:24:36,245 - INFO - 
3. Copiando formato de headers desde plantilla
2025-11-17 17:24:36,267 - INFO - 
4. Estableciendo headers de MORA
2025-11-17 17:24:36,267 - INFO - 
5. Pegando 7 filas de datos
2025-11-17 17:24:36,269 - INFO - 
6. Creando tabla Excel con totales
2025-11-17 17:24:36,269 - INFO -    Creando tabla: A6:N14
2025-11-17 17:24:36,270 - INFO -    Tabla 'TablaMora' creada con totales automáticos
2025-11-17 17:24:36,270 - INFO -    Filtros automáticos habilitados en rango: A6:N6
2025-11-17 17:24:36,270 - INFO -    Fórmulas SUBTOTAL escritas en 6 columnas
2025-11-17 17:24:36,270 - INFO - 
6.1. Congelando paneles para mantener encabezados visibles...
2025-11-17 17:24:36,270 - INFO - Paneles congelados: Filas 1-6 siempre visibles
2025-11-17 17:24:36,270 - INFO - 
7. Guardando archivo con hoja MORA
2025-11-17 17:24:36,415 - INFO - 
================================================================================
2025-11-17 17:24:36,415 - INFO - HOJA MORA AGREGADA EXITOSAMENTE
2025-11-17 17:24:36,415 - INFO - ================================================================================
2025-11-17 17:24:36,415 - INFO - 
Registros en MORA: 7
2025-11-17 17:24:36,415 - INFO - Filtro: %mora > 5%
2025-11-17 17:24:36,415 - INFO - Columnas amarillas: %mora, Días de mora
2025-11-17 17:24:36,415 - INFO - Tabla Excel: Con totales automáticos y filtros
2025-11-17 17:24:36,415 - INFO - Encabezados: Siempre visibles (paneles congelados)
2025-11-17 17:24:36,415 - INFO - ================================================================================
2025-11-17 17:24:36,415 - INFO - OK - Hoja MORA agregada con 7 registros
2025-11-17 17:24:36,416 - INFO - 
--- PASO 5: VALIDACIÓN ---
2025-11-17 17:24:36,416 - INFO - Machote no encontrado - validación omitida (no es necesario)
2025-11-17 17:24:36,416 - INFO - 
================================================================================
2025-11-17 17:24:36,416 - INFO - AUTOMATIZACIÓN COMPLETADA EXITOSAMENTE
2025-11-17 17:24:36,417 - INFO - ================================================================================
2025-11-17 17:27:10,515 - INFO - ================================================================================
2025-11-17 17:27:10,515 - INFO - INICIO DE AUTOMATIZACIÓN DE CARTERA
2025-11-17 17:27:10,515 - INFO - ================================================================================
2025-11-17 17:27:10,515 - INFO - 
--- PASO 0: BÚSQUEDA DE ARCHIVOS ---
2025-11-17 17:27:10,516 - INFO - Archivo encontrado: data\ReportedeAntiguedaddeCarteraGrupal_12112025.xlsx
2025-11-17 17:27:10,517 - INFO - Archivo encontrado: data\Situación_de_cartera_12112025.xlsx
2025-11-17 17:27:10,517 - INFO - Archivo encontrado: data\Cobranza_12112025.xlsx
2025-11-17 17:27:10,518 - INFO - Archivo encontrado: data/AHORROS.xlsx
2025-11-17 17:27:10,518 - INFO - 
--- PASO 1: CARGA DE ARCHIVOS ---
2025-11-17 17:27:10,518 - INFO - Cargando ANTIGÜEDAD desde: data\ReportedeAntiguedaddeCarteraGrupal_12112025.xlsx
2025-11-17 17:27:10,545 - INFO - Hoja detectada: '121125'
2025-11-17 17:27:10,701 - INFO - ANTIGÜEDAD cargado: (206, 59)
2025-11-17 17:27:10,701 - INFO - Columnas: ['cod_region', 'coordinacion', 'nombre_de_gerente', 'codigo_promotor', 'nombre_promotor', 'codigo_recuperador', 'nombre_recuperador', 'cod_grupo_solidario', 'ciclo', 'grupo_solidario']...
2025-11-17 17:27:10,702 - INFO - No se encontraron IDs duplicados
2025-11-17 17:27:10,702 - INFO - Cargando SITUACIÓN DE CARTERA desde: data\Situación_de_cartera_12112025.xlsx
2025-11-17 17:27:10,829 - INFO - SITUACIÓN DE CARTERA cargada: (206, 43)
2025-11-17 17:27:10,829 - INFO - Columnas: ['codigo_ofic_cred', 'nombre_oficial_de_credito', 'codigo_promotor_cred', 'nombre_promotor_cred', 'codigo_coord', 'nombre_coordinacion', 'codigo_ger_regi', 'nombre_gerencia_regional', 'nombre_codigo', 'nombre_acreditado_cliente']...
2025-11-17 17:27:10,830 - INFO - Columna de código renombrada: nombre_codigo -> codigo
2025-11-17 17:27:10,832 - INFO - Cargando REPORTE DE COBRANZA desde: data\Cobranza_12112025.xlsx
2025-11-17 17:27:11,032 - INFO - REPORTE DE COBRANZA cargado: (207, 68)
2025-11-17 17:27:11,032 - INFO - Columnas: ['regional', 'regional1', 'coordinacion', 'coordinacion1', 'de_credito', 'de_credito1', 'gpo', 'cliente_grupo', 'unnamed:_8', 'del_cliente']...
2025-11-17 17:27:11,033 - INFO - Cargando AHORROS (ACUMULADO) desde: data/AHORROS.xlsx
2025-11-17 17:27:11,073 - INFO - AHORROS cargado: (208, 4)
2025-11-17 17:27:11,074 - INFO - Columnas: ['id', 'grupo', 'ciclo', 'ahorro_acumulado']
2025-11-17 17:27:11,074 - INFO - PARCHE PROMOTORES cargado: 1 correcciones
2025-11-17 17:27:11,074 - INFO - 
--- PASO 2: GENERACIÓN DE CARTERA ---
2025-11-17 17:27:11,074 - INFO - Iniciando generación de cartera (VERSIÓN CORREGIDA)...
2025-11-17 17:27:11,074 - INFO - Registros en antiguedad: 206
2025-11-17 17:27:11,076 - INFO - ID de grupo generados: 0    000089
1    000145
2    000069
3    000079
4    000104
Name: id_de_grupo, dtype: object
2025-11-17 17:27:11,092 - INFO - Después de joins: 208 registros
2025-11-17 17:27:11,092 - INFO - NaN en situacion: 2
2025-11-17 17:27:11,093 - INFO - NaN en cobranza: 1
2025-11-17 17:27:11,093 - INFO - NaN en ahorros: 3
2025-11-17 17:27:11,095 - INFO - Parche aplicado: 1 correcciones
2025-11-17 17:27:11,101 - INFO - Estatus calculados: {'Vigente': 208}
2025-11-17 17:27:11,102 - INFO - Cartera vigente sistema calculada como: saldo_total (de ANTIGÜEDAD)
2025-11-17 17:27:11,118 - INFO - Cartera generada exitosamente: 208 filas x 36 columnas
2025-11-17 17:27:11,118 - INFO - 
--- PASO 3: GUARDADO DE RESULTADO CON FORMATO ---
2025-11-17 17:27:11,118 - INFO - ================================================================================
2025-11-17 17:27:11,119 - INFO - GUARDANDO DATAFRAME CON FORMATO
2025-11-17 17:27:11,119 - INFO - ================================================================================
2025-11-17 17:27:11,119 - INFO - 
1. Cargando plantilla de headers: plantilla/CARTERA_HEADERS.xlsx
2025-11-17 17:27:11,129 - INFO - Plantilla cargada: 6 filas x 36 columnas (6.1 KB)
2025-11-17 17:27:11,129 - INFO - 
2. Creando nuevo workbook...
2025-11-17 17:27:11,130 - INFO - 
3. Copiando headers desde plantilla...
2025-11-17 17:27:11,131 - INFO - Copiando headers (filas 1-6) con formato...
2025-11-17 17:27:11,175 - INFO - Headers copiados: 36 columnas
2025-11-17 17:27:11,175 - INFO - 
4. Pegando datos del DataFrame...
2025-11-17 17:27:11,175 - INFO - Pegando DataFrame (208 filas x 36 columnas) desde fila 7...
2025-11-17 17:27:11,216 - INFO - Datos pegados hasta fila 214
2025-11-17 17:27:11,217 - INFO - 
5. Aplicando formatos de columnas...
2025-11-17 17:27:11,217 - INFO - Aplicando formatos de columnas desde fila 7 hasta 214...
2025-11-17 17:27:11,228 - INFO - Formatos aplicados a 208 filas
2025-11-17 17:27:11,228 - INFO - 
6. Creando tabla de Excel con totales...
2025-11-17 17:27:11,228 - INFO - Creando tabla Excel 'TablaCartera' desde fila 6 hasta 214...
2025-11-17 17:27:11,228 - INFO - Rango de tabla: A6:AJ215
2025-11-17 17:27:11,228 - INFO - Fila de totales: 215
2025-11-17 17:27:11,228 - INFO - Nombres de columnas extraídos: 36
2025-11-17 17:27:11,228 - INFO -   Columna 6 'Monto del crédito': SUM
2025-11-17 17:27:11,228 - INFO -   Columna 13 'Pago Semanal': SUM
2025-11-17 17:27:11,229 - INFO -   Columna 15 'Cartera vigente sistema': SUM
2025-11-17 17:27:11,229 - INFO -   Columna 16 'Carera vigente inicial': SUM
2025-11-17 17:27:11,229 - INFO -   Columna 17 'Cartera vigente calculada': SUM
2025-11-17 17:27:11,229 - INFO -   Columna 18 'Cartera Insoluta': SUM
2025-11-17 17:27:11,229 - INFO -   Columna 19 'Diferencia Validación vigente': SUM
2025-11-17 17:27:11,229 - INFO -   Columna 20 'Ahorro Consumido': SUM
2025-11-17 17:27:11,229 - INFO -   Columna 21 'Cartera Vencida Estadistica': SUM
2025-11-17 17:27:11,229 - INFO -   Columna 22 'Cartera vencida Total': SUM
2025-11-17 17:27:11,229 - INFO -   Columna 24 'Saldo en riesgo': SUM
2025-11-17 17:27:11,229 - INFO -   Columna 25 'Saldo 
ahorro 
acumulado': SUM
2025-11-17 17:27:11,229 - INFO -   Columna 26 'Monto promedio del grupo': SUM
2025-11-17 17:27:11,229 - INFO -   Columna 33 'Ahorro Acumulado': SUM
2025-11-17 17:27:11,230 - INFO - Filtros automáticos habilitados en rango: A6:AJ6
2025-11-17 17:27:11,230 - INFO - Escribiendo fórmulas en fila de totales...
2025-11-17 17:27:11,230 - INFO -   Fórmula en columna 6: =SUBTOTAL(109,F7:F214)
2025-11-17 17:27:11,230 - INFO -   Fórmula en columna 13: =SUBTOTAL(109,M7:M214)
2025-11-17 17:27:11,230 - INFO -   Fórmula en columna 15: =SUBTOTAL(109,O7:O214)
2025-11-17 17:27:11,230 - INFO -   Fórmula en columna 16: =SUBTOTAL(109,P7:P214)
2025-11-17 17:27:11,230 - INFO -   Fórmula en columna 17: =SUBTOTAL(109,Q7:Q214)
2025-11-17 17:27:11,230 - INFO -   Fórmula en columna 18: =SUBTOTAL(109,R7:R214)
2025-11-17 17:27:11,230 - INFO -   Fórmula en columna 19: =SUBTOTAL(109,S7:S214)
2025-11-17 17:27:11,230 - INFO -   Fórmula en columna 20: =SUBTOTAL(109,T7:T214)
2025-11-17 17:27:11,230 - INFO -   Fórmula en columna 21: =SUBTOTAL(109,U7:U214)
2025-11-17 17:27:11,230 - INFO -   Fórmula en columna 22: =SUBTOTAL(109,V7:V214)
2025-11-17 17:27:11,230 - INFO -   Fórmula en columna 24: =SUBTOTAL(109,X7:X214)
2025-11-17 17:27:11,231 - INFO -   Fórmula en columna 25: =SUBTOTAL(109,Y7:Y214)
2025-11-17 17:27:11,231 - INFO -   Fórmula en columna 26: =SUBTOTAL(109,Z7:Z214)
2025-11-17 17:27:11,231 - INFO -   Fórmula en columna 33: =SUBTOTAL(109,AG7:AG214)
2025-11-17 17:27:11,231 - INFO - Tabla creada exitosamente con 208 filas de datos + fila totales
2025-11-17 17:27:11,231 - INFO - Totales configurados en 14 columnas con fórmulas SUBTOTAL
2025-11-17 17:27:11,231 - INFO - Fila de totales: Formato aplicado automáticamente por la tabla
2025-11-17 17:27:11,231 - INFO - 
6.0. Re-aplicando formato sin paréntesis a columna 18...
2025-11-17 17:27:11,231 - INFO - Formato re-aplicado a columna 18 (Diferencia validación vigente) desde fila 7 hasta 215
2025-11-17 17:27:11,231 - INFO - 
6.1. Congelando paneles para mantener encabezados visibles...
2025-11-17 17:27:11,232 - INFO - Paneles congelados: Filas 1-6 siempre visibles
2025-11-17 17:27:11,232 - INFO - 
7. Guardando archivo: output_automatizado.xlsx
2025-11-17 17:27:11,375 - INFO - 
================================================================================
2025-11-17 17:27:11,375 - INFO - ARCHIVO GUARDADO EXITOSAMENTE
2025-11-17 17:27:11,375 - INFO - ================================================================================
2025-11-17 17:27:11,375 - INFO - 
Archivo: output_automatizado.xlsx
2025-11-17 17:27:11,375 - INFO - Filas de datos: 208
2025-11-17 17:27:11,375 - INFO - Columnas: 36
2025-11-17 17:27:11,375 - INFO - Formato: Idéntico al machote
2025-11-17 17:27:11,375 - INFO - Tabla Excel: Con totales automáticos y filtros
2025-11-17 17:27:11,375 - INFO - Encabezados: Siempre visibles (paneles congelados)
2025-11-17 17:27:11,375 - INFO - ================================================================================
2025-11-17 17:27:11,375 - INFO - OK - Archivo guardado con formato: output_automatizado.xlsx
2025-11-17 17:27:11,376 - INFO - 
--- PASO 4: GENERACIÓN DE HOJA MORA ---
2025-11-17 17:27:11,376 - INFO - 
Iniciando generación de hoja MORA...
2025-11-17 17:27:11,377 - INFO - Registros con %mora > 5%: 7 de 208
2025-11-17 17:27:11,379 - INFO - Hoja MORA generada con 7 registros y 14 columnas
2025-11-17 17:27:11,379 - INFO - 
================================================================================
2025-11-17 17:27:11,379 - INFO - AGREGANDO HOJA MORA
2025-11-17 17:27:11,380 - INFO - ================================================================================
2025-11-17 17:27:11,380 - INFO - 
1. Abriendo archivo: output_automatizado.xlsx
2025-11-17 17:27:11,570 - INFO - 
2. Creando hoja 'Mora'
2025-11-17 17:27:11,571 - INFO - 
3. Copiando formato de headers desde plantilla
2025-11-17 17:27:11,593 - INFO - 
4. Estableciendo headers de MORA
2025-11-17 17:27:11,594 - INFO - 
5. Pegando 7 filas de datos
2025-11-17 17:27:11,597 - INFO - 
6. Creando tabla Excel con totales
2025-11-17 17:27:11,597 - INFO -    Creando tabla: A6:N14
2025-11-17 17:27:11,597 - INFO -    Tabla 'TablaMora' creada con totales automáticos
2025-11-17 17:27:11,597 - INFO -    Filtros automáticos habilitados en rango: A6:N6
2025-11-17 17:27:11,597 - INFO -    Fórmulas SUBTOTAL escritas en 6 columnas
2025-11-17 17:27:11,597 - INFO - 
6.1. Congelando paneles para mantener encabezados visibles...
2025-11-17 17:27:11,597 - INFO - Paneles congelados: Filas 1-6 siempre visibles
2025-11-17 17:27:11,598 - INFO - 
7. Guardando archivo con hoja MORA
2025-11-17 17:27:11,752 - INFO - 
================================================================================
2025-11-17 17:27:11,752 - INFO - HOJA MORA AGREGADA EXITOSAMENTE
2025-11-17 17:27:11,752 - INFO - ================================================================================
2025-11-17 17:27:11,752 - INFO - 
Registros en MORA: 7
2025-11-17 17:27:11,752 - INFO - Filtro: %mora > 5%
2025-11-17 17:27:11,752 - INFO - Columnas amarillas: %mora, Días de mora
2025-11-17 17:27:11,752 - INFO - Tabla Excel: Con totales automáticos y filtros
2025-11-17 17:27:11,752 - INFO - Encabezados: Siempre visibles (paneles congelados)
2025-11-17 17:27:11,752 - INFO - ================================================================================
2025-11-17 17:27:11,752 - INFO - OK - Hoja MORA agregada con 7 registros
2025-11-17 17:27:11,752 - INFO - 
--- PASO 5: VALIDACIÓN ---
2025-11-17 17:27:11,753 - INFO - Machote no encontrado - validación omitida (no es necesario)
2025-11-17 17:27:11,753 - INFO - 
================================================================================
2025-11-17 17:27:11,753 - INFO - AUTOMATIZACIÓN COMPLETADA EXITOSAMENTE
2025-11-17 17:27:11,753 - INFO - ================================================================================
2025-11-17 18:02:50,832 - INFO - ================================================================================
2025-11-17 18:02:50,833 - INFO - INICIO DE AUTOMATIZACIÓN DE CARTERA
2025-11-17 18:02:50,834 - INFO - ================================================================================
2025-11-17 18:02:50,834 - INFO - 
--- PASO 0: BÚSQUEDA DE ARCHIVOS ---
2025-11-17 18:02:50,840 - INFO - Archivo encontrado: data\ReportedeAntiguedaddeCarteraGrupal_12112025.xlsx
2025-11-17 18:02:50,842 - INFO - Archivo encontrado: data\Situación_de_cartera_12112025.xlsx
2025-11-17 18:02:50,844 - INFO - Archivo encontrado: data\Cobranza_12112025.xlsx
2025-11-17 18:02:50,845 - INFO - Archivo encontrado: data/AHORROS.xlsx
2025-11-17 18:02:50,846 - INFO - 
--- PASO 1: CARGA DE ARCHIVOS ---
2025-11-17 18:02:50,846 - INFO - Cargando ANTIGÜEDAD desde: data\ReportedeAntiguedaddeCarteraGrupal_12112025.xlsx
2025-11-17 18:02:50,981 - INFO - Hoja detectada: '121125'
2025-11-17 18:02:51,856 - INFO - ANTIGÜEDAD cargado: (206, 59)
2025-11-17 18:02:51,858 - INFO - Columnas: ['cod_region', 'coordinacion', 'nombre_de_gerente', 'codigo_promotor', 'nombre_promotor', 'codigo_recuperador', 'nombre_recuperador', 'cod_grupo_solidario', 'ciclo', 'grupo_solidario']...
2025-11-17 18:02:51,868 - INFO - No se encontraron IDs duplicados
2025-11-17 18:02:51,873 - INFO - Cargando SITUACIÓN DE CARTERA desde: data\Situación_de_cartera_12112025.xlsx
2025-11-17 18:02:52,531 - INFO - SITUACIÓN DE CARTERA cargada: (206, 43)
2025-11-17 18:02:52,532 - INFO - Columnas: ['codigo_ofic_cred', 'nombre_oficial_de_credito', 'codigo_promotor_cred', 'nombre_promotor_cred', 'codigo_coord', 'nombre_coordinacion', 'codigo_ger_regi', 'nombre_gerencia_regional', 'nombre_codigo', 'nombre_acreditado_cliente']...
2025-11-17 18:02:52,538 - INFO - Columna de código renombrada: nombre_codigo -> codigo
2025-11-17 18:02:52,547 - INFO - Cargando REPORTE DE COBRANZA desde: data\Cobranza_12112025.xlsx
2025-11-17 18:02:53,518 - INFO - REPORTE DE COBRANZA cargado: (207, 68)
2025-11-17 18:02:53,518 - INFO - Columnas: ['regional', 'regional1', 'coordinacion', 'coordinacion1', 'de_credito', 'de_credito1', 'gpo', 'cliente_grupo', 'unnamed:_8', 'del_cliente']...
2025-11-17 18:02:53,524 - INFO - Cargando AHORROS (ACUMULADO) desde: data/AHORROS.xlsx
2025-11-17 18:02:53,734 - INFO - AHORROS cargado: (208, 4)
2025-11-17 18:02:53,735 - INFO - Columnas: ['id', 'grupo', 'ciclo', 'ahorro_acumulado']
2025-11-17 18:02:53,742 - INFO - PARCHE PROMOTORES cargado: 1 correcciones
2025-11-17 18:02:53,743 - INFO - 
--- PASO 2: GENERACIÓN DE CARTERA ---
2025-11-17 18:02:53,744 - INFO - Iniciando generación de cartera (VERSIÓN CORREGIDA)...
2025-11-17 18:02:53,748 - INFO - Registros en antiguedad: 206
2025-11-17 18:02:53,762 - INFO - ID de grupo generados: 0    000089
1    000145
2    000069
3    000079
4    000104
Name: id_de_grupo, dtype: object
2025-11-17 18:02:53,892 - INFO - Después de joins: 208 registros
2025-11-17 18:02:53,894 - INFO - NaN en situacion: 2
2025-11-17 18:02:53,895 - INFO - NaN en cobranza: 1
2025-11-17 18:02:53,896 - INFO - NaN en ahorros: 3
2025-11-17 18:02:53,905 - INFO - Parche aplicado: 1 correcciones
2025-11-17 18:02:53,947 - INFO - Estatus calculados: {'Vigente': 208}
2025-11-17 18:02:53,950 - INFO - Cartera vigente sistema calculada como: saldo_total (de ANTIGÜEDAD)
2025-11-17 18:02:54,034 - INFO - Cartera generada exitosamente: 208 filas x 36 columnas
2025-11-17 18:02:54,035 - INFO - 
--- PASO 3: GUARDADO DE RESULTADO CON FORMATO ---
2025-11-17 18:02:54,040 - INFO - ================================================================================
2025-11-17 18:02:54,040 - INFO - GUARDANDO DATAFRAME CON FORMATO
2025-11-17 18:02:54,041 - INFO - ================================================================================
2025-11-17 18:02:54,042 - INFO - 
1. Cargando plantilla de headers: plantilla/CARTERA_HEADERS.xlsx
2025-11-17 18:02:54,091 - INFO - Plantilla cargada: 6 filas x 36 columnas (6.1 KB)
2025-11-17 18:02:54,092 - INFO - 
2. Creando nuevo workbook...
2025-11-17 18:02:54,107 - INFO - 
3. Copiando headers desde plantilla...
2025-11-17 18:02:54,108 - INFO - Copiando headers (filas 1-6) con formato...
2025-11-17 18:02:54,395 - INFO - Headers copiados: 36 columnas
2025-11-17 18:02:54,395 - INFO - 
3.1. Ajustando anchos de columnas específicas...
2025-11-17 18:02:54,396 - INFO - Anchos ajustados: Q=20, R=20, S=20, T=20
2025-11-17 18:02:54,396 - INFO - 
4. Pegando datos del DataFrame...
2025-11-17 18:02:54,397 - INFO - Pegando DataFrame (208 filas x 36 columnas) desde fila 7...
2025-11-17 18:02:54,714 - INFO - Datos pegados hasta fila 214
2025-11-17 18:02:54,715 - INFO - 
5. Aplicando formatos de columnas...
2025-11-17 18:02:54,715 - INFO - Aplicando formatos de columnas desde fila 7 hasta 214...
2025-11-17 18:02:54,766 - INFO - Formatos aplicados a 208 filas
2025-11-17 18:02:54,766 - INFO - 
6. Creando tabla de Excel con totales...
2025-11-17 18:02:54,767 - INFO - Creando tabla Excel 'TablaCartera' desde fila 6 hasta 214...
2025-11-17 18:02:54,767 - INFO - Rango de tabla: A6:AJ215
2025-11-17 18:02:54,768 - INFO - Fila de totales: 215
2025-11-17 18:02:54,772 - INFO - Nombres de columnas extraídos: 36
2025-11-17 18:02:54,773 - INFO -   Columna 6 'Monto del crédito': SUM
2025-11-17 18:02:54,773 - INFO -   Columna 13 'Pago Semanal': SUM
2025-11-17 18:02:54,774 - INFO -   Columna 15 'Cartera vigente sistema': SUM
2025-11-17 18:02:54,775 - INFO -   Columna 16 'Carera vigente inicial': SUM
2025-11-17 18:02:54,775 - INFO -   Columna 17 'Cartera vigente calculada': SUM
2025-11-17 18:02:54,775 - INFO -   Columna 18 'Cartera Insoluta': SUM
2025-11-17 18:02:54,776 - INFO -   Columna 19 'Diferencia Validación vigente': SUM
2025-11-17 18:02:54,776 - INFO -   Columna 20 'Ahorro Consumido': SUM
2025-11-17 18:02:54,777 - INFO -   Columna 21 'Cartera Vencida Estadistica': SUM
2025-11-17 18:02:54,777 - INFO -   Columna 22 'Cartera vencida Total': SUM
2025-11-17 18:02:54,777 - INFO -   Columna 24 'Saldo en riesgo': SUM
2025-11-17 18:02:54,778 - INFO -   Columna 25 'Saldo 
ahorro 
acumulado': SUM
2025-11-17 18:02:54,778 - INFO -   Columna 26 'Monto promedio del grupo': SUM
2025-11-17 18:02:54,779 - INFO -   Columna 33 'Ahorro Acumulado': SUM
2025-11-17 18:02:54,779 - INFO - Filtros automáticos habilitados en rango: A6:AJ6
2025-11-17 18:02:54,780 - INFO - Escribiendo fórmulas en fila de totales...
2025-11-17 18:02:54,780 - INFO -   Fórmula en columna 6: =SUBTOTAL(109,F7:F214)
2025-11-17 18:02:54,781 - INFO -   Fórmula en columna 13: =SUBTOTAL(109,M7:M214)
2025-11-17 18:02:54,781 - INFO -   Fórmula en columna 15: =SUBTOTAL(109,O7:O214)
2025-11-17 18:02:54,782 - INFO -   Fórmula en columna 16: =SUBTOTAL(109,P7:P214)
2025-11-17 18:02:54,782 - INFO -   Fórmula en columna 17: =SUBTOTAL(109,Q7:Q214)
2025-11-17 18:02:54,782 - INFO -   Fórmula en columna 18: =SUBTOTAL(109,R7:R214)
2025-11-17 18:02:54,783 - INFO -   Fórmula en columna 19: =SUBTOTAL(109,S7:S214)
2025-11-17 18:02:54,783 - INFO -   Fórmula en columna 20: =SUBTOTAL(109,T7:T214)
2025-11-17 18:02:54,783 - INFO -   Fórmula en columna 21: =SUBTOTAL(109,U7:U214)
2025-11-17 18:02:54,784 - INFO -   Fórmula en columna 22: =SUBTOTAL(109,V7:V214)
2025-11-17 18:02:54,784 - INFO -   Fórmula en columna 24: =SUBTOTAL(109,X7:X214)
2025-11-17 18:02:54,785 - INFO -   Fórmula en columna 25: =SUBTOTAL(109,Y7:Y214)
2025-11-17 18:02:54,788 - INFO -   Fórmula en columna 26: =SUBTOTAL(109,Z7:Z214)
2025-11-17 18:02:54,789 - INFO -   Fórmula en columna 33: =SUBTOTAL(109,AG7:AG214)
2025-11-17 18:02:54,790 - INFO - Tabla creada exitosamente con 208 filas de datos + fila totales
2025-11-17 18:02:54,790 - INFO - Totales configurados en 14 columnas con fórmulas SUBTOTAL
2025-11-17 18:02:54,791 - INFO - Fila de totales: Formato aplicado automáticamente por la tabla
2025-11-17 18:02:54,791 - INFO - 
6.0. Re-aplicando formato sin paréntesis a columna 18...
2025-11-17 18:02:54,793 - INFO - Formato re-aplicado a columna 18 (Diferencia validación vigente) desde fila 7 hasta 215
2025-11-17 18:02:54,793 - INFO - 
6.1. Congelando paneles para mantener encabezados visibles...
2025-11-17 18:02:54,793 - INFO - Paneles congelados: Filas 1-6 siempre visibles
2025-11-17 18:02:54,794 - INFO - 
7. Guardando archivo: output_automatizado.xlsx
2025-11-17 18:02:56,194 - INFO - 
================================================================================
2025-11-17 18:02:56,195 - INFO - ARCHIVO GUARDADO EXITOSAMENTE
2025-11-17 18:02:56,195 - INFO - ================================================================================
2025-11-17 18:02:56,196 - INFO - 
Archivo: output_automatizado.xlsx
2025-11-17 18:02:56,196 - INFO - Filas de datos: 208
2025-11-17 18:02:56,197 - INFO - Columnas: 36
2025-11-17 18:02:56,197 - INFO - Formato: Idéntico al machote
2025-11-17 18:02:56,198 - INFO - Tabla Excel: Con totales automáticos y filtros
2025-11-17 18:02:56,198 - INFO - Encabezados: Siempre visibles (paneles congelados)
2025-11-17 18:02:56,199 - INFO - ================================================================================
2025-11-17 18:02:56,200 - INFO - OK - Archivo guardado con formato: output_automatizado.xlsx
2025-11-17 18:02:56,200 - INFO - 
--- PASO 4: GENERACIÓN DE HOJA MORA ---
2025-11-17 18:02:56,201 - INFO - 
Iniciando generación de hoja MORA...
2025-11-17 18:02:56,209 - INFO - Registros con %mora > 5%: 7 de 208
2025-11-17 18:02:56,216 - INFO - Hoja MORA generada con 7 registros y 14 columnas
2025-11-17 18:02:56,216 - INFO - 
================================================================================
2025-11-17 18:02:56,217 - INFO - AGREGANDO HOJA MORA
2025-11-17 18:02:56,218 - INFO - ================================================================================
2025-11-17 18:02:56,222 - INFO - 
1. Abriendo archivo: output_automatizado.xlsx
2025-11-17 18:02:57,127 - INFO - 
2. Creando hoja 'Mora'
2025-11-17 18:02:57,130 - INFO - 
3. Copiando formato de headers desde plantilla
2025-11-17 18:02:57,249 - INFO - 
4. Estableciendo headers de MORA
2025-11-17 18:02:57,249 - INFO - 
5. Pegando 7 filas de datos
2025-11-17 18:02:57,264 - INFO - 
6. Creando tabla Excel con totales
2025-11-17 18:02:57,264 - INFO -    Creando tabla: A6:N14
2025-11-17 18:02:57,265 - INFO -    Tabla 'TablaMora' creada con totales automáticos
2025-11-17 18:02:57,266 - INFO -    Filtros automáticos habilitados en rango: A6:N6
2025-11-17 18:02:57,266 - INFO -    Fórmulas SUBTOTAL escritas en 6 columnas
2025-11-17 18:02:57,267 - INFO - 
6.1. Congelando paneles para mantener encabezados visibles...
2025-11-17 18:02:57,267 - INFO - Paneles congelados: Filas 1-6 siempre visibles
2025-11-17 18:02:57,268 - INFO - 
7. Guardando archivo con hoja MORA
2025-11-17 18:03:00,241 - INFO - 
================================================================================
2025-11-17 18:03:00,243 - INFO - HOJA MORA AGREGADA EXITOSAMENTE
2025-11-17 18:03:00,243 - INFO - ================================================================================
2025-11-17 18:03:00,244 - INFO - 
Registros en MORA: 7
2025-11-17 18:03:00,258 - INFO - Filtro: %mora > 5%
2025-11-17 18:03:00,272 - INFO - Columnas amarillas: %mora, Días de mora
2025-11-17 18:03:00,272 - INFO - Tabla Excel: Con totales automáticos y filtros
2025-11-17 18:03:00,284 - INFO - Encabezados: Siempre visibles (paneles congelados)
2025-11-17 18:03:00,288 - INFO - ================================================================================
2025-11-17 18:03:00,289 - INFO - OK - Hoja MORA agregada con 7 registros
2025-11-17 18:03:00,297 - INFO - 
--- PASO 5: VALIDACIÓN ---
2025-11-17 18:03:00,299 - INFO - Machote no encontrado - validación omitida (no es necesario)
2025-11-17 18:03:00,311 - INFO - 
================================================================================
2025-11-17 18:03:00,312 - INFO - AUTOMATIZACIÓN COMPLETADA EXITOSAMENTE
2025-11-17 18:03:00,312 - INFO - ================================================================================
2025-11-17 18:27:56,493 - INFO - ================================================================================
2025-11-17 18:27:56,494 - INFO - INICIO DE AUTOMATIZACIÓN DE CARTERA
2025-11-17 18:27:56,494 - INFO - ================================================================================
2025-11-17 18:27:56,494 - INFO - 
--- PASO 0: BÚSQUEDA DE ARCHIVOS ---
2025-11-17 18:27:56,495 - INFO - Archivo encontrado: data\ReportedeAntiguedaddeCarteraGrupal_12112025.xlsx
2025-11-17 18:27:56,496 - INFO - Archivo encontrado: data\Situación_de_cartera_12112025.xlsx
2025-11-17 18:27:56,496 - INFO - Archivo encontrado: data\Cobranza_12112025.xlsx
2025-11-17 18:27:56,497 - INFO - Archivo encontrado: data/AHORROS.xlsx
2025-11-17 18:27:56,497 - INFO - 
--- PASO 1: CARGA DE ARCHIVOS ---
2025-11-17 18:27:56,497 - INFO - Cargando ANTIGÜEDAD desde: data\ReportedeAntiguedaddeCarteraGrupal_12112025.xlsx
2025-11-17 18:27:56,522 - INFO - Hoja detectada: '121125'
2025-11-17 18:27:56,693 - INFO - ANTIGÜEDAD cargado: (206, 59)
2025-11-17 18:27:56,693 - INFO - Columnas: ['cod_region', 'coordinacion', 'nombre_de_gerente', 'codigo_promotor', 'nombre_promotor', 'codigo_recuperador', 'nombre_recuperador', 'cod_grupo_solidario', 'ciclo', 'grupo_solidario']...
2025-11-17 18:27:56,696 - INFO - No se encontraron IDs duplicados
2025-11-17 18:27:56,697 - INFO - Cargando SITUACIÓN DE CARTERA desde: data\Situación_de_cartera_12112025.xlsx
2025-11-17 18:27:56,841 - INFO - SITUACIÓN DE CARTERA cargada: (206, 43)
2025-11-17 18:27:56,841 - INFO - Columnas: ['codigo_ofic_cred', 'nombre_oficial_de_credito', 'codigo_promotor_cred', 'nombre_promotor_cred', 'codigo_coord', 'nombre_coordinacion', 'codigo_ger_regi', 'nombre_gerencia_regional', 'nombre_codigo', 'nombre_acreditado_cliente']...
2025-11-17 18:27:56,843 - INFO - Columna de código renombrada: nombre_codigo -> codigo
2025-11-17 18:27:56,844 - INFO - Cargando REPORTE DE COBRANZA desde: data\Cobranza_12112025.xlsx
2025-11-17 18:27:57,033 - INFO - REPORTE DE COBRANZA cargado: (207, 68)
2025-11-17 18:27:57,034 - INFO - Columnas: ['regional', 'regional1', 'coordinacion', 'coordinacion1', 'de_credito', 'de_credito1', 'gpo', 'cliente_grupo', 'unnamed:_8', 'del_cliente']...
2025-11-17 18:27:57,034 - INFO - Cargando AHORROS (ACUMULADO) desde: data/AHORROS.xlsx
2025-11-17 18:27:57,072 - INFO - AHORROS cargado: (208, 4)
2025-11-17 18:27:57,072 - INFO - Columnas: ['id', 'grupo', 'ciclo', 'ahorro_acumulado']
2025-11-17 18:27:57,072 - INFO - PARCHE PROMOTORES cargado: 1 correcciones
2025-11-17 18:27:57,073 - INFO - 
--- PASO 2: GENERACIÓN DE CARTERA ---
2025-11-17 18:27:57,073 - INFO - Iniciando generación de cartera (VERSIÓN CORREGIDA)...
2025-11-17 18:27:57,073 - INFO - Registros en antiguedad: 206
2025-11-17 18:27:57,075 - INFO - ID de grupo generados: 0    000089
1    000145
2    000069
3    000079
4    000104
Name: id_de_grupo, dtype: object
2025-11-17 18:27:57,099 - INFO - Después de joins: 208 registros
2025-11-17 18:27:57,099 - INFO - NaN en situacion: 2
2025-11-17 18:27:57,100 - INFO - NaN en cobranza: 1
2025-11-17 18:27:57,100 - INFO - NaN en ahorros: 3
2025-11-17 18:27:57,102 - INFO - Parche aplicado: 1 correcciones
2025-11-17 18:27:57,111 - INFO - Estatus calculados: {'Vigente': 208}
2025-11-17 18:27:57,112 - INFO - Cartera vigente sistema calculada como: saldo_total (de ANTIGÜEDAD)
2025-11-17 18:27:57,130 - INFO - Cartera generada exitosamente: 208 filas x 36 columnas
2025-11-17 18:27:57,131 - INFO - 
--- PASO 3: GUARDADO DE RESULTADO CON FORMATO ---
2025-11-17 18:27:57,131 - INFO - ================================================================================
2025-11-17 18:27:57,131 - INFO - GUARDANDO DATAFRAME CON FORMATO
2025-11-17 18:27:57,131 - INFO - ================================================================================
2025-11-17 18:27:57,131 - INFO - 
1. Cargando plantilla de headers: plantilla/CARTERA_HEADERS.xlsx
2025-11-17 18:27:57,140 - INFO - Plantilla cargada: 6 filas x 36 columnas (6.1 KB)
2025-11-17 18:27:57,140 - INFO - 
2. Creando nuevo workbook...
2025-11-17 18:27:57,141 - INFO - 
3. Copiando headers desde plantilla...
2025-11-17 18:27:57,141 - INFO - Copiando headers (filas 1-6) con formato...
2025-11-17 18:27:57,184 - INFO - Headers copiados: 36 columnas
2025-11-17 18:27:57,184 - INFO - 
3.1. Ajustando anchos de columnas específicas...
2025-11-17 18:27:57,184 - INFO - Anchos ajustados: Q=20, R=20, S=20, T=20
2025-11-17 18:27:57,184 - INFO - 
4. Pegando datos del DataFrame...
2025-11-17 18:27:57,184 - INFO - Pegando DataFrame (208 filas x 36 columnas) desde fila 7...
2025-11-17 18:27:57,232 - INFO - Datos pegados hasta fila 214
2025-11-17 18:27:57,233 - INFO - 
5. Aplicando formatos de columnas...
2025-11-17 18:27:57,233 - INFO - Aplicando formatos de columnas desde fila 7 hasta 214...
2025-11-17 18:27:57,244 - INFO - Formatos aplicados a 208 filas
2025-11-17 18:27:57,244 - INFO - 
6. Creando tabla de Excel con totales...
2025-11-17 18:27:57,244 - INFO - Creando tabla Excel 'TablaCartera' desde fila 6 hasta 214...
2025-11-17 18:27:57,244 - INFO - Rango de tabla: A6:AJ215
2025-11-17 18:27:57,244 - INFO - Fila de totales: 215
2025-11-17 18:27:57,244 - INFO - Nombres de columnas extraídos: 36
2025-11-17 18:27:57,244 - INFO -   Columna 6 'Monto del crédito': SUM
2025-11-17 18:27:57,244 - INFO -   Columna 13 'Pago Semanal': SUM
2025-11-17 18:27:57,245 - INFO -   Columna 15 'Cartera vigente sistema': SUM
2025-11-17 18:27:57,245 - INFO -   Columna 16 'Carera vigente inicial': SUM
2025-11-17 18:27:57,245 - INFO -   Columna 17 'Cartera vigente calculada': SUM
2025-11-17 18:27:57,245 - INFO -   Columna 18 'Cartera Insoluta': SUM
2025-11-17 18:27:57,245 - INFO -   Columna 19 'Diferencia Validación vigente': SUM
2025-11-17 18:27:57,246 - INFO -   Columna 20 'Ahorro Consumido': SUM
2025-11-17 18:27:57,246 - INFO -   Columna 21 'Cartera Vencida Estadistica': SUM
2025-11-17 18:27:57,246 - INFO -   Columna 22 'Cartera vencida Total': SUM
2025-11-17 18:27:57,246 - INFO -   Columna 24 'Saldo en riesgo': SUM
2025-11-17 18:27:57,246 - INFO -   Columna 25 'Saldo 
ahorro 
acumulado': SUM
2025-11-17 18:27:57,247 - INFO -   Columna 26 'Monto promedio del grupo': SUM
2025-11-17 18:27:57,247 - INFO -   Columna 33 'Ahorro Acumulado': SUM
2025-11-17 18:27:57,247 - INFO - Filtros automáticos habilitados en rango: A6:AJ6
2025-11-17 18:27:57,247 - INFO - Escribiendo fórmulas en fila de totales...
2025-11-17 18:27:57,248 - INFO -   Fórmula en columna 6: =SUBTOTAL(9,F$7:F$214)
2025-11-17 18:27:57,248 - INFO -   Fórmula en columna 13: =SUBTOTAL(9,M$7:M$214)
2025-11-17 18:27:57,248 - INFO -   Fórmula en columna 15: =SUBTOTAL(9,O$7:O$214)
2025-11-17 18:27:57,248 - INFO -   Fórmula en columna 16: =SUBTOTAL(9,P$7:P$214)
2025-11-17 18:27:57,248 - INFO -   Fórmula en columna 17: =SUBTOTAL(9,Q$7:Q$214)
2025-11-17 18:27:57,249 - INFO -   Fórmula en columna 18: =SUBTOTAL(9,R$7:R$214)
2025-11-17 18:27:57,249 - INFO -   Fórmula en columna 19: =SUBTOTAL(9,S$7:S$214)
2025-11-17 18:27:57,249 - INFO -   Fórmula en columna 20: =SUBTOTAL(9,T$7:T$214)
2025-11-17 18:27:57,249 - INFO -   Fórmula en columna 21: =SUBTOTAL(9,U$7:U$214)
2025-11-17 18:27:57,249 - INFO -   Fórmula en columna 22: =SUBTOTAL(9,V$7:V$214)
2025-11-17 18:27:57,249 - INFO -   Fórmula en columna 24: =SUBTOTAL(9,X$7:X$214)
2025-11-17 18:27:57,249 - INFO -   Fórmula en columna 25: =SUBTOTAL(9,Y$7:Y$214)
2025-11-17 18:27:57,249 - INFO -   Fórmula en columna 26: =SUBTOTAL(9,Z$7:Z$214)
2025-11-17 18:27:57,250 - INFO -   Fórmula en columna 33: =SUBTOTAL(9,AG$7:AG$214)
2025-11-17 18:27:57,250 - INFO - Tabla creada exitosamente con 208 filas de datos + fila totales
2025-11-17 18:27:57,250 - INFO - Totales configurados en 14 columnas con fórmulas SUBTOTAL
2025-11-17 18:27:57,250 - INFO - Fila de totales: Formato aplicado automáticamente por la tabla
2025-11-17 18:27:57,250 - INFO - 
6.0. Re-aplicando formato sin paréntesis a columna 18...
2025-11-17 18:27:57,250 - INFO - Formato re-aplicado a columna 18 (Diferencia validación vigente) desde fila 7 hasta 215
2025-11-17 18:27:57,251 - INFO - 
6.1. Congelando paneles para mantener encabezados visibles...
2025-11-17 18:27:57,251 - INFO - Paneles congelados: Filas 1-6 siempre visibles
2025-11-17 18:27:57,251 - INFO - 
7. Guardando archivo: output_automatizado.xlsx
2025-11-17 18:27:57,252 - ERROR - 
ERROR: [Errno 13] Permission denied: 'output_automatizado.xlsx'
Traceback (most recent call last):
  File "C:\Users\uzzie\Documents\Jale\merge-dataframes\analizar_y_automatizar.py", line 314, in main
    guardar_con_formato(df_cartera, RUTA_PLANTILLA, RUTA_OUTPUT)
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\uzzie\Documents\Jale\merge-dataframes\formato_excel.py", line 411, in guardar_con_formato
    wb_nuevo.save(ruta_output)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Users\uzzie\miniconda3\Lib\site-packages\openpyxl\workbook\workbook.py", line 386, in save
    save_workbook(self, filename)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "C:\Users\uzzie\miniconda3\Lib\site-packages\openpyxl\writer\excel.py", line 291, in save_workbook
    archive = ZipFile(filename, 'w', ZIP_DEFLATED, allowZip64=True)
  File "C:\Users\uzzie\miniconda3\Lib\zipfile\__init__.py", line 1367, in __init__
    self.fp = io.open(file, filemode)
              ~~~~~~~^^^^^^^^^^^^^^^^
PermissionError: [Errno 13] Permission denied: 'output_automatizado.xlsx'
2025-11-17 18:29:36,470 - INFO - ================================================================================
2025-11-17 18:29:36,470 - INFO - INICIO DE AUTOMATIZACIÓN DE CARTERA
2025-11-17 18:29:36,471 - INFO - ================================================================================
2025-11-17 18:29:36,471 - INFO - 
--- PASO 0: BÚSQUEDA DE ARCHIVOS ---
2025-11-17 18:29:36,471 - INFO - Archivo encontrado: data\ReportedeAntiguedaddeCarteraGrupal_12112025.xlsx
2025-11-17 18:29:36,472 - INFO - Archivo encontrado: data\Situación_de_cartera_12112025.xlsx
2025-11-17 18:29:36,473 - INFO - Archivo encontrado: data\Cobranza_12112025.xlsx
2025-11-17 18:29:36,473 - INFO - Archivo encontrado: data/AHORROS.xlsx
2025-11-17 18:29:36,473 - INFO - 
--- PASO 1: CARGA DE ARCHIVOS ---
2025-11-17 18:29:36,473 - INFO - Cargando ANTIGÜEDAD desde: data\ReportedeAntiguedaddeCarteraGrupal_12112025.xlsx
2025-11-17 18:29:36,492 - INFO - Hoja detectada: '121125'
2025-11-17 18:29:36,647 - INFO - ANTIGÜEDAD cargado: (206, 59)
2025-11-17 18:29:36,648 - INFO - Columnas: ['cod_region', 'coordinacion', 'nombre_de_gerente', 'codigo_promotor', 'nombre_promotor', 'codigo_recuperador', 'nombre_recuperador', 'cod_grupo_solidario', 'ciclo', 'grupo_solidario']...
2025-11-17 18:29:36,648 - INFO - No se encontraron IDs duplicados
2025-11-17 18:29:36,648 - INFO - Cargando SITUACIÓN DE CARTERA desde: data\Situación_de_cartera_12112025.xlsx
2025-11-17 18:29:36,773 - INFO - SITUACIÓN DE CARTERA cargada: (206, 43)
2025-11-17 18:29:36,774 - INFO - Columnas: ['codigo_ofic_cred', 'nombre_oficial_de_credito', 'codigo_promotor_cred', 'nombre_promotor_cred', 'codigo_coord', 'nombre_coordinacion', 'codigo_ger_regi', 'nombre_gerencia_regional', 'nombre_codigo', 'nombre_acreditado_cliente']...
2025-11-17 18:29:36,774 - INFO - Columna de código renombrada: nombre_codigo -> codigo
2025-11-17 18:29:36,776 - INFO - Cargando REPORTE DE COBRANZA desde: data\Cobranza_12112025.xlsx
2025-11-17 18:29:36,978 - INFO - REPORTE DE COBRANZA cargado: (207, 68)
2025-11-17 18:29:36,979 - INFO - Columnas: ['regional', 'regional1', 'coordinacion', 'coordinacion1', 'de_credito', 'de_credito1', 'gpo', 'cliente_grupo', 'unnamed:_8', 'del_cliente']...
2025-11-17 18:29:36,979 - INFO - Cargando AHORROS (ACUMULADO) desde: data/AHORROS.xlsx
2025-11-17 18:29:37,015 - INFO - AHORROS cargado: (208, 4)
2025-11-17 18:29:37,015 - INFO - Columnas: ['id', 'grupo', 'ciclo', 'ahorro_acumulado']
2025-11-17 18:29:37,016 - INFO - PARCHE PROMOTORES cargado: 1 correcciones
2025-11-17 18:29:37,016 - INFO - 
--- PASO 2: GENERACIÓN DE CARTERA ---
2025-11-17 18:29:37,016 - INFO - Iniciando generación de cartera (VERSIÓN CORREGIDA)...
2025-11-17 18:29:37,016 - INFO - Registros en antiguedad: 206
2025-11-17 18:29:37,018 - INFO - ID de grupo generados: 0    000089
1    000145
2    000069
3    000079
4    000104
Name: id_de_grupo, dtype: object
2025-11-17 18:29:37,033 - INFO - Después de joins: 208 registros
2025-11-17 18:29:37,033 - INFO - NaN en situacion: 2
2025-11-17 18:29:37,034 - INFO - NaN en cobranza: 1
2025-11-17 18:29:37,034 - INFO - NaN en ahorros: 3
2025-11-17 18:29:37,035 - INFO - Parche aplicado: 1 correcciones
2025-11-17 18:29:37,041 - INFO - Estatus calculados: {'Vigente': 208}
2025-11-17 18:29:37,042 - INFO - Cartera vigente sistema calculada como: saldo_total (de ANTIGÜEDAD)
2025-11-17 18:29:37,056 - INFO - Cartera generada exitosamente: 208 filas x 36 columnas
2025-11-17 18:29:37,056 - INFO - 
--- PASO 3: GUARDADO DE RESULTADO CON FORMATO ---
2025-11-17 18:29:37,056 - INFO - ================================================================================
2025-11-17 18:29:37,056 - INFO - GUARDANDO DATAFRAME CON FORMATO
2025-11-17 18:29:37,057 - INFO - ================================================================================
2025-11-17 18:29:37,057 - INFO - 
1. Cargando plantilla de headers: plantilla/CARTERA_HEADERS.xlsx
2025-11-17 18:29:37,066 - INFO - Plantilla cargada: 6 filas x 36 columnas (6.1 KB)
2025-11-17 18:29:37,066 - INFO - 
2. Creando nuevo workbook...
2025-11-17 18:29:37,067 - INFO - 
3. Copiando headers desde plantilla...
2025-11-17 18:29:37,067 - INFO - Copiando headers (filas 1-6) con formato...
2025-11-17 18:29:37,108 - INFO - Headers copiados: 36 columnas
2025-11-17 18:29:37,108 - INFO - 
3.1. Ajustando anchos de columnas específicas...
2025-11-17 18:29:37,109 - INFO - Anchos ajustados: Q=20, R=20, S=20, T=20
2025-11-17 18:29:37,109 - INFO - 
4. Pegando datos del DataFrame...
2025-11-17 18:29:37,109 - INFO - Pegando DataFrame (208 filas x 36 columnas) desde fila 7...
2025-11-17 18:29:37,151 - INFO - Datos pegados hasta fila 214
2025-11-17 18:29:37,151 - INFO - 
5. Aplicando formatos de columnas...
2025-11-17 18:29:37,152 - INFO - Aplicando formatos de columnas desde fila 7 hasta 214...
2025-11-17 18:29:37,166 - INFO - Formatos aplicados a 208 filas
2025-11-17 18:29:37,166 - INFO - 
6. Creando tabla de Excel con totales...
2025-11-17 18:29:37,166 - INFO - Creando tabla Excel 'TablaCartera' desde fila 6 hasta 214...
2025-11-17 18:29:37,166 - INFO - Rango de tabla: A6:AJ215
2025-11-17 18:29:37,166 - INFO - Fila de totales: 215
2025-11-17 18:29:37,166 - INFO - Nombres de columnas extraídos: 36
2025-11-17 18:29:37,166 - INFO -   Columna 6 'Monto del crédito': SUM
2025-11-17 18:29:37,167 - INFO -   Columna 13 'Pago Semanal': SUM
2025-11-17 18:29:37,167 - INFO -   Columna 15 'Cartera vigente sistema': SUM
2025-11-17 18:29:37,167 - INFO -   Columna 16 'Carera vigente inicial': SUM
2025-11-17 18:29:37,167 - INFO -   Columna 17 'Cartera vigente calculada': SUM
2025-11-17 18:29:37,167 - INFO -   Columna 18 'Cartera Insoluta': SUM
2025-11-17 18:29:37,167 - INFO -   Columna 19 'Diferencia Validación vigente': SUM
2025-11-17 18:29:37,167 - INFO -   Columna 20 'Ahorro Consumido': SUM
2025-11-17 18:29:37,167 - INFO -   Columna 21 'Cartera Vencida Estadistica': SUM
2025-11-17 18:29:37,167 - INFO -   Columna 22 'Cartera vencida Total': SUM
2025-11-17 18:29:37,167 - INFO -   Columna 24 'Saldo en riesgo': SUM
2025-11-17 18:29:37,167 - INFO -   Columna 25 'Saldo 
ahorro 
acumulado': SUM
2025-11-17 18:29:37,167 - INFO -   Columna 26 'Monto promedio del grupo': SUM
2025-11-17 18:29:37,168 - INFO -   Columna 33 'Ahorro Acumulado': SUM
2025-11-17 18:29:37,168 - INFO - Filtros automáticos habilitados en rango: A6:AJ6
2025-11-17 18:29:37,168 - INFO - Escribiendo fórmulas en fila de totales...
2025-11-17 18:29:37,168 - INFO -   Fórmula en columna 6: =SUBTOTAL(9,F$7:F$214)
2025-11-17 18:29:37,168 - INFO -   Fórmula en columna 13: =SUBTOTAL(9,M$7:M$214)
2025-11-17 18:29:37,168 - INFO -   Fórmula en columna 15: =SUBTOTAL(9,O$7:O$214)
2025-11-17 18:29:37,168 - INFO -   Fórmula en columna 16: =SUBTOTAL(9,P$7:P$214)
2025-11-17 18:29:37,168 - INFO -   Fórmula en columna 17: =SUBTOTAL(9,Q$7:Q$214)
2025-11-17 18:29:37,168 - INFO -   Fórmula en columna 18: =SUBTOTAL(9,R$7:R$214)
2025-11-17 18:29:37,168 - INFO -   Fórmula en columna 19: =SUBTOTAL(9,S$7:S$214)
2025-11-17 18:29:37,168 - INFO -   Fórmula en columna 20: =SUBTOTAL(9,T$7:T$214)
2025-11-17 18:29:37,169 - INFO -   Fórmula en columna 21: =SUBTOTAL(9,U$7:U$214)
2025-11-17 18:29:37,169 - INFO -   Fórmula en columna 22: =SUBTOTAL(9,V$7:V$214)
2025-11-17 18:29:37,169 - INFO -   Fórmula en columna 24: =SUBTOTAL(9,X$7:X$214)
2025-11-17 18:29:37,169 - INFO -   Fórmula en columna 25: =SUBTOTAL(9,Y$7:Y$214)
2025-11-17 18:29:37,169 - INFO -   Fórmula en columna 26: =SUBTOTAL(9,Z$7:Z$214)
2025-11-17 18:29:37,169 - INFO -   Fórmula en columna 33: =SUBTOTAL(9,AG$7:AG$214)
2025-11-17 18:29:37,169 - INFO - Tabla creada exitosamente con 208 filas de datos + fila totales
2025-11-17 18:29:37,169 - INFO - Totales configurados en 14 columnas con fórmulas SUBTOTAL
2025-11-17 18:29:37,169 - INFO - Fila de totales: Formato aplicado automáticamente por la tabla
2025-11-17 18:29:37,169 - INFO - 
6.0. Re-aplicando formato sin paréntesis a columna 18...
2025-11-17 18:29:37,170 - INFO - Formato re-aplicado a columna 18 (Diferencia validación vigente) desde fila 7 hasta 215
2025-11-17 18:29:37,170 - INFO - 
6.1. Congelando paneles para mantener encabezados visibles...
2025-11-17 18:29:37,170 - INFO - Paneles congelados: Filas 1-6 siempre visibles
2025-11-17 18:29:37,170 - INFO - 
7. Guardando archivo: output_automatizado.xlsx
2025-11-17 18:29:37,875 - INFO - 
================================================================================
2025-11-17 18:29:37,876 - INFO - ARCHIVO GUARDADO EXITOSAMENTE
2025-11-17 18:29:37,876 - INFO - ================================================================================
2025-11-17 18:29:37,876 - INFO - 
Archivo: output_automatizado.xlsx
2025-11-17 18:29:37,876 - INFO - Filas de datos: 208
2025-11-17 18:29:37,876 - INFO - Columnas: 36
2025-11-17 18:29:37,876 - INFO - Formato: Idéntico al machote
2025-11-17 18:29:37,876 - INFO - Tabla Excel: Con totales automáticos y filtros
2025-11-17 18:29:37,876 - INFO - Encabezados: Siempre visibles (paneles congelados)
2025-11-17 18:29:37,876 - INFO - ================================================================================
2025-11-17 18:29:37,876 - INFO - OK - Archivo guardado con formato: output_automatizado.xlsx
2025-11-17 18:29:37,876 - INFO - 
--- PASO 4: GENERACIÓN DE HOJA MORA ---
2025-11-17 18:29:37,876 - INFO - 
Iniciando generación de hoja MORA...
2025-11-17 18:29:37,878 - INFO - Registros con %mora > 5%: 7 de 208
2025-11-17 18:29:37,881 - INFO - Hoja MORA generada con 7 registros y 14 columnas
2025-11-17 18:29:37,881 - INFO - 
================================================================================
2025-11-17 18:29:37,881 - INFO - AGREGANDO HOJA MORA
2025-11-17 18:29:37,881 - INFO - ================================================================================
2025-11-17 18:29:37,881 - INFO - 
1. Abriendo archivo: output_automatizado.xlsx
2025-11-17 18:29:38,074 - INFO - 
2. Creando hoja 'Mora'
2025-11-17 18:29:38,074 - INFO - 
3. Copiando formato de headers desde plantilla
2025-11-17 18:29:38,099 - INFO - 
4. Estableciendo headers de MORA
2025-11-17 18:29:38,099 - INFO - 
5. Pegando 7 filas de datos
2025-11-17 18:29:38,101 - INFO - 
6. Creando tabla Excel con totales
2025-11-17 18:29:38,101 - INFO -    Creando tabla: A6:N14
2025-11-17 18:29:38,102 - INFO -    Tabla 'TablaMora' creada con totales automáticos
2025-11-17 18:29:38,102 - INFO -    Filtros automáticos habilitados en rango: A6:N6
2025-11-17 18:29:38,102 - INFO -    Fórmulas SUBTOTAL escritas en 6 columnas
2025-11-17 18:29:38,102 - INFO - 
6.1. Congelando paneles para mantener encabezados visibles...
2025-11-17 18:29:38,102 - INFO - Paneles congelados: Filas 1-6 siempre visibles
2025-11-17 18:29:38,102 - INFO - 
7. Guardando archivo con hoja MORA
2025-11-17 18:29:38,236 - INFO - 
================================================================================
2025-11-17 18:29:38,236 - INFO - HOJA MORA AGREGADA EXITOSAMENTE
2025-11-17 18:29:38,236 - INFO - ================================================================================
2025-11-17 18:29:38,236 - INFO - 
Registros en MORA: 7
2025-11-17 18:29:38,236 - INFO - Filtro: %mora > 5%
2025-11-17 18:29:38,237 - INFO - Columnas amarillas: %mora, Días de mora
2025-11-17 18:29:38,237 - INFO - Tabla Excel: Con totales automáticos y filtros
2025-11-17 18:29:38,237 - INFO - Encabezados: Siempre visibles (paneles congelados)
2025-11-17 18:29:38,237 - INFO - ================================================================================
2025-11-17 18:29:38,237 - INFO - OK - Hoja MORA agregada con 7 registros
2025-11-17 18:29:38,237 - INFO - 
--- PASO 5: VALIDACIÓN ---
2025-11-17 18:29:38,238 - INFO - Machote no encontrado - validación omitida (no es necesario)
2025-11-17 18:29:38,238 - INFO - 
================================================================================
2025-11-17 18:29:38,238 - INFO - AUTOMATIZACIÓN COMPLETADA EXITOSAMENTE
2025-11-17 18:29:38,238 - INFO - ================================================================================
2025-11-17 18:56:47,387 - INFO - Cargando SITUACIÓN DE CARTERA desde: data\Situación_de_cartera_12112025.xlsx
2025-11-17 18:56:47,502 - INFO - SITUACIÓN DE CARTERA cargada: (206, 43)
2025-11-17 18:56:47,502 - INFO - Columnas: ['codigo_ofic_cred', 'nombre_oficial_de_credito', 'codigo_promotor_cred', 'nombre_promotor_cred', 'codigo_coord', 'nombre_coordinacion', 'codigo_ger_regi', 'nombre_gerencia_regional', 'nombre_codigo', 'nombre_acreditado_cliente']...
2025-11-17 18:56:47,502 - INFO - Columna de código renombrada: nombre_codigo -> codigo
2025-11-17 18:56:47,504 - INFO - Cargando AHORROS (ACUMULADO) desde: data/AHORROS.xlsx
2025-11-17 18:56:47,540 - INFO - AHORROS cargado: (208, 4)
2025-11-17 18:56:47,540 - INFO - Columnas: ['id', 'grupo', 'ciclo', 'ahorro_acumulado']
2025-11-17 18:57:24,879 - INFO - Cargando SITUACIÓN DE CARTERA desde: data\Situación_de_cartera_12112025.xlsx
2025-11-17 18:57:24,993 - INFO - SITUACIÓN DE CARTERA cargada: (206, 43)
2025-11-17 18:57:24,993 - INFO - Columnas: ['codigo_ofic_cred', 'nombre_oficial_de_credito', 'codigo_promotor_cred', 'nombre_promotor_cred', 'codigo_coord', 'nombre_coordinacion', 'codigo_ger_regi', 'nombre_gerencia_regional', 'nombre_codigo', 'nombre_acreditado_cliente']...
2025-11-17 18:57:24,993 - INFO - Columna de código renombrada: nombre_codigo -> codigo
2025-11-17 18:57:24,995 - INFO - Cargando AHORROS (ACUMULADO) desde: data/AHORROS.xlsx
2025-11-17 18:57:25,031 - INFO - AHORROS cargado: (208, 4)
2025-11-17 18:57:25,031 - INFO - Columnas: ['id', 'grupo', 'ciclo', 'ahorro_acumulado']
